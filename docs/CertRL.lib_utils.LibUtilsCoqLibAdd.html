
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CertRL.lib_utils.LibUtilsCoqLibAdd</title>
<meta name="description" content="Documentation of Coq module CertRL.lib_utils.LibUtilsCoqLibAdd" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CertRL.lib_utils.LibUtilsCoqLibAdd</h1>
<div class="coq">
<br/>
<div class="doc">This module contains additional definitions and lemmas on strings,
 including a total order relation. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html">Bool</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Sumbool.html">Sumbool</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.Omega.html">Omega</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html">RelationClasses</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html">Equivalence</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Peano_dec.html">Peano_dec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith.html">ZArith</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdigits.html">Zdigits</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html">Znat</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.funind.Recdef.html">Recdef</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html">Compare_dec</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd">CoqLibAdd</a></span>.<br/>
<br/>
<h1> Properties of Booleans </h1>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.Booleans">Booleans</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="andb_true_inversion">andb_true_inversion</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb">andb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b1">b1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b2">b2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> /\ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b2">b2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof374')">Proof.</div>
<div class="proofscript" id="proof374">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">case_eq</span> <span class="id">b1</span>; <span class="id">case_eq</span> <span class="id">b2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb_true_intro">andb_true_intro</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="four_cases">four_cases</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p1</span> <span class="id">p2</span>: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p1">p1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) /\ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p2">p2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p1">p1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) /\ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p2">p2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p1">p1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) /\ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p2">p2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p1">p1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) /\ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p2">p2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof375')">Proof.</div>
<div class="proofscript" id="proof375">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id">p1</span> <span class="id">a</span>); <span class="tactic">case</span> (<span class="id">p2</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="two_cases">two_cases</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p</span>: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) \/ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof376')">Proof.</div>
<div class="proofscript" id="proof376">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id">p</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="notand">notand</a></span> <span class="id">p</span> <span class="id">q</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~(<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span> \/ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#q">q</a></span>) -&gt; ~<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span> /\ ~<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#q">q</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof377')">Proof.</div>
<div class="proofscript" id="proof377">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not">not</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span>. <span class="tactic">elim</span> <span class="id">H</span>. <span class="id">left</span>. <span class="tactic">assumption</span>. <span class="tactic">elim</span> <span class="id">H</span>. <span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eq_implies_pred">eq_implies_pred</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>), <span class="kwd">forall</span> (<span class="id">x1</span> <span class="id">x2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x1">x1</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x2">x2</a></span> -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x1">x1</a></span>) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x2">x2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof378')">Proof.</div>
<div class="proofscript" id="proof378">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="not_pred_implies_neq">not_pred_implies_neq</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>), <span class="kwd">forall</span> (<span class="id">x1</span> <span class="id">x2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x1">x1</a></span>) &lt;&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x2">x2</a></span>) -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x1">x1</a></span> &lt;&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x2">x2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof379')">Proof.</div>
<div class="proofscript" id="proof379">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not">not</a></span> <span class="kwd">in</span> *; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#eq_implies_pred">eq_implies_pred</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Booleans">Booleans</a></span>.<br/>
<br/>
<h1> Properties of <span class="bracket"><span class="id">In</span></span> </h1>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.In">In</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span>:<span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="In_app">In_app</a></span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof380')">Proof.</div>
<div class="proofscript" id="proof380">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">IHl1</span> <span class="id">H0</span>); <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">IHl1</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="In_app_comm">In_app_comm</a></span> (<span class="id">v</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v">v</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span>++<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v">v</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>++<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof381')">Proof.</div>
<div class="proofscript" id="proof381">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_in">Permutation_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="In_app_iff">In_app_iff</a></span> (<span class="id">v</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v">v</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span>++<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v">v</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>++<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof382')">Proof.</div>
<div class="proofscript" id="proof382">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#In_app_comm">In_app_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="find_In">find_In</a></span> {<span class="id">f</span> <span class="id">l</span>} {<span class="id">b</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#find">find</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof383')">Proof.</div>
<div class="proofscript" id="proof383">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">b</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="find_correct">find_correct</a></span> {<span class="id">f</span> <span class="id">l</span>} {<span class="id">b</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#find">find</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof384')">Proof.</div>
<div class="proofscript" id="proof384">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">b</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 2; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="app_or_in">app_or_in</a></span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) (<span class="id">l1</span> <span class="id">l2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof385')">Proof.</div>
<div class="proofscript" id="proof385">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">IHl1</span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="app_or_in_iff">app_or_in_iff</a></span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) (<span class="id">l1</span> <span class="id">l2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof386')">Proof.</div>
<div class="proofscript" id="proof386">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#app_or_in">app_or_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="in_or_not">in_or_not</a></span> (<span class="id">eqd</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>':<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>, {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>=<span class="id">a</span>'} + {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>&lt;&gt;<span class="id">a</span>'}) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) <span class="id">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>) \/ ~(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof387')">Proof.</div>
<div class="proofscript" id="proof387">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">intro</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">eqd</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a1</span> <span class="kwd">in</span> *; <span class="id">left</span>; <span class="id">left</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">IHl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not">not</a></span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">b</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nin_app_or">nin_app_or</a></span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) <span class="id">a</span> <span class="id">b</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span>)) &lt;-&gt; (~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> /\ ~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof388')">Proof.</div>
<div class="proofscript" id="proof388">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_or">in_app_or</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="in_in_app_false">in_in_app_false</a></span> {<span class="id">l</span> <span class="id">l1</span> <span class="id">l2</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof389')">Proof.</div>
<div class="proofscript" id="proof389">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intuition</span>; <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="in_in_cons_app_false">in_in_cons_app_false</a></span> {<span class="id">v</span> <span class="id">l</span> <span class="id">l1</span> <span class="id">l2</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v">v</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v">v</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof390')">Proof.</div>
<div class="proofscript" id="proof390">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intuition</span>; <span class="tactic">try</span> <span class="id">solve</span>[<span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="in_in_cons_cons_app_app_false">in_in_cons_cons_app_app_false</a></span> {<span class="id">v</span> <span class="id">v0</span> <span class="id">l</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">l3</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v">v</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> \/ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v0">v0</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l3">l3</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l3">l3</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v">v</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#v0">v0</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof391')">Proof.</div>
<div class="proofscript" id="proof391">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intuition</span>; <span class="tactic">try</span> <span class="id">solve</span>[<span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="forall_in_dec">forall_in_dec</a></span> <span class="id">P</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">dec</span>:<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>} + {~ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>}):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>} + {~ <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof392')">Proof.</div>
<div class="proofscript" id="proof392">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">a</span>); [<span class="tactic">intuition</span> | | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">dec</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>; <span class="tactic">intuition</span>. <span class="tactic">subst</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exists_in_dec">exists_in_dec</a></span> <span class="id">P</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">dec</span>:<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>} + {~ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>}):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">exists</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> /\ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>} + {~ <span class="id">exists</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> /\ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof393')">Proof.</div>
<div class="proofscript" id="proof393">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>. <span class="tactic">intros</span> [??]; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">a</span>); [<span class="tactic">intuition</span> | | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">dec</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>. <span class="tactic">destruct</span> <span class="id">e</span> <span class="kwd">as</span> [?[??]]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="tactic">intros</span> [?[[?|?]?]]; <span class="tactic">subst</span>; <span class="tactic">intuition</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exists_nforall_in_dec">exists_nforall_in_dec</a></span> <span class="id">P</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">dec</span>:<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>} + {~ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>}):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">exists</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> /\ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>} + {<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; ~<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof394')">Proof.</div>
<div class="proofscript" id="proof394">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">a</span>); [<span class="tactic">intuition</span> | | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">dec</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>. <span class="tactic">destruct</span> <span class="id">e</span> <span class="kwd">as</span> [?[??]]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="tactic">intros</span> ? [?|?]; <span class="tactic">subst</span>; <span class="tactic">intuition</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="existsb_ex">existsb_ex</a></span> (<span class="id">f</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; {<span class="id">x</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> /\ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof395')">Proof.</div>
<div class="proofscript" id="proof395">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id">f</span> <span class="id">l</span>); <span class="tactic">intros</span> <span class="id">exx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">IHl</span> <span class="id">exx</span>) <span class="kwd">as</span> [?[??]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">case_eq</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">intros</span> <span class="id">faa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> <span class="id">a</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">exx</span>, <span class="id">faa</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="forall_in_weaken">forall_in_weaken</a></span> (<span class="id">P</span> <span class="id">Q</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">l</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> <span class="id">x</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In.A">A</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof396')">Proof.</div>
<div class="proofscript" id="proof396">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">x</span>). <span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H0</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.In">In</a></span>.<br/>
<br/>
<h1> Properties of <span class="bracket"><span class="id">Forallt</span></span> </h1>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.Forallt">Forallt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id"><a name="Forallt">Forallt</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">P</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="kwd">Type</span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span> -&gt; <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="Forallt_nil">Forallt_nil</a></span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a name="Forallt_cons">Forallt_cons</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> :: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="list_Forallt_eq_dec">list_Forallt_eq_dec</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">c</span> <span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> =&gt; <span class="kwd">forall</span> <span class="id">y</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>, {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>} + {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> &lt;&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>}) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#c">c</a></span> -&gt; {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#c">c</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>} + {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#c">c</a></span> &lt;&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof397')">Proof.</div>
<div class="proofscript" id="proof397">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">revert</span> <span class="id">l</span>; <span class="tactic">induction</span> <span class="id">c</span>; <span class="tactic">intros</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>;<span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion</span> <span class="id">X</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">X0</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">IHc</span> <span class="id">X1</span> <span class="id">l</span>);<span class="tactic">subst</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="forallt_impl">forallt_impl</a></span> {<span class="id">A</span>} {<span class="id">P1</span> <span class="id">P2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P1">P1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P1">P1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P2">P2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P2">P2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof398')">Proof.</div>
<div class="proofscript" id="proof398">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion</span> 1; <span class="tactic">inversion</span> 1; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="forallt_weaken">forallt_weaken</a></span> {<span class="id">A</span>} <span class="id">P</span> : (<span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) -&gt; <span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof399')">Proof.</div>
<div class="proofscript" id="proof399">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt_nil">Forallt_nil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt_cons">Forallt_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id">X</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Forallt_inv">Forallt_inv</a></span>: <span class="kwd">forall</span> <span class="id">A</span> <span class="id">P</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) <span class="id">l</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> :: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>) -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof400')">Proof.</div>
<div class="proofscript" id="proof400">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">inversion</span> <span class="id">X</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Forallt_inv2">Forallt_inv2</a></span>: <span class="kwd">forall</span> <span class="id">A</span> <span class="id">P</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) <span class="id">l</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> :: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>) -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof401')">Proof.</div>
<div class="proofscript" id="proof401">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">inversion</span> <span class="id">X</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Forallt_In">Forallt_In</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">P</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="kwd">Type</span>} {<span class="id">r</span>} {<span class="id">eq</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>}: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#r">r</a></span> -&gt; <span class="kwd">forall</span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#r">r</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof402')">Proof.</div>
<div class="proofscript" id="proof402">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Since&nbsp;equality&nbsp;is&nbsp;decidable,&nbsp;we&nbsp;can&nbsp;"rediscover"&nbsp;the&nbsp;components&nbsp;of&nbsp;the&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;relation&nbsp;(the&nbsp;‌\/&nbsp;lives&nbsp;in&nbsp;Prop)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span>==<span class="id">a</span>); <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#complement">complement</a></span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id">eq</span> <span class="id">a</span> <span class="id">l</span>); <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#complement">complement</a></span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Forall_app">Forall_app</a></span> {<span class="id">A</span>} (<span class="id">P</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="kwd">Prop</span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof403')">Proof.</div>
<div class="proofscript" id="proof403">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l1</span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id">l2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#In_app">In_app</a></span>; <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H2</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Forall_app_inv">Forall_app_inv</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} {<span class="id">P</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="kwd">Prop</span>} (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) -&gt;   <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof404')">Proof.</div>
<div class="proofscript" id="proof404">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Finn</span>; <span class="tactic">split</span>; <span class="tactic">intros</span> ? <span class="id">inn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">apply</span> <span class="id">Finn</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Forall_map">Forall_map</a></span> {<span class="id">A</span> <span class="id">B</span>} <span class="id">P</span> (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) <span class="id">l</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof405')">Proof.</div>
<div class="proofscript" id="proof405">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [? [??]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Forall_impl_in">Forall_impl_in</a></span> {<span class="id">A</span>} {<span class="id">P</span> <span class="id">Q</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="kwd">Prop</span>} {<span class="id">l</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof406')">Proof.</div>
<div class="proofscript" id="proof406">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">trivial</span>; <span class="tactic">simpl</span>; <span class="tactic">inversion</span> 2; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Forallt_Forall">Forallt_Forall</a></span> {<span class="id">A</span>:<span class="kwd">Prop</span>} (<span class="id">P</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="kwd">Prop</span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forallt">Forallt</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof407')">Proof.</div>
<div class="proofscript" id="proof407">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Forallt">Forallt</a></span>.<br/>
<br/>
<h1> Properties of <span class="bracket"><span class="id">forallb</span></span> </h1>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.forallb">forallb</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="forallb_ext">forallb_ext</a></span> {<span class="id">A</span>} <span class="id">f1</span> <span class="id">f2</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f1">f1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f2">f2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f1">f1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f2">f2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof408')">Proof.</div>
<div class="proofscript" id="proof408">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="forallb_incl">forallb_incl</a></span> {<span class="id">A</span>} <span class="id">f</span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof409')">Proof.</div>
<div class="proofscript" id="proof409">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="forallb_app">forallb_app</a></span> {<span class="id">A</span>} (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id">l1</span> <span class="id">l2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l1">l1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l2">l2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof410')">Proof.</div>
<div class="proofscript" id="proof410">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> *; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="forallb_map">forallb_map</a></span> {<span class="id">A</span> <span class="id">B</span>} <span class="id">f</span> (<span class="id">mf</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#mf">mf</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#m">m</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> ((<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#mf">mf</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>))) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof411')">Proof.</div>
<div class="proofscript" id="proof411">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="existsb_not_forallb">existsb_not_forallb</a></span> {<span class="id">A</span>} <span class="id">f</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof412')">Proof.</div>
<div class="proofscript" id="proof412">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="forallb_not_existb">forallb_not_existb</a></span> {<span class="id">A</span>} <span class="id">f</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof413')">Proof.</div>
<div class="proofscript" id="proof413">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="map_eq">map_eq</a></span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">f</span> <span class="id">g</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>} {<span class="id">l</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#g">g</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#g">g</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof414')">Proof.</div>
<div class="proofscript" id="proof414">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">simpl</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="map_cons">map_cons</a></span> {<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>} (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>::<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof415')">Proof.</div>
<div class="proofscript" id="proof415">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="map_eq_cons">map_eq_cons</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) <span class="id">b</span> <span class="id">l</span>' :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span>::<span class="id">l</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">a</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> &amp; {<span class="id">ls</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> | <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>::<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#ls">ls</a></span> /\<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#ls">ls</a></span> = <span class="id">l</span>'}}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof416')">Proof.</div>
<div class="proofscript" id="proof416">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.forallb">forallb</a></span>.<br/>
<br/>
<h1> Properties of pairs </h1>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.Pairs">Pairs</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pair_eq_dec">pair_eq_dec</a></span> {<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>} (<span class="id">a1</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">b1</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) (<span class="id">a2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">b2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a1">a1</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a2">a2</a></span>} + {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a1">a1</a></span> &lt;&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a2">a2</a></span>} -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b1">b1</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b2">b2</a></span>} + {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b1">b1</a></span> &lt;&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b2">b2</a></span>} -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{(<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a1">a1</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b1">b1</a></span>) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a2">a2</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b2">b2</a></span>)} + {(<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a1">a1</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b1">b1</a></span>) &lt;&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a2">a2</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b2">b2</a></span>)}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof417')">Proof.</div>
<div class="proofscript" id="proof417">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> 1; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> 1; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="string_eqdec">string_eqdec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">String.string</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">String.string_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="pair_eqdec">pair_eqdec</a></span> {<span class="id">A</span> <span class="id">B</span>} `{<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>} `{<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#prod">prod</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof418')">Proof.</div>
<div class="proofscript" id="proof418">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#complement">complement</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#pair_eq_dec">pair_eq_dec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="option_eqdec">option_eqdec</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} `{<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>}: <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof419')">Proof.</div>
<div class="proofscript" id="proof419">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#complement">complement</a></span>; <span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">try</span> <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">a</span> == <span class="id">a0</span>); <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Pairs">Pairs</a></span>.<br/>
<br/>
<h1> Arithmetics </h1>
<br/>
<h2> Natural numbers </h2>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.Nutil">Nutil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="min_zero">min_zero</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#min">min</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span>) = 0 -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof420')">Proof.</div>
<div class="proofscript" id="proof420">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> (<span class="id">n3</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#min">min</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n1</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n2</span>) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n3">n3</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#min">min</a></span> <span class="id">n1</span> <span class="id">n2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#succ_min_distr">Min.succ_min_distr</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="min_against_one">min_against_one</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#min">min</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n">n</a></span> 1 = 0 \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#min">min</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n">n</a></span> 1 = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof421')">Proof.</div>
<div class="proofscript" id="proof421">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">IHn</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">IHn</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="compare_either">compare_either</a></span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> &lt;= <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span>) \/ (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span> &lt;= <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof422')">Proof.</div>
<div class="proofscript" id="proof422">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="min_one_yields_one">min_one_yields_one</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#min">min</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n">n</a></span> 1 = 1 -&gt; 1 &lt;= <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof423')">Proof.</div>
<div class="proofscript" id="proof423">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fold_left_arith_dist1">fold_left_arith_dist1</a></span> {<span class="id">A</span>} (<span class="id">x0</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">y</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) =&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x0">x0</a></span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">y</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) =&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> 0) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x0">x0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof424')">Proof.</div>
<div class="proofscript" id="proof424">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x0</span>; <span class="tactic">simpl</span>; <span class="tactic">induction</span> <span class="id">l</span>; [<span class="tactic">reflexivity</span>|<span class="id">idtac</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHl</span> (<span class="id">f</span> <span class="id">a</span> + 0)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHl</span> (<span class="id">f</span> <span class="id">a</span> + <span class="id">x0</span>)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fold_left_arith_dist2">fold_left_arith_dist2</a></span> {<span class="id">A</span>} (<span class="id">x0</span> <span class="id">n0</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">y</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n0">n0</a></span> * (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x0">x0</a></span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n0">n0</a></span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">y</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) =&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> 0) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x0">x0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof425')">Proof.</div>
<div class="proofscript" id="proof425">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x0</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHl</span> (<span class="id">n0</span> * <span class="id">f</span> <span class="id">a</span> + <span class="id">x0</span>)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#fold_left_arith_dist1">fold_left_arith_dist1</a></span> (<span class="id">f</span> <span class="id">a</span> + 0)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Mult.html#mult_plus_distr_l">mult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Mult.html#mult_plus_distr_l">mult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fold_left_arith_dist3">fold_left_arith_dist3</a></span> {<span class="id">A</span>} (<span class="id">x0</span> <span class="id">n0</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n0">n0</a></span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">y</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) =&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> 0) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x0">x0</a></span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n0">n0</a></span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">y</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> + (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> 0) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x0">x0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof426')">Proof.</div>
<div class="proofscript" id="proof426">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x0</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">a</span> + <span class="id">n</span> = <span class="id">n</span> + <span class="id">f</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Plus.html#plus_comm">plus_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHl</span> <span class="id">x0</span> (<span class="id">n</span> + <span class="id">f</span> <span class="id">a</span>)); <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fold_left_arith_dist4">fold_left_arith_dist4</a></span> {<span class="id">A</span>} (<span class="id">x0</span> <span class="id">n0</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">y</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n0">n0</a></span> * (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x0">x0</a></span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n0">n0</a></span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">y</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> + (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> 0) + <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x0">x0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof427')">Proof.</div>
<div class="proofscript" id="proof427">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#fold_left_arith_dist3">fold_left_arith_dist3</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#fold_left_arith_dist2">fold_left_arith_dist2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Nutil">Nutil</a></span>.<br/>
<br/>
<h2> Integers </h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.Zutil">Zutil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="ZToSignedNat">ZToSignedNat</a></span> (<span class="id">z</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.sgn">Z.sgn</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#z">z</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| -1 =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>,(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#z">z</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#z">z</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pos_succ_inv">pos_succ_inv</a></span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof428')">Proof.</div>
<div class="proofscript" id="proof428">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ_inj">Pos.succ_inj</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Pos_of_nat_inv">Pos_of_nat_inv</a></span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_nat">Pos.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_nat">Pos.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span>) -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof429')">Proof.</div>
<div class="proofscript" id="proof429">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">of_nat_succ</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n2</span> <span class="id">H</span>; <span class="tactic">induction</span> <span class="id">n1</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ_not_1">Pos.succ_not_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not">not</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">nat</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_nat">Pos.of_nat</a></span> <span class="id">n2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)). <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> <span class="id">n2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ_not_1">Pos.succ_not_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not">not</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">nat</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_nat">Pos.of_nat</a></span> <span class="id">n1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)). <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHn1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#pos_succ_inv">pos_succ_inv</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="of_nat_inv">of_nat_inv</a></span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof430')">Proof.</div>
<div class="proofscript" id="proof430">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n1</span>; <span class="tactic">destruct</span> <span class="id">n2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_nat_succ">Pos.of_nat_succ</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_nat_succ">Pos.of_nat_succ</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Pos_of_nat_inv">Pos_of_nat_inv</a></span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">H1</span>); <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pos_succ_nat_inv">pos_succ_nat_inv</a></span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_succ_nat">Pos.of_succ_nat</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_succ_nat">Pos.of_succ_nat</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof431')">Proof.</div>
<div class="proofscript" id="proof431">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_nat_succ">Pos.of_nat_succ</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Pos_of_nat_inv">Pos_of_nat_inv</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="Z_eqdec">Z_eqdec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof432')">Proof.</div>
<div class="proofscript" id="proof432">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Zutil">Zutil</a></span>.<br/>
<br/>
<h1> Iterator on lists </h1>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.Iter">Iter</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="repeat_plus">repeat_plus</a></span> {<span class="id">A</span>} (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">n1</span> <span class="id">n2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span>+<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span>) = <span class="tactic">repeat</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n1">n1</a></span> ++ <span class="tactic">repeat</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#n2">n2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof433')">Proof.</div>
<div class="proofscript" id="proof433">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n1</span>; <span class="tactic">simpl</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="iter">iter</a></span> {<span class="id">A</span>} (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">iterations</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iterations">iterations</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter">iter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id">n</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="iter_fold_left_list">iter_fold_left_list</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter">iter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof434')">Proof.</div>
<div class="proofscript" id="proof434">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="iter_fold_left_repeat">iter_fold_left_repeat</a></span> {<span class="id">A</span>} (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">iterations</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter">iter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iterations">iterations</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) (<span class="tactic">repeat</span> 0 <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iterations">iterations</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof435')">Proof.</div>
<div class="proofscript" id="proof435">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter_fold_left_list">iter_fold_left_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#repeat_length">repeat_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="iter_fold_right_list">iter_fold_right_list</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter">iter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof436')">Proof.</div>
<div class="proofscript" id="proof436">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_involutive">rev_involutive</a></span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left_rev_right">fold_left_rev_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_length">rev_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter_fold_left_list">iter_fold_left_list</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="iter_plus">iter_plus</a></span> {<span class="id">A</span>} (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) (<span class="id">iterations1</span> <span class="id">iterations2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter">iter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iterations1">iterations1</a></span>+<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iterations2">iterations2</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter">iter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iterations2">iterations2</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter">iter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iterations1">iterations1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof437')">Proof.</div>
<div class="proofscript" id="proof437">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter_fold_left_repeat">iter_fold_left_repeat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#repeat_plus">repeat_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left_app">fold_left_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="iter_trans">iter_trans</a></span> {<span class="id">A</span>} (<span class="id">R</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Relations.Relation_Definitions.html#relation">relation</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) {<span class="id">pre</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#PreOrder">PreOrder</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R">R</a></span>} <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf</span>:<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R">R</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>)) (<span class="id">iterations</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">a</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R">R</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter">iter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iterations">iterations</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof438')">Proof.</div>
<div class="proofscript" id="proof438">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">iterations</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Iter">Iter</a></span>.<br/>
<br/>
<h1> Iterator with a cost functions </h1>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.Cost">Cost</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span>:<span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Function</span> <span class="id">iter_cost</span> (<span class="id">optim</span>: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Cost.A">A</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Cost.A">A</a></span>) (<span class="id">cost</span>: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Cost.A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">p</span>: <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Cost.A">A</a></span>) { <span class="kwd">measure</span> <span class="id">cost</span> <span class="id">p</span> } :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">p</span>' := <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#optim">optim</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#lt_dec">lt_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#cost">cost</a></span> <span class="id">p</span>') (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#cost">cost</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter_cost">iter_cost</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#optim">optim</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#cost">cost</a></span> <span class="id">p</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof439')">Proof.</div>
<div class="proofscript" id="proof439">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">optim</span> <span class="id">cost</span> <span class="id">p</span> <span class="id">Hcmp</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="iter_cost_trans">iter_cost_trans</a></span> (<span class="id">R</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Relations.Relation_Definitions.html#relation">relation</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Cost.A">A</a></span>) {<span class="id">pre</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#PreOrder">PreOrder</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R">R</a></span>} <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf</span>:<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R">R</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>)) (<span class="id">cost</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Cost.A">A</a></span>-&gt;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">a</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R">R</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter_cost">iter_cost</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#cost">cost</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof440')">Proof.</div>
<div class="proofscript" id="proof440">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#iter_cost_ind">iter_cost_ind</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Cost">Cost</a></span>.<br/>
<br/>
<h1> Assertion </h1>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.Holds">Holds</a></span>.<br/>
<div class="doc">This is defined using <span class="bracket"><span class="id">vm_compute</span></span> for efficiency when
    doing testing. </div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_true">is_true</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">x</span>:{<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>}+{<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>}) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Eval</span> <span class="id">vm_compute</span> <span class="kwd">in</span> (<span class="kwd">if</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="holds">holds</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">x</span>:{<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>}+{<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>}) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#is_true">is_true</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.Holds">Holds</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="compose_inj">compose_inj</a></span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>} (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#C">C</a></span>) (<span class="id">g</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#g">g</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#g">g</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#g">g</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#g">g</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>) -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof441')">Proof.</div>
<div class="proofscript" id="proof441">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sumbool_and">sumbool_and</a></span> {<span class="id">P</span> <span class="id">Q</span>} : {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span>} + {~ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span>} -&gt; {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Q">Q</a></span>} + {~ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Q">Q</a></span>} -&gt; {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> /\ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Q">Q</a></span>} + {~ (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#P">P</a></span> /\ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Q">Q</a></span>)}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof442')">Proof.</div>
<div class="proofscript" id="proof442">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">destruct</span> 1; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="eqdec_neq">eqdec_neq</a></span> {<span class="id">A</span>} `{<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>} (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) :  {<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> &lt;&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>} + {~ <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span> &lt;&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof443')">Proof.</div>
<div class="proofscript" id="proof443">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> == <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="CoqLibAdd.equiv">equiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Equivalence_by_iff">Equivalence_by_iff</a></span> {<span class="id">A</span>} (<span class="id">R1</span> <span class="id">R2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="kwd">Prop</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span> &lt;-&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span> &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof444')">Proof.</div>
<div class="proofscript" id="proof444">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">R1</span> <span class="id">R2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="kwd">forall</span> <span class="id">R1</span> <span class="id">R2</span>,  (<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span> : <span class="id">A</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span> &lt;-&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">HH</span> <span class="id">R1</span> <span class="id">R2</span> <span class="id">H</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">HH</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">HH</span>. <span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">R1</span> <span class="id">R2</span> <span class="id">H</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">H</span>; <span class="id">etransitivity</span>; <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="EqDec_by_iff">EqDec_by_iff</a></span> {<span class="id">A</span>} (<span class="id">R1</span> <span class="id">R2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">equiv1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span>} {<span class="id">equiv2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span> &lt;-&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof445')">Proof.</div>
<div class="proofscript" id="proof445">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqs</span> <span class="id">dec</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> == <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">eqs</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>. <span class="tactic">intro</span> <span class="id">eq1</span>; <span class="tactic">apply</span> <span class="id">eqs</span> <span class="kwd">in</span> <span class="id">eq1</span>. <span class="tactic">apply</span> (<span class="id">c</span> <span class="id">eq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">EqDec_by_iff</span>' {<span class="id">A</span>} (<span class="id">R1</span> <span class="id">R2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">equiv1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span>} {<span class="id">equiv2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span> &lt;-&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R2">R2</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R1">R1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof446')">Proof.</div>
<div class="proofscript" id="proof446">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqs</span> <span class="id">dec</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> == <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">eqs</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>. <span class="tactic">intro</span> <span class="id">eq1</span>; <span class="tactic">apply</span> <span class="id">eqs</span> <span class="kwd">in</span> <span class="id">eq1</span>. <span class="tactic">apply</span> (<span class="id">c</span> <span class="id">eq1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="Equivalence_pullback">Equivalence_pullback</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">R</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>-&gt;<span class="kwd">Prop</span>) (<span class="id">f</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>-&gt;<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#B">B</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R">R</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#Equivalence">Equivalence</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#R">R</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#x">x</a></span>) (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof447')">Proof.</div>
<div class="proofscript" id="proof447">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">symmetry</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd.equiv">equiv</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#CoqLibAdd">CoqLibAdd</a></span>.<br/>
<br/>
<h1> Tactics </h1>
<br/>
<span class="kwd">Ltac</span> <span class="id">dest_eqdec</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;| [|- <span class="id">context</span> [<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Peano_dec.html#eq_nat_dec">eq_nat_dec</a></span> ?<span class="id">x</span> ?<span class="id">y</span>]] =&gt; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Peano_dec.html#eq_nat_dec">eq_nat_dec</a></span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">context</span> [<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Peano_dec.html#eq_nat_dec">eq_nat_dec</a></span> ?<span class="id">x</span> ?<span class="id">y</span>] |- <span class="id">_</span>] =&gt; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Peano_dec.html#eq_nat_dec">eq_nat_dec</a></span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| [|- <span class="id">context</span> [@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> ?<span class="id">a</span> ?<span class="id">b</span> ?<span class="id">c</span> ?<span class="id">d</span> ?<span class="id">x</span> ?<span class="id">y</span>]] =&gt; <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">context</span> [@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> ?<span class="id">a</span> ?<span class="id">b</span> ?<span class="id">c</span> ?<span class="id">d</span> ?<span class="id">x</span> ?<span class="id">y</span>] |- <span class="id">_</span>] =&gt; <span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">Equivalence.equiv</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#complement">RelationClasses.complement</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">subst</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">move_to_top</span> <span class="id">x</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">reverse</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">try</span> <span class="tactic">move</span> <span class="id">x</span> <span class="id">after</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">assert_eq</span>" <span class="id">ident</span>(<span class="id">x</span>) <span class="id">constr</span>(<span class="id">v</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">x</span> = <span class="id">v</span>) <span class="kwd">as</span> <span class="id">H</span> <span class="tactic">by</span> <span class="tactic">reflexivity</span>;<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">Case_aux</span>" <span class="id">ident</span>(<span class="id">x</span>) <span class="id">constr</span>(<span class="id">name</span>) :=<br/>
&nbsp;&nbsp;<span class="id">first</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">x</span> := <span class="id">name</span>); <span class="id">move_to_top</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">assert_eq</span> <span class="id">x</span> <span class="id">name</span>; <span class="id">move_to_top</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="tactic">fail</span> 1 "<span class="id">because</span> <span class="id">we</span> <span class="id">are</span> <span class="id">working</span> <span class="id">on</span> <span class="id">a</span> <span class="id">different</span> <span class="tactic">case</span>" ].<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">Case</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">Case</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSSSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSSSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSSSSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSSSSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSSSSSCase</span> <span class="id">name</span>.<br/>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">notHyp</span> <span class="id">P</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ <span class="id">_</span> : <span class="id">P</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">fail</span> 1<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">extend</span> <span class="id">P</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">P</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">notHyp</span> <span class="id">t</span>; <span class="tactic">generalize</span> <span class="id">P</span>; <span class="tactic">intro</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_destr</span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> [|- <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>]] =&gt; <span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">end</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_destr_in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] =&gt; <span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">end</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_case</span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> [|- <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>]] =&gt; <span class="id">case_eq</span> <span class="id">x</span> <span class="kwd">end</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_case_in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] =&gt; <span class="id">case_eq</span> <span class="id">x</span> <span class="kwd">end</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_option</span><br/>
&nbsp;&nbsp;:= <span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|- <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id">_</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id">_</span> <span class="kwd">end</span>]] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> <span class="id">x</span> <span class="kwd">end</span>; [ <span class="tactic">intros</span> ? <span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">eqq</span>]; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">eqq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_option_in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;:= <span class="kwd">let</span> <span class="id">eqq</span> := <span class="tactic">fresh</span> "<span class="id">eqq</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id">_</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> <span class="id">x</span> <span class="kwd">end</span>; [ <span class="tactic">intros</span> ? <span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">eqq</span>]; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">cut_to</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;| <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">invcs</span> <span class="id">H</span> := <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">subst</span>.<br/>
<br/>
<span class="kwd">Class</span> <span class="id"><a name="ToString">ToString</a></span> (<span class="id">A</span>:<span class="kwd">Type</span>)<br/>
&nbsp;&nbsp;:= {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="toString">toString</a></span> (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#A">A</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">string_eqdec_to_equiv</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#string_eqdec">string_eqdec</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id">EqDec</span>:=<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#string_eqdec">string_eqdec</a></span>)) <span class="kwd">in</span> * <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">string_dec_to_equiv</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id">EqDec</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span>)) <span class="kwd">in</span> * <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
