
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CertRL.Gen_NN</title>
<meta name="description" content="Documentation of Coq module CertRL.Gen_NN" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CertRL.Gen_NN</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html">RelationClasses</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html">Streams</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CertRL.utils.ListAdd.html">ListAdd</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbase.html">Rbase</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo.html">Rtrigo</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpower.html">Rpower</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html">Rbasic_fun</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CertRL.DefinedFunctions.html">DefinedFunctions</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lra.html">Lra</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.Omega.html">Omega</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CertRL.utils.Floatish.html">Floatish</a></span> <span class="id"><a href="CertRL.utils.Utils.html">Utils</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="GenNN">GenNN</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">floatish_impl</span>:<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#floatish">floatish</a></span>}.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">float</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="UnitDefinedFunction">UnitDefinedFunction</a></span> := @<span class="id"><a href="CertRL.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="CertRL.Gen_NN.html#GenNN.floatish_impl">floatish_impl</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#UnitAnn">UnitAnn</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="FullNN">FullNN</a></span> : <span class="kwd">Type</span> := <span class="id"><a name="mkNN">mkNN</a></span> { <span class="id"><a name="ldims">ldims</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>; <span class="id"><a name="param_var">param_var</a></span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="f_activ">f_activ</a></span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>; <span class="id"><a name="f_loss">f_loss</a></span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> }.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkSubVarVector">mkSubVarVector</a></span> (<span class="id">v</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#DVector">DVector</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#v">v</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>), <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkVarVector">mkVarVector</a></span> (<span class="id">v</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#v">v</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkSubVarMatrix">mkSubVarMatrix</a></span> (<span class="id">v</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span> <span class="id"><a href="CertRL.Gen_NN.html#m">m</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#DMatrix">DMatrix</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#v">v</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>), <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkVarMatrix">mkVarMatrix</a></span> (<span class="id">v</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">n</span> <span class="id">m</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span> <span class="id"><a href="CertRL.Gen_NN.html#m">m</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#v">v</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span> <span class="id"><a href="CertRL.Gen_NN.html#m">m</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="unique_var">unique_var</a></span> {<span class="id">Ann</span>} (<span class="id">df</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#DefinedFunction">DefinedFunction</a></span> <span class="id"><a href="CertRL.Gen_NN.html#Ann">Ann</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fv</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nodup">nodup</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#vart_dec">vart_dec</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#df_free_variables">df_free_variables</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#fv">fv</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">v</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.   <br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="activation">activation</a></span> (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">vec</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#unique_var">unique_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">dfj</span> =&gt; <span class="id"><a href="CertRL.DefinedFunctions.html#df_subst">df_subst</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> (<span class="id">v</span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#dfj">dfj</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#vec">vec</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="create_activation_fun">create_activation_fun</a></span> (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> -&gt; <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#unique_var">unique_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">v</span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="kwd">fun</span> <span class="id">val</span> =&gt; <span class="id"><a href="CertRL.DefinedFunctions.html#df_subst">df_subst</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> (<span class="id">v</span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#val">val</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkNN2">mkNN2</a></span> (<span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat1</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkSubVarMatrix">mkSubVarMatrix</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 1) <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat2</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkSubVarMatrix">mkSubVarMatrix</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 2) <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivec</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkVarVector">mkVarVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N1</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span>  <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#N1">N1</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkVarNN2">mkVarNN2</a></span> (<span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat1</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 1, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat2</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 2, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivec</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N1</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#N1">N1</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkVarMatNN2">mkVarMatNN2</a></span> (<span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> <span class="id">nsamp</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat1</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 1, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat2</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 2, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">imat</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N1</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#imat">imat</a></span>) <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#N1">N1</a></span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkNN_bias_step">mkNN_bias_step</a></span> (<span class="id">n1</span> <span class="id">n2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivec</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mat</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">bias</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#VectorPlus">VectorPlus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixVectorMult">MatrixVectorMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat">mat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#bias">bias</a></span>).<br/>
<br/>
&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkNN2_bias">mkNN2_bias</a></span> (<span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat1</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkSubVarMatrix">mkSubVarMatrix</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 1) <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b1</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkSubVarVector">mkSubVarVector</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 1) <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat2</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkSubVarMatrix">mkSubVarMatrix</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 2) <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b2</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkSubVarVector">mkSubVarVector</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 2) <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivec</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkVarVector">mkVarVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N1</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_bias_step">mkNN_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b1">b1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#mkNN_bias_step">mkNN_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#N1">N1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b2">b2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span>.<br/>
<br/>
&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkNN2_Var_bias">mkNN2_Var_bias</a></span> (<span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> <span class="id">bvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat1</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 1, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b1</span> :=  (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span> 1, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat2</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 2, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b2</span> :=  (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span> 2, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivec</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N1</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_bias_step">mkNN_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b1">b1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#mkNN_bias_step">mkNN_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#N1">N1</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b2">b2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#b1">b1</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#b2">b2</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkNN_Mat_bias_step">mkNN_Mat_bias_step</a></span> (<span class="id">n1</span> <span class="id">n2</span> <span class="id">nsamp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">imat</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mat</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">bias</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixApply">MatrixApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixVectorAdd">MatrixVectorAdd</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#MatrixMult">MatrixMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat">mat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#imat">imat</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#bias">bias</a></span>).<br/>
<br/>
&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkNN2_Var_Mat_bias">mkNN2_Var_Mat_bias</a></span> (<span class="id">n1</span> <span class="id">n2</span> <span class="id">n3</span> <span class="id">nsamp</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> <span class="id">bvar</span>: <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">f1_activ</span> <span class="id">f2_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">f1_activ_var</span> <span class="id">f2_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>)  :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat1</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 1, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b1</span> :=  (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span> 1, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat2</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 2, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b2</span> :=  (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span> 2, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">imat</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N1</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_Mat_bias_step">mkNN_Mat_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#imat">imat</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b1">b1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#f1_activ_var">f1_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f1_activ">f1_activ</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#mkNN_Mat_bias_step">mkNN_Mat_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n3">n3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#N1">N1</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b2">b2</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#f2_activ_var">f2_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f2_activ">f2_activ</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#b1">b1</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#mat2">mat2</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#b2">b2</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="vector_float_map_last_rewrite">vector_float_map_last_rewrite</a></span> {<span class="id">B</span> <span class="id">nvlist1</span> <span class="id">n2</span> <span class="id">v</span> <span class="id">n1</span>} :<br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> ((@<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span> <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#nvlist1">nvlist1</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>)) = <br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span>((<span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#v">v</a></span>) :: <span class="id"><a href="CertRL.Gen_NN.html#nvlist1">nvlist1</a></span>)) <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2239')">Proof.</div>
<div class="proofscript" id="proof2239">
&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_cons">domain_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#last_cons">last_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;Qed.</div>
<br/>
&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="matrix_float_map_last_rewrite">matrix_float_map_last_rewrite</a></span> {<span class="id">B</span> <span class="id">nvlist1</span> <span class="id">n2</span> <span class="id">v</span> <span class="id">n1</span> <span class="id">nsamp</span>} :<br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> ((@<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span> <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#nvlist1">nvlist1</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) = <br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span>((<span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#v">v</a></span>) :: <span class="id"><a href="CertRL.Gen_NN.html#nvlist1">nvlist1</a></span>)) <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2240')">Proof.</div>
<div class="proofscript" id="proof2240">
&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_cons">domain_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#last_cons">last_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="mkNN_gen_0">mkNN_gen_0</a></span> (<span class="id">n1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">nvlist</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ivec</span> : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span> ) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nvlist">nvlist</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>))<br/>
:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#nvlist">nvlist</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id">n2</span>,<span class="id">v</span>) <span class="id">nvlist1</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkSubVarMatrix">mkSubVarMatrix</a></span> <span class="id">v</span> <span class="id">n2</span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkSubVarVector">mkSubVarVector</a></span> <span class="id">v</span> <span class="id">n2</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_bias_step">mkNN_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id">n2</span> <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat">mat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#mkNN_gen_0">mkNN_gen_0</a></span> <span class="id">n2</span> <span class="id">nvlist1</span> <span class="id"><a href="CertRL.Gen_NN.html#N">N</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span>) <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#vector_float_map_last_rewrite">vector_float_map_last_rewrite</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="mkNN_Var_gen_0">mkNN_Var_gen_0</a></span> (<span class="id">n1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">nvlist</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ivec</span> : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span> ) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nvlist">nvlist</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>))<br/>
:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#nvlist">nvlist</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id">n2</span>,<span class="id">v</span>) <span class="id">nvlist1</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkVarMatrix">mkVarMatrix</a></span> <span class="id">v</span> <span class="id">n2</span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkVarVector">mkVarVector</a></span> <span class="id">v</span> <span class="id">n2</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_bias_step">mkNN_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id">n2</span> <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat">mat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#mkNN_Var_gen_0">mkNN_Var_gen_0</a></span> <span class="id">n2</span> <span class="id">nvlist1</span> <span class="id"><a href="CertRL.Gen_NN.html#N">N</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span>) <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#vector_float_map_last_rewrite">vector_float_map_last_rewrite</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="mkNN_Mat_Var_gen_0">mkNN_Mat_Var_gen_0</a></span> (<span class="id">nsamp</span> <span class="id">n1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">nvlist</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">imat</span> : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span> ) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nvlist">nvlist</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>)<br/>
:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#nvlist">nvlist</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#imat">imat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id">n2</span>,<span class="id">v</span>) <span class="id">nvlist1</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkVarMatrix">mkVarMatrix</a></span> <span class="id">v</span> <span class="id">n2</span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkVarVector">mkVarVector</a></span> <span class="id">v</span> <span class="id">n2</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_Mat_bias_step">mkNN_Mat_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id">n2</span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#imat">imat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat">mat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#mkNN_Mat_Var_gen_0">mkNN_Mat_Var_gen_0</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="id">n2</span> <span class="id">nvlist1</span> <span class="id"><a href="CertRL.Gen_NN.html#N">N</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span>) <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#matrix_float_map_last_rewrite">matrix_float_map_last_rewrite</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="mkNN_gen">mkNN_gen</a></span> (<span class="id">n1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">nlist</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> <span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nlist">nlist</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vlist</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 1 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nlist">nlist</a></span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivec</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkVarVector">mkVarVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#mkNN_gen_0">mkNN_gen_0</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nlist">nlist</a></span> <span class="id"><a href="CertRL.Gen_NN.html#vlist">vlist</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span>) <span class="id">_</span> <span class="id">_</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2241')">Next Obligation.</div>
<div class="proofscript" id="proof2241">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#combine_domain_eq">combine_domain_eq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="mkNN_Var_gen">mkNN_Var_gen</a></span> (<span class="id">n1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">nlist</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> <span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nlist">nlist</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vlist</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 1 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nlist">nlist</a></span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivec</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkVarVector">mkVarVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#mkNN_Var_gen_0">mkNN_Var_gen_0</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nlist">nlist</a></span> <span class="id"><a href="CertRL.Gen_NN.html#vlist">vlist</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span>) <span class="id">_</span> <span class="id">_</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2242')">Next Obligation.</div>
<div class="proofscript" id="proof2242">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#combine_domain_eq">combine_domain_eq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="mkNN_Mat_Var_gen">mkNN_Mat_Var_gen</a></span> (<span class="id">nsamp</span> <span class="id">n1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">nlist</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> <span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nlist">nlist</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vlist</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 1 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nlist">nlist</a></span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">imat</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkVarMatrix">mkVarMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_rect">eq_rect</a></span> <span class="id">_</span> <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#mkNN_Mat_Var_gen_0">mkNN_Mat_Var_gen_0</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nlist">nlist</a></span> <span class="id"><a href="CertRL.Gen_NN.html#vlist">vlist</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#imat">imat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span>) <span class="id">_</span> <span class="id">_</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2243')">Next Obligation.</div>
<div class="proofscript" id="proof2243">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#combine_domain_eq">combine_domain_eq</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="softmax">softmax</a></span> {<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">NN</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span>)) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">expvar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">expvar</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">NNexp</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#VectorApply">VectorApply</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#expvar">expvar</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Exp">Exp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#expvar">expvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)) <span class="id"><a href="CertRL.Gen_NN.html#NN">NN</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">NNexpscale</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 1) (<span class="id"><a href="CertRL.DefinedFunctions.html#VectorSum">VectorSum</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#NNexp">NNexp</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#VectorScalMult">VectorScalMult</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#NNexpscale">NNexpscale</a></span> <span class="id"><a href="CertRL.Gen_NN.html#NNexp">NNexp</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="L2loss">L2loss</a></span> (<span class="id">nnvar</span> <span class="id">ovar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#Square">Square</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> ( <span class="id"><a href="CertRL.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#nnvar">nnvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ovar">ovar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) ).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="L1loss">L1loss</a></span> (<span class="id">nnvar</span> <span class="id">ovar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#Abs">Abs</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#nnvar">nnvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ovar">ovar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="Sigmoid">Sigmoid</a></span> (<span class="id">var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#Divide">Divide</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 1) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#Plus">Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 1) (<span class="id"><a href="CertRL.DefinedFunctions.html#Exp">Exp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 0) (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#var">var</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>)))).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="CrossEntropy">CrossEntropy</a></span> (<span class="id">nnvar</span> <span class="id">ovar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">nnvar</span>' := <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#nnvar">nnvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ovar</span>' := <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ovar">ovar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ovar</span>' (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 1)) (<span class="id"><a href="CertRL.DefinedFunctions.html#Log">Log</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 1) <span class="id">nnvar</span>')))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">ovar</span>' (<span class="id"><a href="CertRL.DefinedFunctions.html#Log">Log</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">nnvar</span>')).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="testcases">testcases</a></span> : <span class="kwd">Type</span> := <span class="id"><a name="mkTest">mkTest</a></span> {<span class="id"><a name="ninput">ninput</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>; <span class="id"><a name="noutput">noutput</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>; <span class="id"><a name="ntest">ntest</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="datavec">datavec</a></span> : <span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> ((<span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ninput">ninput</a></span>) * (<span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noutput">noutput</a></span>)) <span class="id"><a href="CertRL.Gen_NN.html#ntest">ntest</a></span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="NNinstance1samp">NNinstance1samp</a></span> {<span class="id">ninput</span> <span class="id">noutput</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">ivar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_loss</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_loss_NNvar</span> <span class="id">f_loss_outvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NN</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noutput">noutput</a></span>)) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">data</span>: (<span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ninput">ninput</a></span>) * (<span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noutput">noutput</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> * (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ipair</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ninput">ninput</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ipair">ipair</a></span> σ, <span class="id"><a href="CertRL.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss_NNvar">f_loss_NNvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss_outvar">f_loss_outvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss">f_loss</a></span> <span class="id"><a href="CertRL.Gen_NN.html#NN">NN</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="NNinstancebatch">NNinstancebatch</a></span> {<span class="id">ninput</span> <span class="id">nsamp</span> <span class="id">noutput</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">ivar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_loss</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_loss_NNvar</span> <span class="id">f_loss_outvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NN</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noutput">noutput</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>)) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">data</span>: (<span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ninput">ninput</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) * (<span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noutput">noutput</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> * (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) :=             <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ipair</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ninput">ninput</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ipair">ipair</a></span> σ, <span class="id"><a href="CertRL.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss_NNvar">f_loss_NNvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss_outvar">f_loss_outvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss">f_loss</a></span> <span class="id"><a href="CertRL.Gen_NN.html#NN">NN</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="EvalNNinstance1samp">EvalNNinstance1samp</a></span> {<span class="id">ninput</span> <span class="id">noutput</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">ivar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_loss</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_loss_NNvar</span> <span class="id">f_loss_outvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NN</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noutput">noutput</a></span>)) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">data</span>: (<span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ninput">ninput</a></span>) * (<span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noutput">noutput</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ipair</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ninput">ninput</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ipair">ipair</a></span> σ) (<span class="id"><a href="CertRL.DefinedFunctions.html#VLossfun">VLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss_NNvar">f_loss_NNvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss_outvar">f_loss_outvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss">f_loss</a></span> <span class="id"><a href="CertRL.Gen_NN.html#NN">NN</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="EvalNNinstancebatch">EvalNNinstancebatch</a></span> {<span class="id">ninput</span> <span class="id">nsamp</span> <span class="id">noutput</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">ivar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_loss</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f_loss_NNvar</span> <span class="id">f_loss_outvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NN</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noutput">noutput</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>)) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">data</span>: (<span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ninput">ninput</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) * (<span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noutput">noutput</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ipair</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ninput">ninput</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#df_eval">df_eval</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ipair">ipair</a></span> σ) (<span class="id"><a href="CertRL.DefinedFunctions.html#MLossfun">MLossfun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss_NNvar">f_loss_NNvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss_outvar">f_loss_outvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_loss">f_loss</a></span> <span class="id"><a href="CertRL.Gen_NN.html#NN">NN</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span>)).<br/>
<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="lookup_list">lookup_list</a></span> (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">lvar</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsLiftIterators.html#listo_to_olist">listo_to_olist</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; (<span class="id"><a href="CertRL.DefinedFunctions.html#vartlookup">vartlookup</a></span> σ (<span class="id"><a href="CertRL.Gen_NN.html#v">v</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>)):<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#lvar">lvar</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="combine_with">combine_with</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>:<span class="kwd">Type</span>} {<span class="id">C</span>:<span class="kwd">Type</span>} (<span class="id">f</span>: <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span> -&gt; <span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span> -&gt; <span class="id"><a href="CertRL.Gen_NN.html#C">C</a></span> ) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lA</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>) (<span class="id">lB</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#C">C</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">a</span>, <span class="id">b</span>) =&gt; <span class="id"><a href="CertRL.Gen_NN.html#f">f</a></span> <span class="id"><a href="CertRL.Gen_NN.html#a">a</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id"><a href="CertRL.Gen_NN.html#lA">lA</a></span> <span class="id"><a href="CertRL.Gen_NN.html#lB">lB</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="combine3_with">combine3_with</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">B</span>:<span class="kwd">Type</span>} {<span class="id">C</span>:<span class="kwd">Type</span>} {<span class="id">D</span>:<span class="kwd">Type</span>} (<span class="id">f</span>: <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span> -&gt; <span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span> -&gt; <span class="id"><a href="CertRL.Gen_NN.html#C">C</a></span> -&gt; <span class="id"><a href="CertRL.Gen_NN.html#D">D</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lA</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>) (<span class="id">lB</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span>) (<span class="id">lC</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#C">C</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#D">D</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">a</span>, <span class="id">bc</span>) =&gt; <span class="id"><a href="CertRL.Gen_NN.html#f">f</a></span> <span class="id"><a href="CertRL.Gen_NN.html#a">a</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bc">bc</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bc">bc</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id"><a href="CertRL.Gen_NN.html#lA">lA</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id"><a href="CertRL.Gen_NN.html#lB">lB</a></span> <span class="id"><a href="CertRL.Gen_NN.html#lC">lC</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="streamtake">streamtake</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#st">st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>' =&gt; <span class="kwd">let</span> <span class="id">rst</span> := <span class="id"><a href="CertRL.Gen_NN.html#streamtake">streamtake</a></span> <span class="id">n</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id"><a href="CertRL.Gen_NN.html#st">st</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#st">st</a></span>)::(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.Gen_NN.html#rst">rst</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#rst">rst</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="streamtake_n">streamtake_n</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#streamtake">streamtake</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span> <span class="id"><a href="CertRL.Gen_NN.html#st">st</a></span>)) = <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2244')">Proof.</div>
<div class="proofscript" id="proof2244">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">st</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> <span class="id">IHn</span> <span class="kwd">with</span> (<span class="id">st</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id">st0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHn</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="env_update_first">env_update_first</a></span> (<span class="id">l</span>:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">an</span>:<span class="id"><a href="CertRL.DefinedFunctions.html#env_entry_type">env_entry_type</a></span>) : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">fv</span>::<span class="id">os</span> =&gt; <span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#an">an</a></span>) == (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id">fv</span>) <span class="kwd">then</span> <span class="id"><a href="CertRL.Gen_NN.html#an">an</a></span>::<span class="id">os</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">fv</span>::(<span class="id"><a href="CertRL.Gen_NN.html#env_update_first">env_update_first</a></span> <span class="id">os</span> <span class="id"><a href="CertRL.Gen_NN.html#an">an</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="env_update_list">env_update_list</a></span> (<span class="id">l</span> <span class="id">up</span>:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#env_update_first">env_update_first</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#up">up</a></span> <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="optimize_step">optimize_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">step</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">lvar</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">noise_st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">lvart</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span> := (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; (<span class="id"><a href="CertRL.Gen_NN.html#v">v</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) <span class="id"><a href="CertRL.Gen_NN.html#lvar">lvar</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ogradvec</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_gradient">df_eval_gradient</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> <span class="id"><a href="CertRL.Gen_NN.html#lvart">lvart</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">alpha</span> := 1 / (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.Gen_NN.html#step">step</a></span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">lnoise</span>, <span class="id">nst</span>) := <span class="id"><a href="CertRL.Gen_NN.html#streamtake">streamtake</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id"><a href="CertRL.Gen_NN.html#lvar">lvar</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">olvals</span> := <span class="id"><a href="CertRL.Gen_NN.html#lookup_list">lookup_list</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#lvar">lvar</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> (<span class="id"><a href="CertRL.Gen_NN.html#ogradvec">ogradvec</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#olvals">olvals</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradvec</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">lvals</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#env_update_list">env_update_list</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">v</span>,<span class="id">e</span>) =&gt; <span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#v">v</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id"><a href="CertRL.Gen_NN.html#e">e</a></span>:<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#combine">combine</a></span> <span class="id"><a href="CertRL.Gen_NN.html#lvar">lvar</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#combine3_with">combine3_with</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">val</span> <span class="id">grad</span> <span class="id">noise</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#val">val</a></span> - <span class="id"><a href="CertRL.Gen_NN.html#alpha">alpha</a></span>*(<span class="id"><a href="CertRL.Gen_NN.html#grad">grad</a></span> + <span class="id"><a href="CertRL.Gen_NN.html#noise">noise</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lvals</span> <span class="id">gradvec</span> <span class="id">lnoise</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">_</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>, <span class="id">nst</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="get_noise_vector">get_noise_vector</a></span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">noise_st</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; (<span class="id"><a href="CertRL.utils.Vector.html#vnil">vnil</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">noise</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">nst</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">vec</span>, <span class="id">nst</span>') := <span class="id"><a href="CertRL.Gen_NN.html#get_noise_vector">get_noise_vector</a></span> <span class="id">n</span>' <span class="id"><a href="CertRL.Gen_NN.html#nst">nst</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.Vector.html#vcons">vcons</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise">noise</a></span> <span class="id">vec</span>, <span class="id">nst</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="get_noise_matrix">get_noise_matrix</a></span> (<span class="id">n</span> <span class="id">m</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">noise_st</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span> <span class="id"><a href="CertRL.Gen_NN.html#m">m</a></span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">vec</span>, <span class="id">nst</span>) := <span class="id"><a href="CertRL.Gen_NN.html#get_noise_vector">get_noise_vector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#m">m</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">vec</span>, <span class="id">nst</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">mat</span>, <span class="id">nst</span>') := <span class="id"><a href="CertRL.Gen_NN.html#get_noise_matrix">get_noise_matrix</a></span> <span class="id">n</span>' <span class="id"><a href="CertRL.Gen_NN.html#m">m</a></span> <span class="id">nst</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.Vector.html#vcons">vcons</a></span> <span class="id">vec</span> <span class="id">mat</span>, <span class="id">nst</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="get_noise">get_noise</a></span> (<span class="id">t</span>:<span class="id"><a href="CertRL.DefinedFunctions.html#definition_function_types">definition_function_types</a></span>) (<span class="id">noise_st</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#t">t</a></span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#hd">Streams.hd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#tl">Streams.tl</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#get_noise_vector">get_noise_vector</a></span> <span class="id">n</span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#get_noise_matrix">get_noise_matrix</a></span> <span class="id">m</span> <span class="id">n</span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="update_val_gradenv">update_val_gradenv</a></span> (<span class="id">grad_env</span>:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">x</span>:<span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) (<span class="id">alpha</span>:<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span> <span class="kwd">as</span> <span class="id">y</span> <span class="kwd">return</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span> = <span class="id"><a href="CertRL.Gen_NN.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.DefinedFunctions.html#definition_function_types_interp">definition_function_types_interp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#y">y</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> =&gt;  <span class="kwd">fun</span> <span class="id">pf</span> <span class="id">val</span> <span class="id">noise</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id"><a href="CertRL.Gen_NN.html#grad_env">grad_env</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#val">val</a></span> - <span class="id"><a href="CertRL.Gen_NN.html#alpha">alpha</a></span> * (<span class="id"><a href="CertRL.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> <span class="id">grad</span> + <span class="id"><a href="CertRL.Gen_NN.html#noise">noise</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#val">val</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">pf</span> <span class="id">val</span> <span class="id">noise</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id"><a href="CertRL.Gen_NN.html#grad_env">grad_env</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#val">val</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>) - <span class="id"><a href="CertRL.Gen_NN.html#alpha">alpha</a></span> * (((<span class="id"><a href="CertRL.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> <span class="id">grad</span>) <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>) + (<span class="id"><a href="CertRL.Gen_NN.html#noise">noise</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#val">val</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id">m</span> <span class="id">n</span> =&gt; <span class="kwd">fun</span> <span class="id">pf</span> <span class="id">val</span> <span class="id">noise</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#vartlookup">vartlookup</a></span> <span class="id"><a href="CertRL.Gen_NN.html#grad_env">grad_env</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">grad</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#val">val</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>) - <span class="id"><a href="CertRL.Gen_NN.html#alpha">alpha</a></span> * (((<span class="id"><a href="CertRL.utils.BasicUtils.html#coerce">coerce</a></span> <span class="id">_</span> <span class="id">grad</span>) <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>) + (<span class="id"><a href="CertRL.Gen_NN.html#noise">noise</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#val">val</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>)<br/>
&nbsp;&nbsp;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2245')">Next Obligation.</div>
<div class="proofscript" id="proof2245">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">pf</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof2246')">Next Obligation.</div>
<div class="proofscript" id="proof2246">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">pf</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof2247')">Next Obligation.</div>
<div class="proofscript" id="proof2247">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">pf</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="update_entry">update_entry</a></span> (<span class="id">entry</span>: <span class="id"><a href="CertRL.DefinedFunctions.html#env_entry_type">env_entry_type</a></span>) (<span class="id">grad_env</span>:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">alpha</span>:<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">noise_st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) : (<span class="id"><a href="CertRL.DefinedFunctions.html#env_entry_type">env_entry_type</a></span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT1">projT1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#entry">entry</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">val</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#projT2">projT2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#entry">entry</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">noise</span>, <span class="id">nst</span>) := <span class="id"><a href="CertRL.Gen_NN.html#get_noise">get_noise</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#update_val_gradenv">update_val_gradenv</a></span> <span class="id"><a href="CertRL.Gen_NN.html#grad_env">grad_env</a></span> <span class="id"><a href="CertRL.Gen_NN.html#x">x</a></span> <span class="id"><a href="CertRL.Gen_NN.html#alpha">alpha</a></span> <span class="id"><a href="CertRL.Gen_NN.html#val">val</a></span> <span class="id">noise</span>), <span class="id">nst</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="list_arg_iter">list_arg_iter</a></span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>: <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span> -&gt; <span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span> -&gt; <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span> * <span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>) (<span class="id">b</span>: <span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>)*<span class="id"><a href="CertRL.Gen_NN.html#B">B</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; (<span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span> :: <span class="id">l</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">na</span>, <span class="id">b</span>') := <span class="id"><a href="CertRL.Gen_NN.html#f">f</a></span> <span class="id">a</span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">nl</span>, <span class="id">nb</span>) := <span class="id"><a href="CertRL.Gen_NN.html#list_arg_iter">list_arg_iter</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f">f</a></span> <span class="id">l</span>' <span class="id">b</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">na</span>::<span class="id">nl</span>, <span class="id">nb</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.         <br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="harmonic_lr">harmonic_lr</a></span> (<span class="id">step</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> := 1 / (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.Gen_NN.html#step">step</a></span>))).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="optimize_step_backprop">optimize_step_backprop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">step</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">lr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">noise_st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">dvars</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#gradenv_init">gradenv_init</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dvars">dvars</a></span>) 1 <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">alpha</span> := <span class="id"><a href="CertRL.Gen_NN.html#lr">lr</a></span> <span class="id"><a href="CertRL.Gen_NN.html#step">step</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">env</span>, <span class="id">nst</span>) := <span class="id"><a href="CertRL.Gen_NN.html#list_arg_iter">list_arg_iter</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">b</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#update_entry">update_entry</a></span> <span class="id"><a href="CertRL.Gen_NN.html#a">a</a></span> <span class="id">gradenv</span> <span class="id"><a href="CertRL.Gen_NN.html#alpha">alpha</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span>) σ <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>, <span class="id">nst</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="optimize_step_tree_backprop">optimize_step_tree_backprop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">step</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">lr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">noise_st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">dvars</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">df_tree</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_tree_backprop_deriv">df_eval_tree_backprop_deriv</a></span>  <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">df_tree</span> (<span class="id"><a href="CertRL.DefinedFunctions.html#gradenv_init">gradenv_init</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dvars">dvars</a></span>) 1 <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">alpha</span> := <span class="id"><a href="CertRL.Gen_NN.html#lr">lr</a></span> <span class="id"><a href="CertRL.Gen_NN.html#step">step</a></span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">env</span>, <span class="id">nst</span>) := <span class="id"><a href="CertRL.Gen_NN.html#list_arg_iter">list_arg_iter</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">b</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#update_entry">update_entry</a></span> <span class="id"><a href="CertRL.Gen_NN.html#a">a</a></span> <span class="id">gradenv</span> <span class="id"><a href="CertRL.Gen_NN.html#alpha">alpha</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span>) σ <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span>, <span class="id">nst</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="optimize_steps">optimize_steps</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> <span class="id">count</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">lvar</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">noise_st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#count">count</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> σ, <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#optimize_step">optimize_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#start">start</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#lvar">lvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> σ', <span class="id">noise_st</span>') =&gt; <span class="id"><a href="CertRL.Gen_NN.html#optimize_steps">optimize_steps</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.Gen_NN.html#start">start</a></span>) <span class="id">n</span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> σ' <span class="id"><a href="CertRL.Gen_NN.html#lvar">lvar</a></span> <span class="id">noise_st</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">noise_st</span>') =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">noise_st</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="optimize_steps_backprop">optimize_steps_backprop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> <span class="id">count</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">lr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">noise_st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">dvars</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#count">count</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> σ, <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#optimize_step_backprop">optimize_step_backprop</a></span> <span class="id"><a href="CertRL.Gen_NN.html#start">start</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#lr">lr</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dvars">dvars</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> σ', <span class="id">noise_st</span>') =&gt; <span class="id"><a href="CertRL.Gen_NN.html#optimize_steps_backprop">optimize_steps_backprop</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.Gen_NN.html#start">start</a></span>) <span class="id">n</span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> σ' <span class="id"><a href="CertRL.Gen_NN.html#lr">lr</a></span> <span class="id">noise_st</span>' <span class="id"><a href="CertRL.Gen_NN.html#dvars">dvars</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">noise_st</span>') =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">noise_st</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="optimize_steps_tree_backprop">optimize_steps_tree_backprop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> <span class="id">count</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) (<span class="id">lr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> -&gt; <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">noise_st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">dvars</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>)*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#count">count</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> σ, <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#optimize_step_tree_backprop">optimize_step_tree_backprop</a></span> <span class="id"><a href="CertRL.Gen_NN.html#start">start</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#lr">lr</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dvars">dvars</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> σ', <span class="id">noise_st</span>') =&gt; <span class="id"><a href="CertRL.Gen_NN.html#optimize_steps_tree_backprop">optimize_steps_tree_backprop</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.Gen_NN.html#start">start</a></span>) <span class="id">n</span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> σ' <span class="id"><a href="CertRL.Gen_NN.html#lr">lr</a></span> <span class="id">noise_st</span>' <span class="id"><a href="CertRL.Gen_NN.html#dvars">dvars</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">noise_st</span>') =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">noise_st</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Fmax">Fmax</a></span> (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) : <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#Fgt">Fgt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#a">a</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span> <span class="kwd">then</span> <span class="id"><a href="CertRL.Gen_NN.html#a">a</a></span> <span class="kwd">else</span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Fmin">Fmin</a></span> (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) : <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#Flt">Flt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#a">a</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span> <span class="kwd">then</span> <span class="id"><a href="CertRL.Gen_NN.html#a">a</a></span> <span class="kwd">else</span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="vmax">vmax</a></span> {<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">vec</span> : <span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="CertRL.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#Fmax">Fmax</a></span> (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> 0) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id"><a href="CertRL.Gen_NN.html#vec">vec</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="vmin">vmin</a></span> {<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>} (<span class="id">vec</span> : <span class="id"><a href="CertRL.utils.Vector.html#Vector">Vector</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n">n</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="CertRL.utils.Vector.html#vector_fold_right1">vector_fold_right1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#Fmin">Fmin</a></span> (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> 0) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id"><a href="CertRL.Gen_NN.html#vec">vec</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="nrows">nrows</a></span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>)) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ncols">ncols</a></span> {<span class="id">A</span>} (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.Gen_NN.html#A">A</a></span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">r</span> :: <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">List.length</a></span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="normalizeIntData">normalizeIntData</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)) : <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#nrows">nrows</a></span> <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span>) (<span class="id"><a href="CertRL.Gen_NN.html#ncols">ncols</a></span> <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat</span> : <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#nrows">nrows</a></span> <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span>) (<span class="id"><a href="CertRL.Gen_NN.html#ncols">ncols</a></span> <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">List.nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#l">l</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (0)%<span class="id">Z</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">tmat</span> := <span class="id"><a href="CertRL.utils.Vector.html#transpose">transpose</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat">mat</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">maxes</span> := <span class="id"><a href="CertRL.utils.Vector.html#vmap">vmap</a></span> <span class="id"><a href="CertRL.Gen_NN.html#vmax">vmax</a></span> <span class="id"><a href="CertRL.Gen_NN.html#tmat">tmat</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mins</span> := <span class="id"><a href="CertRL.utils.Vector.html#vmap">vmap</a></span> <span class="id"><a href="CertRL.Gen_NN.html#vmin">vmin</a></span> <span class="id"><a href="CertRL.Gen_NN.html#tmat">tmat</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; ((<span class="id"><a href="CertRL.Gen_NN.html#mat">mat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>) - (<span class="id"><a href="CertRL.Gen_NN.html#mins">mins</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>))/((<span class="id"><a href="CertRL.Gen_NN.html#maxes">maxes</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>)- (<span class="id"><a href="CertRL.Gen_NN.html#mins">mins</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>)).<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="splitLastCol">splitLastCol</a></span> {<span class="id">nsamp</span> <span class="id">ncols</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>}  (<span class="id">data</span> : <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ncols">ncols</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf</span> : (<span class="id"><a href="CertRL.Gen_NN.html#ncols">ncols</a></span> &gt; 0)%<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ncols">ncols</a></span>-1) <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) * (<span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> 1 <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) :=<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span>, <span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id"><a href="CertRL.Gen_NN.html#data">data</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span> + <span class="id"><a href="CertRL.Gen_NN.html#ncols">ncols</a></span>-1)%<span class="id">nat</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2248')">Next Obligation.</div>
<div class="proofscript" id="proof2248">
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof2249')">Next Obligation.</div>
<div class="proofscript" id="proof2249">
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Defined.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Definition</span> <span class="id"><a name="init_env2">init_env2</a></span> (<span class="id">dim1</span> <span class="id">dim2</span> <span class="id">dim3</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">w</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ranm1</span> : <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim2">dim2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim1">dim1</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ranm2</span> : <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim3">dim3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim2">dim2</a></span>) : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">wvar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> <span class="id"><a href="CertRL.Gen_NN.html#w">w</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bvar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b">b</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">wvar1</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 1, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim2">dim2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim1">dim1</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">wvar2</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> 2, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim3">dim3</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim2">dim2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bvar1</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span> 1, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim2">dim2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bvar2</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Sub">Sub</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span> 2, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim3">dim3</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar1">wvar1</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id"><a href="CertRL.Gen_NN.html#ranm1">ranm1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>) / (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#Fsqrt">Fsqrt</a></span> (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim1">dim1</a></span>))))) :: <br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar2">wvar2</a></span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id"><a href="CertRL.Gen_NN.html#ranm2">ranm2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#i">i</a></span> <span class="id"><a href="CertRL.Gen_NN.html#j">j</a></span>) / (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#Fsqrt">Fsqrt</a></span> (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim2">dim2</a></span>))))) ::<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar1">bvar1</a></span> (<span class="id"><a href="CertRL.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim2">dim2</a></span> 0)) :: <br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar2">bvar2</a></span> (<span class="id"><a href="CertRL.utils.Vector.html#ConstVector">ConstVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dim3">dim3</a></span> 0)) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<br/>
&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkNN_wisconsin">mkNN_wisconsin</a></span> (<span class="id">nsamp</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> <span class="id">bvar</span> <span class="id">f1v</span> <span class="id">f2v</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> 1 <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f1_activ</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Max">Max</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#f1v">f1v</a></span>,<span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 0) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f2_activ</span> := <span class="id"><a href="CertRL.Gen_NN.html#Sigmoid">Sigmoid</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f2v">f2v</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#mkNN2_Var_Mat_bias">mkNN2_Var_Mat_bias</a></span> 9 15 1 <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f1_activ">f1_activ</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f2_activ">f2_activ</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f1v">f1v</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f2v">f2v</a></span>.<br/>
<br/>
&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="eval_wisconsin_batch">eval_wisconsin_batch</a></span> (<span class="id">nsamp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">normaldata</span>: <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> 10)   : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivar</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">i</span>") <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">flnnv</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">NNv</span>") <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">outnnv</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">outnnv</span>") <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">NN</span>, <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_wisconsin">mkNN_wisconsin</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">w</span>") (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">b</span>") (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">f1v</span>") (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">f2v</span>") <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;@<span class="id"><a href="CertRL.Gen_NN.html#EvalNNinstancebatch">EvalNNinstancebatch</a></span> 9 <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> 1 <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#CrossEntropy">CrossEntropy</a></span> <span class="id"><a href="CertRL.Gen_NN.html#flnnv">flnnv</a></span> <span class="id"><a href="CertRL.Gen_NN.html#outnnv">outnnv</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#flnnv">flnnv</a></span> <span class="id"><a href="CertRL.Gen_NN.html#outnnv">outnnv</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NN</span> σ (<span class="id"><a href="CertRL.Gen_NN.html#splitLastCol">splitLastCol</a></span> <span class="id"><a href="CertRL.Gen_NN.html#normaldata">normaldata</a></span> <span class="id">_</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2250')">Next Obligation.</div>
<div class="proofscript" id="proof2250">
&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;Qed.</div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="wisconsin_instance_batch">wisconsin_instance_batch</a></span> (<span class="id">nsamp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">normaldata</span>: <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> 10)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> * (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>)) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) := <br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivar</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">i</span>") <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">flnnv</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">NNv</span>") <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">outnnv</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">outnnv</span>") <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">NN</span>, <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_wisconsin">mkNN_wisconsin</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">w</span>") (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">b</span>") (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">f1v</span>") (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">f2v</span>") <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="CertRL.Gen_NN.html#NNinstancebatch">NNinstancebatch</a></span> 9 <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> 1 <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#CrossEntropy">CrossEntropy</a></span> <span class="id"><a href="CertRL.Gen_NN.html#flnnv">flnnv</a></span> <span class="id"><a href="CertRL.Gen_NN.html#outnnv">outnnv</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#flnnv">flnnv</a></span> <span class="id"><a href="CertRL.Gen_NN.html#outnnv">outnnv</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NN</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#splitLastCol">splitLastCol</a></span> <span class="id"><a href="CertRL.Gen_NN.html#normaldata">normaldata</a></span> <span class="id">_</span>), <span class="id">dvars</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2251')">Next Obligation.</div>
<div class="proofscript" id="proof2251">
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">CoFixpoint</span> <span class="id"><a name="zeronoise">zeronoise</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Cons">Cons</a></span> 0 <span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="wisconsin_test">wisconsin_test</a></span> (<span class="id">nsamp</span> <span class="id">count</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">normaldata</span>: <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> 10): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">nninst</span>, <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#wisconsin_instance_batch">wisconsin_instance_batch</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#normaldata">normaldata</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">lr</span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; 1 / (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> 100) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">onenv</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#optimize_steps_tree_backprop">optimize_steps_tree_backprop</a></span> 0 <span class="id"><a href="CertRL.Gen_NN.html#count">count</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nninst</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">nninst</span>) <span class="id"><a href="CertRL.Gen_NN.html#lr">lr</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span> <span class="id">dvars</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#onenv">onenv</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nenv</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">nenv</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nninst</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id">val</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>                  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="wisconsin_test_env">wisconsin_test_env</a></span> (<span class="id">nsamp</span> <span class="id">count</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">normaldata</span>: <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> 10): <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">nninst</span>, <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#wisconsin_instance_batch">wisconsin_instance_batch</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#normaldata">normaldata</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">lr</span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; 1 / (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> 100) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">onenv</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#optimize_steps_tree_backprop">optimize_steps_tree_backprop</a></span> 0 <span class="id"><a href="CertRL.Gen_NN.html#count">count</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nninst</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">nninst</span>) <span class="id"><a href="CertRL.Gen_NN.html#lr">lr</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span> <span class="id">dvars</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#onenv">onenv</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nenv</span> =&gt; <span class="id">nenv</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="xvar">xvar</a></span>:<span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">x</span>", <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>).<br/>
<span class="kwd">Example</span> <span class="id"><a name="xfun">xfun</a></span>:<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>.<br/>
<span class="kwd">Example</span> <span class="id"><a name="tquad">tquad</a></span>:<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xfun">xfun</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xfun">xfun</a></span>.<br/>
<span class="kwd">Example</span> <span class="id"><a name="quad">quad</a></span>:<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Times">Times</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xfun">xfun</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xfun">xfun</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 1).<br/>
<span class="kwd">Example</span> <span class="id"><a name="squad">squad</a></span>:<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Minus">Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Square">Square</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xfun">xfun</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 1).<br/>
<span class="kwd">Example</span> <span class="id"><a name="env">env</a></span> : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span> (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> 5))::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="gradenv">gradenv</a></span> := <span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id"><a href="CertRL.Gen_NN.html#env">env</a></span> <span class="id"><a href="CertRL.Gen_NN.html#quad">quad</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#gradenv_init">gradenv_init</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) 1 <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span> =&gt; <span class="id">gradenv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="gradenv_tree">gradenv_tree</a></span> := <br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> <span class="id"><a href="CertRL.Gen_NN.html#env">env</a></span> <span class="id"><a href="CertRL.Gen_NN.html#quad">quad</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">df_tree</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_tree_backprop_deriv">df_eval_tree_backprop_deriv</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">df_tree</span> (<span class="id"><a href="CertRL.DefinedFunctions.html#gradenv_init">gradenv_init</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) 1 <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span> =&gt; <span class="id">gradenv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="wisconsin_gradenv">wisconsin_gradenv</a></span> (<span class="id">nsamp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">normaldata</span>: <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> 10) : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">env</span>,<span class="id">nn</span>),<span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#wisconsin_instance_batch">wisconsin_instance_batch</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#normaldata">normaldata</a></span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">nn</span> (<span class="id"><a href="CertRL.DefinedFunctions.html#gradenv_init">gradenv_init</a></span> <span class="id">dvars</span>) 1 <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span> =&gt; <span class="id">gradenv</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="wisconsin_gradenv_tree">wisconsin_gradenv_tree</a></span> (<span class="id">nsamp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">normaldata</span>: <span class="id"><a href="CertRL.utils.Vector.html#Matrix">Matrix</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> 10) : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">env</span>,<span class="id">nn</span>),<span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#wisconsin_instance_batch">wisconsin_instance_batch</a></span> <span class="id"><a href="CertRL.Gen_NN.html#nsamp">nsamp</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#normaldata">normaldata</a></span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> <span class="id">env</span> <span class="id">nn</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">df_tree</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_tree_backprop_deriv">df_eval_tree_backprop_deriv</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">df_tree</span> (<span class="id"><a href="CertRL.DefinedFunctions.html#gradenv_init">gradenv_init</a></span> <span class="id">dvars</span>) 1 <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span> =&gt; <span class="id">gradenv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkperceptron">mkperceptron</a></span> (<span class="id">n1</span> <span class="id">n2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">ivar</span> <span class="id">wvar</span> <span class="id">bvar</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) (<span class="id">f_activ</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (<span class="id">f_activ_var</span> : <span class="id"><a href="CertRL.DefinedFunctions.html#SubVar">SubVar</a></span>) : (<span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mat1</span> := (<span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">b1</span> :=  (<span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivec</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">N1</span> := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_bias_step">mkNN_bias_step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n1">n1</a></span> <span class="id"><a href="CertRL.Gen_NN.html#n2">n2</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivec">ivec</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#b1">b1</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#f_activ_var">f_activ_var</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f_activ">f_activ</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#N1">N1</a></span>,  <span class="id"><a href="CertRL.Gen_NN.html#mat1">mat1</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#b1">b1</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkNN_test1">mkNN_test1</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">i</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">wvar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">w</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bvar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">b</span>" <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f1v</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">f1</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f1_activ</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Max">Max</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#Var">Var</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#f1v">f1v</a></span>,<span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>) (<span class="id"><a href="CertRL.DefinedFunctions.html#Number">Number</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> 0) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">nn</span>, <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkperceptron">mkperceptron</a></span> 2 2 <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f1_activ">f1_activ</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f1v">f1v</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">winit</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> 2 2) (<span class="id"><a href="CertRL.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> 2 2 1) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">binit</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> 2) (<span class="id"><a href="CertRL.utils.Vector.html#ConstVector">ConstVector</a></span> 2 1) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">datain</span> := <span class="id"><a href="CertRL.utils.Vector.html#ConstVector">ConstVector</a></span> 2 1 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">env</span> := (<span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> 2) (<span class="id"><a href="CertRL.utils.Vector.html#ConstVector">ConstVector</a></span> 2 1)):: <span class="id"><a href="CertRL.Gen_NN.html#winit">winit</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#binit">binit</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#env">env</a></span>, <span class="id">nn</span>).<br/>
<br/>
&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mkNN_test">mkNN_test</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ivar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">i</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">wvar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">w</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">bvar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">b</span>" <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f1v</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">f1</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f1_activ</span> := <span class="id"><a href="CertRL.Gen_NN.html#Sigmoid">Sigmoid</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f1v">f1v</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">nn</span>, <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkperceptron">mkperceptron</a></span> 2 2 <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f1_activ">f1_activ</a></span> <span class="id"><a href="CertRL.Gen_NN.html#f1v">f1v</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">datain</span> := <span class="id"><a href="CertRL.utils.Vector.html#ConstVector">ConstVector</a></span> 2 1 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">dataout</span> := <span class="id"><a href="CertRL.utils.Vector.html#ConstVector">ConstVector</a></span> 2 0 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">loss_nnvar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">lv</span>" <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">loss_ovar</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#Name">Name</a></span> "<span class="id">ov</span>" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">floss</span> := <span class="id"><a href="CertRL.Gen_NN.html#CrossEntropy">CrossEntropy</a></span> <span class="id"><a href="CertRL.Gen_NN.html#loss_nnvar">loss_nnvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#loss_ovar">loss_ovar</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">winit</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#wvar">wvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTMatrix">DTMatrix</a></span> 2 2) (<span class="id"><a href="CertRL.utils.Vector.html#ConstMatrix">ConstMatrix</a></span> 2 2 (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> 2)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">binit</span> := <span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#bvar">bvar</a></span>, <span class="id"><a href="CertRL.DefinedFunctions.html#DTVector">DTVector</a></span> 2) (<span class="id"><a href="CertRL.utils.Vector.html#ConstVector">ConstVector</a></span> 2 (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> 3)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">env</span> := <span class="id"><a href="CertRL.Gen_NN.html#winit">winit</a></span> :: <span class="id"><a href="CertRL.Gen_NN.html#binit">binit</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.Gen_NN.html#NNinstance1samp">NNinstance1samp</a></span> <span class="id"><a href="CertRL.Gen_NN.html#ivar">ivar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#floss">floss</a></span> <span class="id"><a href="CertRL.Gen_NN.html#loss_nnvar">loss_nnvar</a></span> <span class="id"><a href="CertRL.Gen_NN.html#loss_ovar">loss_ovar</a></span> <span class="id">nn</span> <span class="id"><a href="CertRL.Gen_NN.html#env">env</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#datain">datain</a></span>, <span class="id"><a href="CertRL.Gen_NN.html#dataout">dataout</a></span>), <span class="id">dvars</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="NN_test">NN_test</a></span> (<span class="id">count</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">nninst</span>, <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_test">mkNN_test</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">onenv</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#optimize_steps_tree_backprop">optimize_steps_tree_backprop</a></span> 0 <span class="id"><a href="CertRL.Gen_NN.html#count">count</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nninst</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">nninst</span>) <span class="id"><a href="CertRL.Gen_NN.html#harmonic_lr">harmonic_lr</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span> <span class="id">dvars</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#onenv">onenv</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nenv</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">nenv</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nninst</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id">val</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>                  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="NN_test_gradenv">NN_test_gradenv</a></span> : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> := <br/>
&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">env</span>, <span class="id">nn</span>), <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_test">mkNN_test</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_backprop_deriv">df_eval_backprop_deriv</a></span> <span class="id">env</span> <span class="id">nn</span> (<span class="id"><a href="CertRL.DefinedFunctions.html#gradenv_init">gradenv_init</a></span> <span class="id">dvars</span>) 1 <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span> =&gt; <span class="id">gradenv</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="NN_test_gradenv_tree">NN_test_gradenv_tree</a></span> :<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> := <br/>
&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">env</span>, <span class="id">nn</span>), <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_test">mkNN_test</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_tree">df_eval_tree</a></span> <span class="id">env</span> <span class="id">nn</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">df_tree</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval_tree_backprop_deriv">df_eval_tree_backprop_deriv</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">df_tree</span> (<span class="id"><a href="CertRL.DefinedFunctions.html#gradenv_init">gradenv_init</a></span> <span class="id">dvars</span>) 1 <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gradenv</span> =&gt; <span class="id">gradenv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>                    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="NN_test_env">NN_test_env</a></span> (<span class="id">count</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">nninst</span>, <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_test">mkNN_test</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">onenv</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#optimize_steps_tree_backprop">optimize_steps_tree_backprop</a></span> 0 <span class="id"><a href="CertRL.Gen_NN.html#count">count</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">nninst</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">nninst</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.Gen_NN.html#harmonic_lr">harmonic_lr</a></span> <span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span> <span class="id">dvars</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.Gen_NN.html#onenv">onenv</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nenv</span> =&gt; <span class="id">nenv</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="NN_test_NN">NN_test_NN</a></span>  :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">env</span>,<span class="id">nn</span>), <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_test">mkNN_test</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">nn</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="NN_test_val">NN_test_val</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '((<span class="id">env</span>,<span class="id">nn</span>), <span class="id">dvars</span>) := <span class="id"><a href="CertRL.Gen_NN.html#mkNN_test">mkNN_test</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.DefinedFunctions.html#df_eval">df_eval</a></span> <span class="id">env</span> <span class="id">nn</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">val</span> =&gt; <span class="id">val</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="test_update_val_gradenv">test_update_val_gradenv</a></span><br/>
&nbsp;&nbsp;:= <span class="id"><a href="CertRL.Gen_NN.html#update_val_gradenv">update_val_gradenv</a></span> <span class="id"><a href="CertRL.Gen_NN.html#gradenv">gradenv</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span> 1 (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> 5) 0.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="test_update">test_update</a></span> : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> := <br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#update_entry">update_entry</a></span> (<span class="id"><a href="CertRL.DefinedFunctions.html#mk_env_entry">mk_env_entry</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span> (<span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#FfromZ">FfromZ</a></span> 5)) <span class="id"><a href="CertRL.Gen_NN.html#gradenv">gradenv</a></span> 1 <span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span>))::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="test_optimize_step_backprop">test_optimize_step_backprop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">step</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">noise_st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">dvars</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#optimize_step_backprop">optimize_step_backprop</a></span> <span class="id"><a href="CertRL.Gen_NN.html#step">step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#harmonic_lr">harmonic_lr</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dvars">dvars</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span> =&gt; <span class="id">env</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="test_optimize_step_tree_backprop">test_optimize_step_tree_backprop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">step</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">df</span> : <span class="id"><a href="CertRL.Gen_NN.html#UnitDefinedFunction">UnitDefinedFunction</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#DTfloat">DTfloat</a></span>) (σ:<span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">noise_st</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html#Stream">Stream</a></span> <span class="id"><a href="CertRL.utils.Floatish.FloatishDef.html#float">float</a></span>) (<span class="id">dvars</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.DefinedFunctions.html#var_type">var_type</a></span>) : <span class="id"><a href="CertRL.DefinedFunctions.html#df_env">df_env</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#optimize_step_tree_backprop">optimize_step_tree_backprop</a></span> <span class="id"><a href="CertRL.Gen_NN.html#step">step</a></span> <span class="id"><a href="CertRL.Gen_NN.html#df">df</a></span> σ <span class="id"><a href="CertRL.Gen_NN.html#harmonic_lr">harmonic_lr</a></span> <span class="id"><a href="CertRL.Gen_NN.html#noise_st">noise_st</a></span> <span class="id"><a href="CertRL.Gen_NN.html#dvars">dvars</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">env</span> =&gt; <span class="id">env</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="testopt">testopt</a></span> := <span class="id"><a href="CertRL.Gen_NN.html#test_optimize_step_backprop">test_optimize_step_backprop</a></span> 0 <span class="id"><a href="CertRL.Gen_NN.html#quad">quad</a></span> <span class="id"><a href="CertRL.Gen_NN.html#env">env</a></span> <span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<span class="kwd">Example</span> <span class="id"><a name="testreeopt">testreeopt</a></span> := <span class="id"><a href="CertRL.Gen_NN.html#test_optimize_step_tree_backprop">test_optimize_step_tree_backprop</a></span> 0 <span class="id"><a href="CertRL.Gen_NN.html#quad">quad</a></span> <span class="id"><a href="CertRL.Gen_NN.html#env">env</a></span> <span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="opt">opt</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#optimize_steps">optimize_steps</a></span> 0 2 <span class="id"><a href="CertRL.Gen_NN.html#quad">quad</a></span> <span class="id"><a href="CertRL.Gen_NN.html#env">env</a></span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span>).<br/>
<span class="kwd">Example</span> <span class="id"><a name="opt2">opt2</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#optimize_steps_tree_backprop">optimize_steps_tree_backprop</a></span> 0 2 <span class="id"><a href="CertRL.Gen_NN.html#quad">quad</a></span> <span class="id"><a href="CertRL.Gen_NN.html#env">env</a></span> <span class="id"><a href="CertRL.Gen_NN.html#harmonic_lr">harmonic_lr</a></span> <span class="id"><a href="CertRL.Gen_NN.html#zeronoise">zeronoise</a></span> (<span class="id"><a href="CertRL.Gen_NN.html#xvar">xvar</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)).<br/>
<br/>
<span class="kwd">Example</span> <span class="id"><a name="val">val</a></span> := 1+1.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.Gen_NN.html#GenNN">GenNN</a></span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
