
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CertRL.utils.RiemannAdd</title>
<meta name="description" content="Documentation of Coq module CertRL.utils.RiemannAdd" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CertRL.utils.RiemannAdd</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbase.html">Reals.Rbase</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RList.html">Coq.Reals.RList</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html">Reals.Rfunctions</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis_reg.html">Ranalysis_reg</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Integration.html">Reals.Integration</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html">Rtrigo_def</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html">Sorted</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lra.html">Lra</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.Omega.html">Omega</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CertRL.lib_utils.LibUtils.html">LibUtils</a></span> <span class="id"><a href="CertRL.utils.Sums.html">Sums</a></span> <span class="id"><a href="CertRL.utils.ListAdd.html">ListAdd</a></span> <span class="id"><a href="CertRL.utils.RealAdd.html">RealAdd</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CertRL.utils.Isomorphism.html">Isomorphism</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">R_scope</span>.<br/>
<span class="kwd">Implicit</span> <span class="kwd">Type</span> <span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Partition">Partition</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">inc</span> := (<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>)/(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#i">i</a></span>)*<span class="id"><a href="CertRL.utils.RiemannAdd.html#inc">inc</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>+1)).<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_hd">Partition_hd</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">d</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#hd">hd</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#d">d</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) = <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1453')">Proof.</div>
<div class="proofscript" id="proof1453">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_nnil">Partition_nnil</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> : <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1454')">Proof.</div>
<div class="proofscript" id="proof1454">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_nth">Partition_nth</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">d</span> <span class="id">nn</span> : <br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#nn">nn</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#nn">nn</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#d">d</a></span> = <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#nn">nn</a></span>)*(<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>)/(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1455')">Proof.</div>
<div class="proofscript" id="proof1455">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.utils.ListAdd.html#map_nth_in_exists">map_nth_in_exists</a></span> (<span class="kwd">fun</span> <span class="id">i</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id">a</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#i">i</a></span> * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id">n</span> + 1)) <span class="id">d</span> <span class="id">nn</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_nth">seq_nth</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_length">Partition_length</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1456')">Proof.</div>
<div class="proofscript" id="proof1456">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq_length">seq_length</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_last">Partition_last</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">d</span> :<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#d">d</a></span> = <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1457')">Proof.</div>
<div class="proofscript" id="proof1457">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">npos</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.utils.ListAdd.html#nth_last">nth_last</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_nth">Partition_nth</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">field_simplify</span>.<br/>
&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_nzero">INR_nzero</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="list_hd_last">list_hd_last</a></span> {<span class="id">A</span>} (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#A">A</a></span>) <span class="id">d1</span> <span class="id">d2</span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span> &gt; 1)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#hd">hd</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#d1">d1</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#removelast">removelast</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span>) ++ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#d2">d2</a></span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nil">nil</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1458')">Proof.</div>
<div class="proofscript" id="proof1458">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_removelast_last">app_removelast_last</a></span> <span class="id">_</span> <span class="id">l</span> <span class="id">d2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_unfold_hd_tl">Partition_unfold_hd_tl</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &gt; 0)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>::<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">inc</span> := (<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>)/(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#i">i</a></span>)*<span class="id"><a href="CertRL.utils.RiemannAdd.html#inc">inc</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 1 (<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>-1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;++ (<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nil">nil</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1459')">Proof.</div>
<div class="proofscript" id="proof1459">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#list_hd_last">list_hd_last</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>) 0 0).<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_hd">Partition_hd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_last">Partition_last</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#removelast_map">removelast_map</a></span>, <span class="id"><a href="CertRL.utils.ListAdd.html#tl_map">tl_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#removelast_seq">removelast_seq</a></span>, <span class="id"><a href="CertRL.utils.ListAdd.html#tl_seq">tl_seq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_func_shift_nonneg">Partition_func_shift_nonneg</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">i</span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#i">i</a></span> * (<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1460')">Proof.</div>
<div class="proofscript" id="proof1460">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;- { <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_zero_lt">INR_zero_lt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_zero_lt">INR_zero_lt</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
Qed.</div>
&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_func_increasing">Partition_func_increasing</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Morphisms.Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">Morphisms.respectful</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rlt">Rlt</a></span>) (<span class="kwd">fun</span> <span class="id">i</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#i">i</a></span> * ((<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1461')">Proof.</div>
<div class="proofscript" id="proof1461">
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_zero_lt">INR_zero_lt</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_INR">lt_INR</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_func_eq">Partition_func_eq</a></span> <span class="id">a</span> <span class="id">n</span> <span class="id">i</span> :<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;  <br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#i">i</a></span> * ((<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) = <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1462')">Proof.</div>
<div class="proofscript" id="proof1462">
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span>-<span class="id">a</span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">field_simplify</span><br/>
&nbsp;&nbsp;; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_nzero">INR_nzero</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_nzero">INR_nzero</a></span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_func_nondecreasing">Partition_func_nondecreasing</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Morphisms.Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">Morphisms.respectful</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rle">Rle</a></span>) (<span class="kwd">fun</span> <span class="id">i</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#i">i</a></span> * ((<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1463')">Proof.</div>
<div class="proofscript" id="proof1463">
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_func_increasing">Partition_func_increasing</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_func_eq">Partition_func_eq</a></span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_StronglySorted_lt">Partition_StronglySorted_lt</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">StronglySorted</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rlt">Rlt</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1464')">Proof.</div>
<div class="proofscript" id="proof1464">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.ListAdd.html#StronglySorted_map">StronglySorted_map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rlt">Rlt</a></span>).<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_func_increasing">Partition_func_increasing</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.ListAdd.html#StronglySorted_seq">StronglySorted_seq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_StronglySorted_le">Partition_StronglySorted_le</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Sorted.html#StronglySorted">StronglySorted</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rle">Rle</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1465')">Proof.</div>
<div class="proofscript" id="proof1465">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.ListAdd.html#StronglySorted_map">StronglySorted_map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#lt">lt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rle">Rle</a></span>).<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_func_nondecreasing">Partition_func_nondecreasing</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.ListAdd.html#StronglySorted_seq">StronglySorted_seq</a></span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_nth_le">Partition_nth_le</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">idx1</span> <span class="id">idx2</span> <span class="id">d1</span> <span class="id">d2</span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#idx2">idx2</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#idx1">idx1</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx2">idx2</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx1">idx1</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#d1">d1</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx2">idx2</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#d2">d2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1466')">Proof.</div>
<div class="proofscript" id="proof1466">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.ListAdd.html#StronglySorted_nth_le">StronglySorted_nth_le</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_StronglySorted_le">Partition_StronglySorted_le</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_lower_bound">Partition_lower_bound</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">idx</span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1467')">Proof.</div>
<div class="proofscript" id="proof1467">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_hd">Partition_hd</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> 0) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.utils.ListAdd.html#nth_hd">nth_hd</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_nth_le">Partition_nth_le</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_upper_bound">Partition_upper_bound</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">idx</span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0 &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1468')">Proof.</div>
<div class="proofscript" id="proof1468">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_last">Partition_last</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> 0) <span class="tactic">at</span> 2 <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.utils.ListAdd.html#nth_last">nth_last</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_nth_le">Partition_nth_le</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_telescope">Partition_telescope</a></span> <span class="id">f</span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &gt; 0)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pl</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#removelast">removelast</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#pl">pl</a></span>)) - (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#pl">pl</a></span>)) =<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span>(<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>) - <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span>(<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1469')">Proof.</div>
<div class="proofscript" id="proof1469">
&nbsp;&nbsp;<span class="comment">(*&nbsp;strategy:&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A)&nbsp;show&nbsp;that&nbsp;we&nbsp;are&nbsp;mapping&nbsp;over&nbsp;1..n+1&nbsp;and&nbsp;0..n&nbsp;.&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B)&nbsp;Then&nbsp;reorder&nbsp;the&nbsp;folds&nbsp;to&nbsp;run&nbsp;over&nbsp;(n+1),1..n&nbsp;and&nbsp;0,1..n&nbsp;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C)&nbsp;since&nbsp;the&nbsp;tail&nbsp;parts&nbsp;of&nbsp;the&nbsp;fold&nbsp;are&nbsp;the&nbsp;same,&nbsp;we&nbsp;just&nbsp;need&nbsp;to&nbsp;reduce&nbsp;the&nbsp;first<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;and&nbsp;show&nbsp;the&nbsp;desired&nbsp;results<br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">nzero</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#removelast_map">removelast_map</a></span>, <span class="id"><a href="CertRL.utils.ListAdd.html#tl_map">tl_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#removelast_seq">removelast_seq</a></span>, <span class="id"><a href="CertRL.utils.ListAdd.html#tl_seq">tl_seq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id">n</span> + 1 - 1)%<span class="id">nat</span>) <span class="kwd">with</span> <span class="id">n</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;B&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span> ; [ <span class="tactic">omega</span> | ].<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) <span class="kwd">with</span> (0%<span class="id">nat</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 1 <span class="id">n</span>) <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#seq_Sn">seq_Sn</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [|- <span class="id">context</span> [<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> ?<span class="id">f</span> ?<span class="id">init</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> ?<span class="id">f1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> ?<span class="id">f2</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 1 <span class="id">n</span> ++ ((1 + <span class="id">n</span>)%<span class="id">nat</span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nil">nil</a></span>))))] ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f2</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 1 <span class="id">n</span> ++ ((1 + <span class="id">n</span>)%<span class="id">nat</span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nil">nil</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id">f</span> <span class="id">init</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f2</span> ((1 + <span class="id">n</span>)%<span class="id">nat</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 1 <span class="id">n</span>))))<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;C&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#map_cons">map_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Opaque</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Transparent</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_nzero">INR_nzero</a></span> <span class="kwd">in</span> <span class="id">nzero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_l_sym">Rinv_l_sym</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#fold_right_perm">fold_right_perm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_map">Permutation_map</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="orderedPartition">orderedPartition</a></span> (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)  :<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>&gt;0)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rpl</span> := <span class="id"><a href="CertRL.utils.Isomorphism.html#iso_b">iso_b</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RList.html#pos_Rl">pos_Rl</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#rpl">rpl</a></span> 0 = <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RList.html#pos_Rl">pos_Rl</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#rpl">rpl</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RList.html#Rlength">Rlength</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#rpl">rpl</a></span>)) = <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RList.html#ordered_Rlist">ordered_Rlist</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#rpl">rpl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1470')">Proof.</div>
<div class="proofscript" id="proof1470">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">rpl</span>.<br/>
&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">R_iso</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_nth">Partition_nth</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">split</span>].<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#S_INR">S_INR</a></span>; <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>; [<span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_nzero">INR_nzero</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">i</span> <span class="id">ilt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">R_iso</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span> <span class="kwd">in</span> <span class="id">ilt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_nth">Partition_nth</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#S_INR">S_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_zero_lt">INR_zero_lt</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_bucket_Partition">find_bucket_Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">idx</span> <span class="id">d1</span> <span class="id">d2</span> <span class="id">needle</span>:<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &gt; 0)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#d1">d1</a></span> &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#needle">needle</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#d2">d2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.ListAdd.html#find_bucket">find_bucket</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#needle">needle</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#d1">d1</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#d2">d2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1471')">Proof.</div>
<div class="proofscript" id="proof1471">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#find_bucket_nth_finds_Rle">find_bucket_nth_finds_Rle</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_StronglySorted_le">Partition_StronglySorted_le</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">tauto</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Definition</span> <span class="id"><a name="find_pt_le">find_pt_le</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">needle</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="CertRL.utils.ListAdd.html#find_bucket">find_bucket</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#needle">needle</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">lower</span>,<span class="id">upper</span>) =&gt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id">upper</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="part2step">part2step</a></span> (<span class="id">f</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &gt; 0)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#IsStepFun">IsStepFun</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#find_pt_le">find_pt_le</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1472')">Proof.</div>
<div class="proofscript" id="proof1472">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#IsStepFun">IsStepFun</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CertRL.utils.Isomorphism.html#iso_b">iso_b</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#is_subdivision">is_subdivision</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CertRL.utils.Isomorphism.html#iso_b">iso_b</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#tl">tl</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>)))).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#adapted_couple">adapted_couple</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#orderedPartition">orderedPartition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>) <span class="kwd">as</span> [? [??]]; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_left">Rmin_left</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_right">Rmax_right</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">R_iso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="CertRL.utils.ListAdd.html#length_S_tl">length_S_tl</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_nnil">Partition_nnil</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#constant_D_eq">constant_D_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#open_interval">open_interval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">idx</span> <span class="id">idxlt</span> <span class="id">x</span> <span class="id">openx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">R_iso</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span> <span class="kwd">in</span> <span class="id">idxlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">idxlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#find_pt_le">find_pt_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#find_bucket_Partition">find_bucket_Partition</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">openx</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#map_nth_in">map_nth_in</a></span> <span class="kwd">with</span> (<span class="id">d2</span>:=0). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#nth_tl">nth_tl</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#tl_length">tl_length</a></span>, <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">openx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">eauto</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_f_increasing">Partition_f_increasing</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">idx</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RealAdd.html#interval_increasing">interval_increasing</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0 &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0)) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0)) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1473')">Proof.</div>
<div class="proofscript" id="proof1473">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#bounded_increasing_dist_le">bounded_increasing_dist_le</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.RealAdd.html#subinterval_increasing">subinterval_increasing</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_lower_bound">Partition_lower_bound</a></span>; <span class="tactic">trivial</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_nth_le">Partition_nth_le</a></span>; <span class="tactic">trivial</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_upper_bound">Partition_upper_bound</a></span>; <span class="tactic">trivial</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Partition_f_decreasing">Partition_f_decreasing</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">idx</span> <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RealAdd.html#interval_decreasing">interval_decreasing</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0 &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0)) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#R_dist">R_dist</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0)) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#idx">idx</a></span>) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) 0)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1474')">Proof.</div>
<div class="proofscript" id="proof1474">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#bounded_decreasing_dist_le">bounded_decreasing_dist_le</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.RealAdd.html#subinterval_decreasing">subinterval_decreasing</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_lower_bound">Partition_lower_bound</a></span>; <span class="tactic">trivial</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_nth_le">Partition_nth_le</a></span>; <span class="tactic">trivial</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_upper_bound">Partition_upper_bound</a></span>; <span class="tactic">trivial</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="find_pt_le_psi">find_pt_le_psi</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">needle</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="CertRL.utils.ListAdd.html#find_bucket">find_bucket</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#needle">needle</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">lower</span>,<span class="id">upper</span>) =&gt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id">lower</span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id">upper</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="list_map_diffs">list_map_diffs</a></span> <span class="id">f</span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">y</span>) =&gt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span>-<span class="id"><a href="CertRL.utils.RiemannAdd.html#y">y</a></span>) (<span class="id"><a href="CertRL.utils.ListAdd.html#adjacent_pairs">adjacent_pairs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="list_map_diffs_length">list_map_diffs_length</a></span> <span class="id">f</span> <span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#list_map_diffs">list_map_diffs</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1475')">Proof.</div>
<div class="proofscript" id="proof1475">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#list_map_diffs">list_map_diffs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, <span class="id"><a href="CertRL.utils.ListAdd.html#adjacent_pairs_length">adjacent_pairs_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="list_map_diff_nth_in">list_map_diff_nth_in</a></span> <span class="id">n</span> <span class="id">f</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">d</span> <span class="id">d1</span> <span class="id">d2</span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#list_map_diffs">list_map_diffs</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#d">d</a></span> = (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#d1">d1</a></span>) - <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth">nth</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#l">l</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#d2">d2</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1476')">Proof.</div>
<div class="proofscript" id="proof1476">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#list_map_diffs">list_map_diffs</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#map_nth_in">map_nth_in</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#adjacent_pairs_nth_in">adjacent_pairs_nth_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> <span class="id">erewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#map_nth_in">map_nth_in</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#adjacent_pairs_length">adjacent_pairs_length</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">d1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">d2</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="part2step_psi">part2step_psi</a></span> (<span class="id">f</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &gt; 0)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#IsStepFun">IsStepFun</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#find_pt_le_psi">find_pt_le_psi</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1477')">Proof.</div>
<div class="proofscript" id="proof1477">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#IsStepFun">IsStepFun</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CertRL.utils.Isomorphism.html#iso_b">iso_b</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#is_subdivision">is_subdivision</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CertRL.utils.Isomorphism.html#iso_b">iso_b</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#list_map_diffs">list_map_diffs</a></span> <span class="id">f</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#adapted_couple">adapted_couple</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#orderedPartition">orderedPartition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>) <span class="kwd">as</span> [? [??]]; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_left">Rmin_left</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_right">Rmax_right</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">R_iso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#list_map_diffs_length">list_map_diffs_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ranalysis1.html#constant_D_eq">constant_D_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#open_interval">open_interval</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">idx</span> <span class="id">idxlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">R_iso</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span> <span class="kwd">in</span> <span class="id">idxlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">idxlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#find_pt_le_psi">find_pt_le_psi</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#find_bucket_Partition">find_bucket_Partition</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">H4</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#list_map_diff_nth_in">list_map_diff_nth_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_length">Partition_length</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H4</span>; <span class="tactic">split</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">eauto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="adjacent_pairs_Partition">adjacent_pairs_Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.ListAdd.html#adjacent_pairs">adjacent_pairs</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) =<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">inc</span> := (<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>)/(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#i">i</a></span>)*<span class="id"><a href="CertRL.utils.RiemannAdd.html#inc">inc</a></span>, <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#i">i</a></span>+1))*<span class="id"><a href="CertRL.utils.RiemannAdd.html#inc">inc</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#seq">seq</a></span> 0 <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1478')">Proof.</div>
<div class="proofscript" id="proof1478">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#adjacent_pairs_map">adjacent_pairs_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#adjacent_pairs_seq">adjacent_pairs_seq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">n</span>+1)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">pred</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a0</span>+1)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">a0</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="RiemannInt_SF_psi">RiemannInt_SF_psi</a></span> (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">npos</span>: (<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &gt; 0)%<span class="id">nat</span>) (<span class="id">aleb</span>: (<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#RiemannInt_SF">RiemannInt_SF</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#mkStepFun">mkStepFun</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#part2step_psi">part2step_psi</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#npos">npos</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#aleb">aleb</a></span>)) = (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span>(<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>)-<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span>(<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>))*(<span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>-<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span>)/(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1479')">Proof.</div>
<div class="proofscript" id="proof1479">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">npos</span> <span class="id">aleb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#RiemannInt_SF">RiemannInt_SF</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">a</span> <span class="id">b</span>); [ | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#subdivision_val">subdivision_val</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#subdivision">subdivision</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Int_SF</span>'<span class="id">_eq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Int_SF</span>'<span class="id">_alt_eq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Int_SF</span>'<span class="id">_alt</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#list_map_diffs">list_map_diffs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#combine_map">combine_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#adjacent_pairs_map">adjacent_pairs_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_id">map_id</a></span> (<span class="id"><a href="CertRL.utils.ListAdd.html#adjacent_pairs">adjacent_pairs</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>))) <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#combine_map">combine_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.ListAdd.html#combine_self">combine_self</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#adjacent_pairs_Partition">adjacent_pairs_Partition</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_map">map_map</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_ext">map_ext</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> (<span class="id">a</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span> * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>)) - <span class="id">f</span> (<span class="id">a</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span> + 1) * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>))) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span> + 1) * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>) - (<span class="id">a</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span> * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>))))<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span> (<span class="id">a</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span> * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>)) - <span class="id">f</span> (<span class="id">a</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span> + 1) * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>))) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>)))).<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RealAdd.html#fold_right_Rplus_mult_const">fold_right_Rplus_mult_const</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.utils.RealAdd.html#telescope_plus_fold_right_sub_seq">telescope_plus_fold_right_sub_seq</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id">f</span>(<span class="id">a</span> + <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span> * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>)))) 0 <span class="id">n</span>) <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span> + 0 * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>)) <span class="kwd">with</span> <span class="id">a</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span> * ((<span class="id">b</span> - <span class="id">a</span>) / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> <span class="id">n</span>)) <span class="kwd">with</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_nzero">INR_nzero</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a0</span> + 1)%<span class="id">nat</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">a0</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#S_INR">S_INR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>; <span class="tactic">trivial</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#INR_nzero">INR_nzero</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_bucket_Partition_exists">find_bucket_Partition_exists</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">needle</span>:<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &gt; 0)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#needle">needle</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">lower</span> <span class="id">upper</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.ListAdd.html#find_bucket">find_bucket</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#needle">needle</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#lower">lower</a></span>, <span class="id"><a href="CertRL.utils.RiemannAdd.html#upper">upper</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1480')">Proof.</div>
<div class="proofscript" id="proof1480">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">npos</span> <span class="id">ineqs</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_unfold_hd_tl">Partition_unfold_hd_tl</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">npos</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#find_bucket_bounded_Rle_exists">find_bucket_bounded_Rle_exists</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="StepBounded">StepBounded</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">npos</span>: (<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> &gt; 0)%<span class="id">nat</span>) (<span class="id">aleb</span>: (<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RealAdd.html#interval_decreasing">interval_decreasing</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">phi</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#mkStepFun">mkStepFun</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#part2step">part2step</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#npos">npos</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#aleb">aleb</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">psi</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#mkStepFun">mkStepFun</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#part2step_psi">part2step_psi</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#npos">npos</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#aleb">aleb</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">t</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#t">t</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#t">t</a></span> - <span class="id"><a href="CertRL.utils.RiemannAdd.html#phi">phi</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#t">t</a></span>) &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#psi">psi</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#t">t</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1481')">Proof.</div>
<div class="proofscript" id="proof1481">
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#find_pt_le">find_pt_le</a></span>, <span class="id"><a href="CertRL.utils.RiemannAdd.html#find_pt_le_psi">find_pt_le_psi</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#find_bucket_Partition_exists">find_bucket_Partition_exists</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> <span class="id">t</span> <span class="id">npos</span> <span class="id">H0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">lower</span> [<span class="id">upper</span> <span class="id">eqq</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqq</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.utils.ListAdd.html#find_bucket_bucket_in">find_bucket_bucket_in</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">t</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>) <span class="id">lower</span> <span class="id">upper</span> 0 0)<br/>
&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">r1</span> <span class="id">r2</span>]; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_StronglySorted_le">Partition_StronglySorted_le</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_hd">Partition_hd</a></span> <span class="kwd">in</span> <span class="id">r1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition_last">Partition_last</a></span> <span class="kwd">in</span> <span class="id">r2</span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.utils.ListAdd.html#find_bucket_needle_in">find_bucket_needle_in</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">t</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#Partition">Partition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span>) <span class="id">lower</span> <span class="id">upper</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">r3</span> <span class="id">r4</span>]; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">cut</span> (<span class="id">f</span> <span class="id">upper</span> &lt;= <span class="id">f</span> <span class="id">t</span>); [<span class="tactic">intros</span>; <span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="natp1gz">natp1gz</a></span> (<span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : (<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>+1 &gt; 0)%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1482')">Proof.</div>
<div class="proofscript" id="proof1482">
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="INR_up_over_cancel">INR_up_over_cancel</a></span> <span class="id">r</span> (<span class="id">epsilon</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#r">r</a></span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#r">r</a></span> / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#INR">INR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#r">r</a></span> / <span class="id"><a href="CertRL.utils.RiemannAdd.html#epsilon">epsilon</a></span>)) + 1)) &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#epsilon">epsilon</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1483')">Proof.</div>
<div class="proofscript" id="proof1483">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">epsilon</span> <span class="kwd">as</span> [<span class="id">epsilon</span> <span class="id">pf</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#INR_IZR_INZ">INR_IZR_INZ</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.add_1_r">Nat.add_1_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Zpos_P_of_succ_nat">Zpos_P_of_succ_nat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">repos</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">r</span> / <span class="id">epsilon</span> &gt; 0).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rdiv_lt_0_compat">Rdiv_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_lt">Rabs_pos_lt</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#archimed">archimed</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">r</span> / <span class="id">epsilon</span>)) <span class="kwd">as</span> [<span class="id">lb</span> <span class="id">ub</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">izrpos</span>: 0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">r</span> / <span class="id">epsilon</span>))).<br/>
&nbsp;&nbsp;{ <span class="id">lra</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2Nat.id">Z2Nat.id</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#succ_IZR">succ_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_gt_compat_r">Rmult_gt_compat_r</a></span> <span class="id">epsilon</span>) <span class="kwd">in</span> <span class="id">lb</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">replace</span> ( <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">r</span> / <span class="id">epsilon</span> * <span class="id">epsilon</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">r</span>) <span class="kwd">in</span> <span class="id">lb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_gt_compat_l">Rmult_gt_compat_l</a></span> (/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">r</span> / <span class="id">epsilon</span>)))) <span class="kwd">in</span> <span class="id">lb</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="kwd">in</span> <span class="id">lb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_l_sym">Rinv_l_sym</a></span> <span class="kwd">in</span> <span class="id">lb</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> <span class="kwd">in</span> <span class="id">lb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="kwd">in</span> <span class="id">lb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">lb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_lt">Rabs_pos_lt</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_Rinv">Rabs_Rinv</a></span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_lt_contravar">Rinv_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#Rinv_pos">Rinv_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_l_sym">Rinv_l_sym</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#le_IZR">le_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="RiemannInt_SF_psi_limit">RiemannInt_SF_psi_limit</a></span> (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;<span class="kwd">forall</span> (<span class="id">aleb</span>: (<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>)) (<span class="id">epsilon</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>),<br/>
&nbsp;&nbsp;&nbsp;{<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> | <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#RiemannInt_SF">RiemannInt_SF</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#mkStepFun">mkStepFun</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#part2step_psi">part2step_psi</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>+1)%<span class="id">nat</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#natp1gz">natp1gz</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#n">n</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#aleb">aleb</a></span>))) &lt; <span class="id"><a href="CertRL.utils.RiemannAdd.html#epsilon">epsilon</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1484')">Proof.</div>
<div class="proofscript" id="proof1484">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">aleb</span> <span class="id">epsilon</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_dec">Rlt_dec</a></span> <span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> (<span class="id">f</span> <span class="id">a</span>) (<span class="id">f</span> <span class="id">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exists</span> (0)%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#RiemannInt_SF_psi">RiemannInt_SF_psi</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">a</span> = <span class="id">f</span> <span class="id">b</span>) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">f</span> <span class="id">b</span> - <span class="id">f</span> <span class="id">b</span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">epsilon</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#up">up</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> ((<span class="id">f</span>(<span class="id">a</span>)-<span class="id">f</span>(<span class="id">b</span>))*(<span class="id">b</span>-<span class="id">a</span>))/<span class="id">epsilon</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#RiemannInt_SF_psi">RiemannInt_SF_psi</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#INR_up_over_cancel">INR_up_over_cancel</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_integral">Rmult_integral</a></span> <span class="kwd">in</span> <span class="id">eqq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="id">exists</span> (0)%<span class="id">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#RiemannInt_SF_psi">RiemannInt_SF_psi</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">a</span> = <span class="id">b</span>) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">b</span>-<span class="id">b</span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">epsilon</span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="RiemannInt_decreasing">RiemannInt_decreasing</a></span> (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RealAdd.html#interval_decreasing">interval_decreasing</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt.html#Riemann_integrable">Riemann_integrable</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1485')">Proof.</div>
<div class="proofscript" id="proof1485">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">aleb</span> <span class="id">fdecr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span> <span class="id">epsilon</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#RiemannInt_SF_psi_limit">RiemannInt_SF_psi_limit</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> <span class="id">aleb</span> <span class="id">epsilon</span>)<br/>
&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">n</span> <span class="id">npf</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#mkStepFun">mkStepFun</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#part2step">part2step</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">n</span>+1) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#natp1gz">natp1gz</a></span> <span class="id">n</span>) <span class="id">aleb</span>)).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt_SF.html#mkStepFun">mkStepFun</a></span> (<span class="id"><a href="CertRL.utils.RiemannAdd.html#part2step_psi">part2step_psi</a></span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">n</span>+1) (<span class="id"><a href="CertRL.utils.RiemannAdd.html#natp1gz">natp1gz</a></span> <span class="id">n</span>) <span class="id">aleb</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_left">Rmin_left</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_right">Rmax_right</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#StepBounded">StepBounded</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">npf</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="RiemannInt_increasing">RiemannInt_increasing</a></span> (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> <span class="id">b</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.RealAdd.html#interval_increasing">interval_increasing</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt.html#Riemann_integrable">Riemann_integrable</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#f">f</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#a">a</a></span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1486')">Proof.</div>
<div class="proofscript" id="proof1486">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt.html#Riemann_integrable">Riemann_integrable</a></span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; - (<span class="kwd">fun</span> <span class="id">x</span> =&gt; -<span class="id">f</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#x">x</a></span>) <span class="id"><a href="CertRL.utils.RiemannAdd.html#y">y</a></span>) <span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt.html#Riemann_integrable_ext">Riemann_integrable_ext</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RiemannInt.html#Riemann_integrable_Ropp">Riemann_integrable_Ropp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RiemannAdd.html#RiemannInt_decreasing">RiemannInt_decreasing</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.RealAdd.html#increasing_decreasing_opp">increasing_decreasing_opp</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
