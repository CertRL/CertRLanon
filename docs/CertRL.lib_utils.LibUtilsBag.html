
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CertRL.lib_utils.LibUtilsBag</title>
<meta name="description" content="Documentation of Coq module CertRL.lib_utils.LibUtilsBag" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CertRL.lib_utils.LibUtilsBag</h1>
<div class="coq">
<br/>
<div class="doc">This module provides support for bags (or multisets). </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Arith.html">Arith</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html">Min</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html">Max</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith.html">ZArith</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.omega.Omega.html">Omega</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html">Permutation</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html">Equivalence</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html">LibUtilsCoqLibAdd</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html">LibUtilsListAdd</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsSublist.html">LibUtilsSublist</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html">LibUtilsAssoc</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Bag">Bag</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span>:<span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">eqdec</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#EqDec">EqDec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="rbag">rbag</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bunion">bunion</a></span> := (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#app">app</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Delimit</span> <span class="kwd">Scope</span> <span class="id">rbag_scope</span> <span class="kwd">with</span> <span class="id">rbag</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Bind</span> <span class="kwd">Scope</span> <span class="id">rbag_scope</span> <span class="kwd">with</span> <span class="id">rbag</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">rbag_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">X</span> ≅ <span class="id">Y</span>" := (<span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> <span class="id">X</span> <span class="id">Y</span>) (<span class="tactic">at</span> <span class="id">level</span> 70) : <span class="id">rbag_scope</span>.                              <br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">b1</span> ⊎ <span class="id">b2</span>" := (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span> <span class="id">b1</span> <span class="id">b2</span>) (<span class="id">right</span> <span class="id">associativity</span>, <span class="tactic">at</span> <span class="id">level</span> 70) : <span class="id">rbag_scope</span>.    <br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="bunion_proper">bunion_proper</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof141')">Proof.</div>
<div class="proofscript" id="proof141">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app">Permutation_app</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bunion_nil_r">bunion_nil_r</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> ⊎ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof142')">Proof.</div>
<div class="proofscript" id="proof142">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bunion_nil_l">bunion_nil_l</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof143')">Proof.</div>
<div class="proofscript" id="proof143">
 <span class="tactic">reflexivity</span>. Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bunion_assoc">bunion_assoc</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span> <span class="id">l3</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>) ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l3">l3</a></span>) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊎ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l3">l3</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof144')">Proof.</div>
<div class="proofscript" id="proof144">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bunion_comm">bunion_comm</a></span> (<span class="id">l1</span> <span class="id">l2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>) ≅ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof145')">Proof.</div>
<div class="proofscript" id="proof145">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bunion_Forall">bunion_Forall</a></span> <span class="id">P</span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof146')">Proof.</div>
<div class="proofscript" id="proof146">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#Forall_app">Forall_app</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="remove_one">remove_one</a></span> (<span class="id">x</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">y</span>::<span class="id">tl</span> =&gt; <span class="kwd">if</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> == <span class="id">y</span>) <span class="kwd">then</span> <span class="id">tl</span> <span class="kwd">else</span> <span class="id">y</span>::(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id">tl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> : <span class="id">bag</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">tac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="tactic">repeat</span> <span class="tactic">progress</span> (<span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="id">autorewrite</span> <span class="kwd">with</span> <span class="id">bag</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: ?<span class="id">a</span> = ?<span class="id">a</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">clear</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: ?<span class="id">a</span> = ?<span class="id">a</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> |- <span class="id">_</span> ] =&gt; <span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: ?<span class="id">a</span> &lt;&gt; ?<span class="id">a</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: {<span class="id">_</span> | <span class="id">_</span> } |- <span class="id">_</span> ] =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: ?<span class="id">a</span> ≅ ?<span class="id">b</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> *<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">context</span> [@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> ?<span class="id">A</span> ?<span class="id">eqA</span> ?<span class="id">eqvA</span> ?<span class="id">eqdecA</span> ?<span class="id">x</span> ?<span class="id">x</span> ] |- <span class="id">_</span>] =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">HH</span>:=(<span class="tactic">fresh</span> "<span class="id">eqH</span>") <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">A</span> <span class="id">eqA</span> <span class="id">eqvA</span> <span class="id">eqdecA</span> <span class="id">x</span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">eqH</span>|<span class="id">eqH</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">elim</span> <span class="id">eqH</span>; <span class="tactic">reflexivity</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">context</span> [@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> ?<span class="id">A</span> ?<span class="id">eqA</span> ?<span class="id">eqvA</span> ?<span class="id">eqdecA</span> ?<span class="id">x</span> ?<span class="id">x</span> ]] =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">HH</span>:=(<span class="tactic">fresh</span> "<span class="id">eqH</span>") <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">A</span> <span class="id">eqA</span> <span class="id">eqvA</span> <span class="id">eqdecA</span> <span class="id">x</span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">eqH</span>|<span class="id">eqH</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">elim</span> <span class="id">eqH</span>; <span class="tactic">reflexivity</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- ?<span class="id">x</span> :: ?<span class="id">l</span> ≅ ?<span class="id">x</span> :: ?<span class="id">l</span>' ] =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#perm_skip">perm_skip</a></span>; <span class="id">fold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- ?<span class="id">x</span> :: ?<span class="id">y</span> :: ?<span class="id">l</span> ≅ ?<span class="id">y</span> :: ?<span class="id">x</span> :: ?<span class="id">l</span>' ] =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#perm_swap">perm_swap</a></span>; <span class="id">fold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: ?<span class="id">a</span> + {?<span class="id">b</span>} |- <span class="id">_</span> ] =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: {?<span class="id">a</span>} + {?<span class="id">b</span>} |- <span class="id">_</span> ] =&gt; <span class="tactic">destruct</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">context</span> [@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> ?<span class="id">A</span> ?<span class="id">eqA</span> ?<span class="id">eqvA</span> ?<span class="id">eqdecA</span> ?<span class="id">x</span> ?<span class="id">y</span> ] |- <span class="id">_</span>] =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">A</span> <span class="id">eqA</span> <span class="id">eqvA</span> <span class="id">eqdecA</span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">context</span> [@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> ?<span class="id">A</span> ?<span class="id">eqA</span> ?<span class="id">eqvA</span> ?<span class="id">eqdecA</span> ?<span class="id">x</span> ?<span class="id">y</span> ]] =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">A</span> <span class="id">eqA</span> <span class="id">eqvA</span> <span class="id">eqdecA</span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#complement">complement</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">Equivalence.equiv</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">subst</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">bag</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="remove_one_proper">remove_one_proper</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof147')">Proof.</div>
<div class="proofscript" id="proof147">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Bag minus
   * Remove elements of d from x.
   * Note the order of arguments: (bminus d x) is "x ⊖ d" </div>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="bminus">bminus</a></span> (<span class="id">d</span> <span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) {<span class="kwd">struct</span> <span class="id">d</span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">d1</span> :: <span class="id">d</span>' =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus">bminus</a></span> <span class="id">d</span>' (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id">d1</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">b1</span> ⊖ <span class="id">b2</span>" := (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus">bminus</a></span> <span class="id">b2</span> <span class="id">b1</span>) (<span class="id">right</span> <span class="id">associativity</span>, <span class="tactic">at</span> <span class="id">level</span> 70) : <span class="id">rbag_scope</span>.    <br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_over_app_delta">bminus_over_app_delta</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">d1</span> <span class="id">d2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d1">d1</a></span>) ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d2">d2</a></span>) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> ⊖ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d1">d1</a></span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d2">d2</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof148')">Proof.</div>
<div class="proofscript" id="proof148">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">d1</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_to_nil">bminus_to_nil</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">d</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof149')">Proof.</div>
<div class="proofscript" id="proof149">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">d</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_nil_to_self">bminus_nil_to_self</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> ⊖ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof150')">Proof.</div>
<div class="proofscript" id="proof150">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="bminus_proper_lem">bminus_proper_lem</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus">bminus</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof151')">Proof.</div>
<div class="proofscript" id="proof151">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">y</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHy</span>; <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="remove_one_comm">remove_one_comm</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x1</span> <span class="id">x2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x1">x1</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x2">x2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>)) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x2">x2</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x1">x1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof152')">Proof.</div>
<div class="proofscript" id="proof152">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="remove_one_not_first">remove_one_not_first</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x1</span> <span class="id">x2</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> <span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x1">x1</a></span> &lt;&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x2">x2</a></span> -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x1">x1</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x2">x2</a></span> :: <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>)) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x2">x2</a></span> :: (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x1">x1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof153')">Proof.</div>
<div class="proofscript" id="proof153">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x1</span> <span class="id">x2</span>); <span class="tactic">intros</span>; [<span class="id">contradiction</span>|<span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="bminus_proper">bminus_proper</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus">bminus</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof154')">Proof.</div>
<div class="proofscript" id="proof154">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one_comm">remove_one_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_self">bminus_self</a></span> : <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof155')">Proof.</div>
<div class="proofscript" id="proof155">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">induction</span> <span class="id">x</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_naught">bminus_naught</a></span> : <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> ⊖ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof156')">Proof.</div>
<div class="proofscript" id="proof156">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_nil_to_self">bminus_nil_to_self</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_to_nil">bminus_to_nil</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_self">bminus_self</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_naught">bminus_naught</a></span> : <span class="id">bag</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_cons">bminus_cons</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> :: <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) ⊖ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> :: <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span>)) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof157')">Proof.</div>
<div class="proofscript" id="proof157">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tac</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_cons">bminus_cons</a></span> : <span class="id">bag</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> : <span class="id">bag</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bunion_bminus">bunion_bminus</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof158')">Proof.</div>
<div class="proofscript" id="proof158">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span> <span class="kwd">in</span> *; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">y</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="remove_one_consed">remove_one_consed</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> :: <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>)) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof159')">Proof.</div>
<div class="proofscript" id="proof159">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tac</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="remove_one_In">remove_one_In</a></span> (<span class="id">a</span> <span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus">bminus</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>)) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus">bminus</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof160')">Proof.</div>
<div class="proofscript" id="proof160">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l2</span> <span class="id">a</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">l2</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">apply</span> (<span class="id">IHl2</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">IHl1</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id">a</span> <span class="id">l2</span>) <span class="id">a0</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one_comm">remove_one_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="remove_one_sublist">remove_one_sublist</a></span> <span class="id">l</span> <span class="id">a</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsSublist.html#sublist">sublist</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof161')">Proof.</div>
<div class="proofscript" id="proof161">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_sublist">bminus_sublist</a></span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsSublist.html#sublist">sublist</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus">bminus</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof162')">Proof.</div>
<div class="proofscript" id="proof162">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHl1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one_sublist">remove_one_sublist</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_Forall">bminus_Forall</a></span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus">bminus</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof163')">Proof.</div>
<div class="proofscript" id="proof163">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_sublist">bminus_sublist</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_NoDup">bminus_NoDup</a></span>  (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus">bminus</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof164')">Proof.</div>
<div class="proofscript" id="proof164">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_sublist">bminus_sublist</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_bminus">bunion_bminus</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one_consed">remove_one_consed</a></span> : <span class="id">bag</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pick_an_a">pick_an_a</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;({<span class="id">l</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> | <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>::<span class="id">l</span>' ≅ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>}) + {<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> ≅ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof165')">Proof.</div>
<div class="proofscript" id="proof165">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">exists</span> (<span class="id">a0</span>::<span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#perm_swap">perm_swap</a></span>, <span class="id">l0</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">bag</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="filter_proper">filter_proper</a></span> : <span class="kwd">forall</span> (<span class="id">p</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof166')">Proof.</div>
<div class="proofscript" id="proof166">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="id">tac</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|- <span class="id">context</span> [<span class="kwd">if</span> ?<span class="id">a</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span> ] ] =&gt; <span class="id">case_eq</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Bag.MBag">MBag</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="mult">mult</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">b</span> :: <span class="id">l</span>' =&gt; <span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id">b</span>) <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l</span>' <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>) <span class="kwd">else</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l</span>' <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mult_equiv">mult_equiv</a></span> <span class="id">l</span> <span class="id">l</span>' := (<span class="kwd">forall</span> <span class="id">a</span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l</span>' <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">X</span> ≅# <span class="id">Y</span>" := (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_equiv">mult_equiv</a></span> <span class="id">X</span> <span class="id">Y</span>) (<span class="tactic">at</span> <span class="id">level</span> 70) : <span class="id">rbag_scope</span>.                              <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_equiv">mult_equiv</a></span> : <span class="id">bag</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="mult_proper">mult_proper</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> ==&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof167')">Proof.</div>
<div class="proofscript" id="proof167">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">y0</span> <span class="id">x1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">y0</span> <span class="id">y1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">y1</span> <span class="id">x1</span>); <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">y0</span> <span class="id">x1</span>); <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bags_equal_same_mult1">bags_equal_same_mult1</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ≅ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ≅# <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof168')">Proof.</div>
<div class="proofscript" id="proof168">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_equiv">mult_equiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">H</span>; <span class="id">tac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="groupby">groupby</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">a</span>::<span class="id">ls</span>) =&gt; <span class="kwd">let</span> <span class="id">rest</span> := <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">ls</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#rest">rest</a></span> <span class="id">a</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; (<span class="id">a</span>,1)::<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#rest">rest</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#update_first">update_first</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#rest">rest</a></span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="groupby_noDup">groupby_noDup</a></span> <span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof169')">Proof.</div>
<div class="proofscript" id="proof169">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; [<span class="id">constructor</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a</span>); [<span class="tactic">intros</span> ? ?| <span class="tactic">intros</span> <span class="id">neq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_update_first">domain_update_first</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_none_nin">lookup_none_nin</a></span> <span class="kwd">in</span> <span class="id">neq</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="rep">rep</a></span> (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) <span class="id">n</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>::(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#rep">rep</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="smush">smush</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ((<span class="id">d</span>,<span class="id">n</span>)::<span class="id">ls</span>) =&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#rep">rep</a></span> <span class="id">d</span> <span class="id">n</span> ++ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush">smush</a></span> <span class="id">ls</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="smush_perm_proper">smush_perm_proper</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> ((@<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)) ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush">smush</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof170')">Proof.</div>
<div class="proofscript" id="proof170">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_ind_bis">Permutation_ind_bis</a></span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">x</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_tail">Permutation_app_tail</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_app_comm">Permutation_app_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">transitivity</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush">smush</a></span> <span class="id">l</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="smush1">smush1</a></span> <span class="id">a</span> <span class="id">n</span> <span class="id">x</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush">smush</a></span> ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>,<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span>)::<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>::(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush">smush</a></span> ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>,<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span>)::<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof171')">Proof.</div>
<div class="proofscript" id="proof171">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="smush_groupby">smush_groupby</a></span> <span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush">smush</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof172')">Proof.</div>
<div class="proofscript" id="proof172">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">groupby_noDup</span> : <span class="id">bag</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a</span>); [<span class="tactic">intros</span> <span class="id">n</span> <span class="id">eqn</span> | <span class="tactic">intros</span> <span class="id">neq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_to_front">lookup_to_front</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">eqn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">perm1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#update_first">update_first</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#update_first">update_first</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> ((<span class="id">a</span>, <span class="id">n</span>) :: <span class="id">x</span>) <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#update_first_NoDup_perm_proper">update_first_NoDup_perm_proper</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">bag</span>). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">perm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush1">smush1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#perm_skip">perm_skip</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>, <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#perm_skip">perm_skip</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="pick_an_a_or_absent">pick_an_a_or_absent</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> = 0) \/ (<span class="id">exists</span> <span class="id">l</span>':<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>::<span class="id">l</span>' ≅ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof173')">Proof.</div>
<div class="proofscript" id="proof173">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a1</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a0</span> <span class="id">a0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">IHl</span> <span class="id">a0</span>); <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">l</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">l</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id">IHl</span> <span class="id">a0</span>); <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">l</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a1</span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">IHl</span> <span class="id">a0</span>); <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">a</span>::<span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#perm_swap">perm_swap</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="lookup_none_mult0">lookup_none_mult0</a></span> <span class="id">l</span> <span class="id">d</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof174')">Proof.</div>
<div class="proofscript" id="proof174">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a</span>); <span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">d</span> <span class="id">a</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_none_nin">lookup_none_nin</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">elim</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_update_first">domain_update_first</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_dom">in_dom</a></span>; <span class="tactic">eapply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_none_nin">lookup_none_nin</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_update_first">domain_update_first</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">d</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_dom">in_dom</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">d</span> <span class="id">a</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="lookup_update_eq">lookup_update_eq</a></span> {<span class="id">B</span>:<span class="kwd">Type</span> }{<span class="id">l</span> <span class="id">a</span>} {<span class="id">n</span> <span class="id">n</span>':<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#B">B</a></span>} : <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#update_first">update_first</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id">n</span>') <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span> = <span class="id">n</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof175')">Proof.</div>
<div class="proofscript" id="proof175">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span> <span class="id">n</span> <span class="id">n</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span>*; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="domain_groupby">domain_groupby</a></span> {<span class="id">l</span> <span class="id">a</span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>)) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof176')">Proof.</div>
<div class="proofscript" id="proof176">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a</span>); <span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_update_first">domain_update_first</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">right</span>; <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intuition</span>. <span class="id">right</span>; <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_update_first">domain_update_first</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_dom">in_dom</a></span>; <span class="tactic">eapply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_update_first">domain_update_first</a></span>. <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="tactic">eapply</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="groupby_mult_in">groupby_mult_in</a></span> {<span class="id">l</span> <span class="id">d</span> <span class="id">n</span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span>) (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof177')">Proof.</div>
<div class="proofscript" id="proof177">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a</span>); <span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_lookup_nodup">in_lookup_nodup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span>) <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_update_first">domain_update_first</a></span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_noDup">groupby_noDup</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">d</span> <span class="id">a</span>); <span class="tactic">trivial</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> * ; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#lookup_update_eq">lookup_update_eq</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> (<span class="id">IHl</span> <span class="id">n0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_update_neq">lookup_update_neq</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">eapply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>. <span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">d</span> <span class="id">d</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#lookup_none_mult0">lookup_none_mult0</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> (<span class="id">IHl</span> <span class="id">_</span> <span class="id">H</span>). <span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">d</span> <span class="id">a</span>); <span class="tactic">trivial</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_none_nin">lookup_none_nin</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_dom">in_dom</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="groupby_mult_in_pos">groupby_mult_in_pos</a></span> {<span class="id">l</span> <span class="id">d</span> <span class="id">n</span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span>) (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span> &lt;&gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof178')">Proof.</div>
<div class="proofscript" id="proof178">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a</span>); <span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_lookup_nodup">in_lookup_nodup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span>) <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain_update_first">domain_update_first</a></span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_noDup">groupby_noDup</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">d</span> <span class="id">a</span>); <span class="tactic">trivial</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#lookup_update_eq">lookup_update_eq</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_update_neq">lookup_update_neq</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> (<span class="id">IHl</span> 0); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mult_in_groupby">mult_in_groupby</a></span> {<span class="id">l</span> <span class="id">d</span> <span class="id">n</span>} : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span>) (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof179')">Proof.</div>
<div class="proofscript" id="proof179">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">d</span> <span class="id">n</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id">l</span>) <span class="id">a</span>); <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">d</span> <span class="id">a</span>); <span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">mn0</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l</span> <span class="id">a</span> = <span class="id">n0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_mult_in">groupby_mult_in</a></span>. <span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">mn0</span>. <span class="tactic">subst</span> <span class="id">n0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_update_eq_in">lookup_update_eq_in</a></span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_dom">in_dom</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_in">lookup_in</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span>). <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_update_neq">lookup_update_neq</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_lookup_nodup">in_lookup_nodup</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_noDup">groupby_noDup</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#lookup_none_nin">lookup_none_nin</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>. <span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_dom">in_dom</a></span> <span class="kwd">in</span> <span class="id">IHl</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mult_nin_groupby">mult_nin_groupby</a></span> {<span class="id">l</span> <span class="id">d</span>} : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span> = 0 -&gt; ~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#d">d</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#domain">domain</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby">groupby</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof180')">Proof.</div>
<div class="proofscript" id="proof180">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">mu</span> <span class="id">ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#in_domain_in">in_domain_in</a></span> <span class="id">ind</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_mult_in">groupby_mult_in</a></span> <span class="id">H</span>) <span class="kwd">in</span> <span class="id">mu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_mult_in_pos">groupby_mult_in_pos</a></span> <span class="id">H</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bags_same_mult_has_equal">bags_same_mult_has_equal</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>)) -&gt;  (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ≅ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof181')">Proof.</div>
<div class="proofscript" id="proof181">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush_groupby">smush_groupby</a></span> <span class="id">l1</span>), &lt;- (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush_groupby">smush_groupby</a></span> <span class="id">l2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#smush_perm_proper">smush_perm_proper</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#NoDup_Permutation">NoDup_Permutation</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#NoDup_domain_NoDup">NoDup_domain_NoDup</a></span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_noDup">groupby_noDup</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsAssoc.html#NoDup_domain_NoDup">NoDup_domain_NoDup</a></span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_noDup">groupby_noDup</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">x</span>. <span class="tactic">destruct</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">HH</span>; <span class="tactic">elim</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_mult_in_pos">groupby_mult_in_pos</a></span> <span class="id">HH</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">HH</span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#groupby_mult_in">groupby_mult_in</a></span> <span class="kwd">in</span> <span class="id">HH</span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_in_groupby">mult_in_groupby</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">congruence</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.MBag">MBag</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bmin">bmin</a></span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊖ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">b1</span> <span class="id">min</span>-<span class="id">b</span> <span class="id">b2</span>" := (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin">bmin</a></span> <span class="id">b1</span> <span class="id">b2</span>) (<span class="id">right</span> <span class="id">associativity</span>, <span class="tactic">at</span> <span class="id">level</span> 70) : <span class="id">rbag_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bmax">bmax</a></span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊎ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span>).<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "<span class="id">b1</span> <span class="id">max</span>-<span class="id">b</span> <span class="id">b2</span>" := (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmax">bmax</a></span> <span class="id">b1</span> <span class="id">b2</span>) (<span class="id">right</span> <span class="id">associativity</span>, <span class="tactic">at</span> <span class="id">level</span> 70) : <span class="id">rbag_scope</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bcount">bcount</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="bdistinct">bdistinct</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">x</span> :: <span class="id">l</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">dl</span>' := <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">dl</span>' <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id">x</span> :: <span class="id">dl</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">dl</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_sublist">bdistinct_sublist</a></span> <span class="id">l</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsSublist.html#sublist">sublist</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof182')">Proof.</div>
<div class="proofscript" id="proof182">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsSublist.html#sublist_cons">sublist_cons</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsSublist.html#sublist_skip">sublist_skip</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_Forall">bdistinct_Forall</a></span> {<span class="id">P</span>} {<span class="id">l</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof183')">Proof.</div>
<div class="proofscript" id="proof183">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsSublist.html#Forall_sublist">Forall_sublist</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_sublist">bdistinct_sublist</a></span> <span class="id">l</span>)) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_at_most_one">bdistinct_at_most_one</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 0 \/ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof184')">Proof.</div>
<div class="proofscript" id="proof184">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">IHl</span> <span class="id">x</span>); <span class="tactic">generalize</span> (<span class="id">IHl</span> <span class="id">a</span>); <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H0</span>; <span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">simpl</span>; <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intro</span> <span class="id">aH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">aH</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">aH</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="bdistinct_proper">bdistinct_proper</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> ==&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof185')">Proof.</div>
<div class="proofscript" id="proof185">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#Proper">Proper</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html#respectful">respectful</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_equal_same_mult1">bags_equal_same_mult1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_same_mult_has_equal">bags_same_mult_has_equal</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>) <span class="id">x0</span>) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>') <span class="id">x0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_at_most_one">bdistinct_at_most_one</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H4</span> <span class="id">l</span>' <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H4</span>; <span class="tactic">rewrite</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_same_mult_has_equal">bags_same_mult_has_equal</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>) <span class="id">x0</span>) = 0) \/ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>) <span class="id">x0</span>) = 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_at_most_one">bdistinct_at_most_one</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>) <span class="id">y0</span>) = 0) \/ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>) <span class="id">y0</span>) = 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_at_most_one">bdistinct_at_most_one</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H1</span>; <span class="tactic">elim</span> <span class="id">H2</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H2</span>; <span class="tactic">rewrite</span> <span class="id">H3</span>; <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">y0</span> <span class="id">x0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">x0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x0</span> <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x0</span> <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x0</span> <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x0</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">y0</span> <span class="id">x0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x0</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x0</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">y0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#perm_trans">perm_trans</a></span> <span class="kwd">with</span> (<span class="id">l</span>' := <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>'); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_exactly_zero">bdistinct_exactly_zero</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 0 -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof186')">Proof.</div>
<div class="proofscript" id="proof186">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>) <span class="id">a</span>) = 0) \/ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>) <span class="id">a</span>) = 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_at_most_one">bdistinct_at_most_one</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_exactly_zero_back">bdistinct_exactly_zero_back</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 0 -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof187')">Proof.</div>
<div class="proofscript" id="proof187">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#pick_an_a_or_absent">pick_an_a_or_absent</a></span> <span class="id">l</span> <span class="id">x</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id">x</span> :: <span class="id">x0</span>)) <span class="id">x</span>) = 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_equal_same_mult1">bags_equal_same_mult1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">x0</span>) <span class="id">x</span>) = 0) \/ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">x0</span>) <span class="id">x</span>) = 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_at_most_one">bdistinct_at_most_one</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H4</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">x</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_exactly_one">bdistinct_exactly_one</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) &lt;&gt; 0 -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof188')">Proof.</div>
<div class="proofscript" id="proof188">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_at_most_one">bdistinct_at_most_one</a></span> <span class="id">l</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_exactly_zero_back">bdistinct_exactly_zero_back</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_exactly_one_back">bdistinct_exactly_one_back</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 1 -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) &lt;&gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof189')">Proof.</div>
<div class="proofscript" id="proof189">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>) <span class="id">a</span>) = 0) \/ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>) <span class="id">a</span>) = 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_at_most_one">bdistinct_at_most_one</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_exactly_one_back_diff">bdistinct_exactly_one_back_diff</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 1 -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) &gt;= 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof190')">Proof.</div>
<div class="proofscript" id="proof190">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l</span> <span class="id">x</span>) &lt;&gt; 0). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_exactly_one_back">bdistinct_exactly_one_back</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="exist_or_zero">exist_or_zero</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> (<span class="id">rs</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>::<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#rs">rs</a></span>) ≅ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) \/ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof191')">Proof.</div>
<div class="proofscript" id="proof191">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">elim</span> (<span class="id">IHs</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *; <span class="id">exists</span> <span class="id">s</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">IHs</span> <span class="id">x</span>); <span class="tactic">intro</span>; <span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">a</span>::<span class="id">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#perm_swap">perm_swap</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_mult">bdistinct_mult</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min">min</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof192')">Proof.</div>
<div class="proofscript" id="proof192">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">IHl</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#exist_or_zero">exist_or_zero</a></span> <span class="id">l</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min">min</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l</span> <span class="id">a</span>) 1 = 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">x0</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#succ_min_distr">succ_min_distr</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_0_l">min_0_l</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_against_one">min_against_one</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l</span> <span class="id">a</span>)); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mult_pos_equiv_in">mult_pos_equiv_in</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> &gt; 0 &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof193')">Proof.</div>
<div class="proofscript" id="proof193">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Case&nbsp;"-&gt;"&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hx</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">Hx</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Case&nbsp;"&lt;-"&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">x</span>); <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Gt.html#gt_Sn_O">gt_Sn_O</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Gt.html#gt_Sn_O">gt_Sn_O</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_same_elemts">bdistinct_same_elemts</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof194')">Proof.</div>
<div class="proofscript" id="proof194">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">l</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_pos_equiv_in">mult_pos_equiv_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_pos_equiv_in">mult_pos_equiv_in</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_mult">bdistinct_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_case">min_case</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_nil">bdistinct_nil</a></span> {<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof195')">Proof.</div>
<div class="proofscript" id="proof195">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_NoDup">bdistinct_NoDup</a></span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof196')">Proof.</div>
<div class="proofscript" id="proof196">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; [<span class="id">constructor</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_pos_equiv_in">mult_pos_equiv_in</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NoDup_bdistinct">NoDup_bdistinct</a></span> {<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof197')">Proof.</div>
<div class="proofscript" id="proof197">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span> <span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_pos_equiv_in">mult_pos_equiv_in</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_idem">bdistinct_idem</a></span> {<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof198')">Proof.</div>
<div class="proofscript" id="proof198">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#NoDup_bdistinct">NoDup_bdistinct</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_NoDup">bdistinct_NoDup</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_equivlist">bdistinct_equivlist</a></span>  (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#equivlist">equivlist</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof199')">Proof.</div>
<div class="proofscript" id="proof199">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#equivlist_incls">equivlist_incls</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> ? <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_same_elemts">bdistinct_same_elemts</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_sublist">bdistinct_sublist</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_bdistinct">fold_right_bdistinct</a></span> (<span class="id">f</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">assoc</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#z">z</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#z">z</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">comm</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">idem</span>:<span class="kwd">forall</span> <span class="id">x</span>  : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">unit</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#unit">unit</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#unit">unit</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof200')">Proof.</div>
<div class="proofscript" id="proof200">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">inn</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">a</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_pos_equiv_in">mult_pos_equiv_in</a></span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_split">in_split</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">inn</span>) <span class="kwd">as</span> [<span class="id">t1</span> [<span class="id">t2</span> <span class="id">teq</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">teq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">perm</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation">Permutation</a></span> (<span class="id">t1</span> ++ <span class="id">a</span> :: <span class="id">t2</span>) (<span class="id">a</span>::<span class="id">t1</span>++ <span class="id">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Permutation.html#Permutation_middle">Permutation_middle</a></span>; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#fold_right_perm">fold_right_perm</a></span> <span class="id">_</span> <span class="id">assoc</span> <span class="id">comm</span> (<span class="id">t1</span> ++ <span class="id">a</span> :: <span class="id">t2</span>) (<span class="id">a</span> :: <span class="id">t1</span> ++ <span class="id">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">assoc</span>, <span class="id">idem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="fold_right_equivlist">fold_right_equivlist</a></span> (<span class="id">f</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">assoc</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#z">z</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#z">z</a></span>) <br/>
&nbsp;&nbsp;(<span class="id">comm</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) <br/>
&nbsp;&nbsp;(<span class="id">idem</span>:<span class="kwd">forall</span> <span class="id">x</span>  : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>, <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">unit</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#equivlist">equivlist</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#unit">unit</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#f">f</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#unit">unit</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof201')">Proof.</div>
<div class="proofscript" id="proof201">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#fold_right_bdistinct">fold_right_bdistinct</a></span> <span class="id">_</span> <span class="id">assoc</span> <span class="id">comm</span> <span class="id">idem</span> <span class="id">l1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#fold_right_bdistinct">fold_right_bdistinct</a></span> <span class="id">_</span> <span class="id">assoc</span> <span class="id">comm</span> <span class="id">idem</span> <span class="id">l2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#fold_right_perm">fold_right_perm</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">NoDup_Permutation</span>'; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_NoDup">bdistinct_NoDup</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_NoDup">bdistinct_NoDup</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_equivlist">bdistinct_equivlist</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bunion_mult">bunion_mult</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) + (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof202')">Proof.</div>
<div class="proofscript" id="proof202">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_l">app_nil_l</a></span>; <span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">IHs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="remove_one_mult">remove_one_mult</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof203')">Proof.</div>
<div class="proofscript" id="proof203">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mult_on_remove">mult_on_remove</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">a</span> <span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> &lt;&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof204')">Proof.</div>
<div class="proofscript" id="proof204">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">induction</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intro</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">a1</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a0</span>); <span class="tactic">intro</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a1</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a1</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a</span>); <span class="tactic">intro</span>; [<span class="tactic">reflexivity</span>|<span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a0</span>); <span class="tactic">intro</span>; <span class="tactic">auto</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_mult">bminus_mult</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) - (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof205')">Proof.</div>
<div class="proofscript" id="proof205">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">revert</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html#minus_n_O">minus_n_O</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one_mult">remove_one_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#exist_or_zero">exist_or_zero</a></span> <span class="id">s</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H</span> <span class="kwd">in</span> *; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_on_remove">mult_on_remove</a></span> <span class="id">s</span> <span class="id">a</span> <span class="id">x</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.RelationClasses.html#complement">complement</a></span>,<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">equiv</a></span> <span class="kwd">in</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmin_on_nil_r">bmin_on_nil_r</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof206')">Proof.</div>
<div class="proofscript" id="proof206">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin">bmin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_naught">bminus_naught</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_self">bminus_self</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmin_on_nil_l">bmin_on_nil_l</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof207')">Proof.</div>
<div class="proofscript" id="proof207">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin">bmin</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_to_nil">bminus_to_nil</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmax_on_nil_r">bmax_on_nil_r</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id">max</span>-<span class="id">b</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof208')">Proof.</div>
<div class="proofscript" id="proof208">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmax">bmax</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_naught">bminus_naught</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a</span>); <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_to_nil">bminus_to_nil</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_nil_r">bunion_nil_r</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmax_on_nil_l">bmax_on_nil_l</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">max</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof209')">Proof.</div>
<div class="proofscript" id="proof209">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmax">bmax</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmin_Forall">bmin_Forall</a></span> <span class="id">P</span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin">bmin</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof210')">Proof.</div>
<div class="proofscript" id="proof210">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin">bmin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_Forall">bminus_Forall</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmax_Forall">bmax_Forall</a></span> <span class="id">P</span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#P">P</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmax">bmax</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof211')">Proof.</div>
<div class="proofscript" id="proof211">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmax">bmax</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_Forall">bunion_Forall</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_Forall">bminus_Forall</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="minus_min">minus_min</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span> <span class="id">n0</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n0">n0</a></span> - (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n0">n0</a></span> - <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min">min</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n0">n0</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof212')">Proof.</div>
<div class="proofscript" id="proof212">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_0_r">min_0_r</a></span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html#minus_n_O">minus_n_O</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html#minus_diag">minus_diag</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Peano_dec.html#eq_nat_dec">eq_nat_dec</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H</span> <span class="id">n</span> <span class="id">n0</span>); <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n0</span> &lt;= (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n0</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_l">min_l</a></span> <span class="id">n0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n0</span>) <span class="id">H</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#compare_either">compare_either</a></span> <span class="id">n0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_l">min_l</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_r">min_r</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="minus_max">minus_max</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span> <span class="id">n0</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n0">n0</a></span> + (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span> - <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n0">n0</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#max">max</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n0">n0</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof213')">Proof.</div>
<div class="proofscript" id="proof213">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#max_0_r">max_0_r</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Peano_dec.html#eq_nat_dec">eq_nat_dec</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H</span> <span class="id">n</span> <span class="id">n0</span>); <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n0</span> &lt;= (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n0</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#max_r">max_r</a></span> <span class="id">n0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n0</span>) <span class="id">H</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#compare_either">compare_either</a></span> <span class="id">n0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#max_r">max_r</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#max_l">max_l</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmin_mult">bmin_mult</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min">min</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof214')">Proof.</div>
<div class="proofscript" id="proof214">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin">bmin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_mult">bminus_mult</a></span>; <span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">IHs</span>; <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">s</span> <span class="id">a</span>); <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">t</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#minus_min">minus_min</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">s</span> <span class="id">x</span>); <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">t</span> <span class="id">x</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#minus_min">minus_min</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmax_mult">bmax_mult</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id">max</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#max">max</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>) (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof215')">Proof.</div>
<div class="proofscript" id="proof215">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmax">bmax</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_mult">bunion_mult</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_mult">bminus_mult</a></span>; <span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">IHs</span>; <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">s</span> <span class="id">a</span>); <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">t</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#minus_max">minus_max</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">s</span> <span class="id">x</span>); <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">t</span> <span class="id">x</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#minus_max">minus_max</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmin_comm">bmin_comm</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span>) ≅ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof216')">Proof.</div>
<div class="proofscript" id="proof216">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_same_mult_has_equal">bags_same_mult_has_equal</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span> <span class="id">s</span> <span class="id">t</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span> <span class="id">t</span> <span class="id">s</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_comm">min_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmax_comm">bmax_comm</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> <span class="id">t</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> <span class="id">max</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span>) ≅ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#t">t</a></span> <span class="id">max</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof217')">Proof.</div>
<div class="proofscript" id="proof217">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_same_mult_has_equal">bags_same_mult_has_equal</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmax_mult">bmax_mult</a></span> <span class="id">s</span> <span class="id">t</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmax_mult">bmax_mult</a></span> <span class="id">t</span> <span class="id">s</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#max_comm">max_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="select_not_select">select_not_select</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>), <span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) ⊎ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>)) ≅ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof218')">Proof.</div>
<div class="proofscript" id="proof218">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#two_cases">two_cases</a></span> <span class="id">p</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_comm">bunion_comm</a></span> <span class="kwd">in</span> *; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_comm_cons">app_comm_cons</a></span>; <span class="tactic">rewrite</span> <span class="id">IHs</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_over_bunion_empty_r">bdistinct_over_bunion_empty_r</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0) -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof219')">Proof.</div>
<div class="proofscript" id="proof219">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id">l1</span>++<span class="id">l2</span>)) <span class="id">a</span>) = 0) \/ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id">l1</span>++<span class="id">l2</span>)) <span class="id">a</span>) = 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_at_most_one">bdistinct_at_most_one</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">IHl1</span> <span class="id">l2</span> <span class="id">a</span>); <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">IHl1</span> <span class="id">l2</span> <span class="id">x</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id">l1</span>++<span class="id">l2</span>)) <span class="id">a</span>) = 0) \/ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id">l1</span>++<span class="id">l2</span>)) <span class="id">a</span>) = 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_at_most_one">bdistinct_at_most_one</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_over_bunion_empty_l">bdistinct_over_bunion_empty_l</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0) -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof220')">Proof.</div>
<div class="proofscript" id="proof220">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_mult">bdistinct_mult</a></span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_mult">bunion_mult</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>; <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHl1</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_over_bunion_singleton2">bdistinct_over_bunion_singleton2</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0) -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 1) -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>)) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 1).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof221')">Proof.</div>
<div class="proofscript" id="proof221">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_mult">bdistinct_mult</a></span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_mult">bunion_mult</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H0</span>; <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span> <span class="id">IHl1</span> <span class="id">H0</span>; <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l1</span> <span class="id">a</span>); <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l2</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n</span> = 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> <span class="kwd">with</span> (<span class="id">n2</span> := 0); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Plus.html#plus_0_r">plus_0_r</a></span> <span class="kwd">in</span> *; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHl1</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_over_bunion">bdistinct_over_bunion</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>)) ≅ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span>) <span class="id">max</span>-<span class="id">b</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof222')">Proof.</div>
<div class="proofscript" id="proof222">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_same_mult_has_equal">bags_same_mult_has_equal</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmax_mult">bmax_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_mult">bdistinct_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_mult">bunion_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l1</span> <span class="id">a</span>); <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l2</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_against_one">min_against_one</a></span> <span class="id">n</span>); <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_against_one">min_against_one</a></span> <span class="id">n0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">n</span> = 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> <span class="kwd">with</span> (<span class="id">n2</span> := 0); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n0</span> = 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> <span class="kwd">with</span> (<span class="id">n2</span> := 0); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">n0</span> = 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> <span class="kwd">with</span> (<span class="id">n2</span> := 0); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">n</span> = 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> <span class="kwd">with</span> (<span class="id">n2</span> := 0); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Plus.html#plus_0_r">plus_0_r</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (1 &lt;= <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_one_yields_one">min_one_yields_one</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (1 &lt;= <span class="id">n0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_one_yields_one">min_one_yields_one</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#compare_either">compare_either</a></span> (<span class="id">n</span>+<span class="id">n0</span>) 1); <span class="tactic">intro</span>; <span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_r">min_r</a></span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#plus_n_Sm">plus_n_Sm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_r">min_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmin_zero">bmin_zero</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0 -&gt; (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0) \/ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof223')">Proof.</div>
<div class="proofscript" id="proof223">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l2</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>; <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="id">left</span>; <span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l1</span> <span class="id">a</span>) (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l2</span> <span class="id">a</span>)); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">IHl2</span> <span class="id">x</span>); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bmin_zero_back">bmin_zero_back</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>), <span class="kwd">forall</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0) \/ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0) -&gt; <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof224')">Proof.</div>
<div class="proofscript" id="proof224">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l2</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_0_r">min_0_r</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>; <span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a0</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l2</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l1</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_0_r">min_0_r</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l1</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l1</span> <span class="id">a</span>); <span class="tactic">intro</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_0_r">min_0_r</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bdistinct_over_bmin">bdistinct_over_bmin</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">l2</span> <span class="id">l1</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>)) ≅ ((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l1">l1</a></span>) <span class="id">min</span>-<span class="id">b</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct">bdistinct</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l2">l2</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof225')">Proof.</div>
<div class="proofscript" id="proof225">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_same_mult_has_equal">bags_same_mult_has_equal</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_mult">bdistinct_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bdistinct_mult">bdistinct_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l1</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">l2</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_against_one">min_against_one</a></span> <span class="id">n</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_against_one">min_against_one</a></span> <span class="id">n0</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n</span> = 0); <span class="tactic">try</span> (<span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> <span class="id">n</span> 0); <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n0</span> = 0); <span class="tactic">try</span> (<span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> <span class="id">n0</span> 0); <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n</span> = 0); <span class="tactic">try</span> (<span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> <span class="id">n</span> 0); <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n0</span> = 0); <span class="tactic">try</span> (<span class="tactic">apply</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#min_zero">min_zero</a></span> <span class="id">n0</span> 0); <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_0_r">min_0_r</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#compare_either">compare_either</a></span> <span class="id">n</span> <span class="id">n0</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min">min</a></span> <span class="id">n</span> <span class="id">n0</span> = <span class="id">n</span>). <span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_l">min_l</a></span>; [<span class="tactic">reflexivity</span>|<span class="tactic">assumption</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min">min</a></span> <span class="id">n</span> <span class="id">n0</span> = <span class="id">n0</span>). <span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_r">min_r</a></span>; [<span class="tactic">reflexivity</span>|<span class="tactic">assumption</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="split_select">split_select</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>), <span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">sp</span> <span class="id">nsp</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#sp">sp</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#nsp">nsp</a></span>) ≅ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#sp">sp</a></span>) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#sp">sp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#nsp">nsp</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof226')">Proof.</div>
<div class="proofscript" id="proof226">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">s</span> ≅ ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id">p</span> <span class="id">s</span>) ⊎ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id">p</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>)) <span class="id">s</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#select_not_select">select_not_select</a></span> <span class="id">p</span>) <span class="kwd">with</span> (<span class="id">s</span> := <span class="id">s</span>); <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id">p</span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id">p</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span>)) <span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>; <span class="tactic">reflexivity</span>|<span class="tactic">split</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#filter_filter">filter_filter</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#filter_not_filter">filter_not_filter</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mult_filter_true">mult_filter_true</a></span> <span class="id">l</span> {<span class="id">p</span> <span class="id">a</span>} : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof227')">Proof.</div>
<div class="proofscript" id="proof227">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">eqf</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">p</span> <span class="id">a0</span>); <span class="tactic">auto</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="mult_filter_false">mult_filter_false</a></span> <span class="id">l</span> {<span class="id">p</span> <span class="id">a</span>} : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span>) <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof228')">Proof.</div>
<div class="proofscript" id="proof228">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">p</span> <span class="id">a0</span>); <span class="tactic">auto</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">intuition</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bminus_delta2">bminus_delta2</a></span> (<span class="id">Q</span> <span class="id">dQm</span> <span class="id">dQp</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQm">dQm</a></span>) ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQp">dQp</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bplus_delta2">bplus_delta2</a></span> (<span class="id">Q</span> <span class="id">dQm</span> <span class="id">dQp</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQp">dQp</a></span> ⊖ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> <span class="id">min</span>-<span class="id">b</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQm">dQm</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="apply_deltas">apply_deltas</a></span> (<span class="id">Q</span> <span class="id">dQm</span> <span class="id">dQp</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQm">dQm</a></span>) ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQp">dQp</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="theorem2_a">theorem2_a</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Q</span> <span class="id">dQm</span> <span class="id">dQp</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#apply_deltas">apply_deltas</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQm">dQm</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQp">dQp</a></span>) ≅<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#apply_deltas">apply_deltas</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_delta2">bminus_delta2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQm">dQm</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQp">dQp</a></span>) (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bplus_delta2">bplus_delta2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQm">dQm</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQp">dQp</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof229')">Proof.</div>
<div class="proofscript" id="proof229">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_same_mult_has_equal">bags_same_mult_has_equal</a></span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#apply_deltas">apply_deltas</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_delta2">bminus_delta2</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bplus_delta2">bplus_delta2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_mult">bunion_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_mult">bminus_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">Q</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">nQ</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">dQm</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">ndQm</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">dQp</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">ndQp</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#compare_either">compare_either</a></span> <span class="id">nQ</span> <span class="id">ndQm</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_l">min_l</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_r">min_r</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="theorem2_b">theorem2_b</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Q</span> <span class="id">dQm</span> <span class="id">dQp</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_delta2">bminus_delta2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQm">dQm</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQp">dQp</a></span>) ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span>) ≅ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof230')">Proof.</div>
<div class="proofscript" id="proof230">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_same_mult_has_equal">bags_same_mult_has_equal</a></span>; <span class="tactic">intro</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_delta2">bminus_delta2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_mult">bminus_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">Q</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">nQ</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">dQm</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">ndQm</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">dQp</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">ndQp</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#compare_either">compare_either</a></span> <span class="id">nQ</span> <span class="id">ndQm</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_l">min_l</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_r">min_r</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="theorem2_c">theorem2_c</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">Q</span> <span class="id">dQm</span> <span class="id">dQp</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_delta2">bminus_delta2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQm">dQm</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQp">dQp</a></span>) <span class="id">min</span>-<span class="id">b</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bplus_delta2">bplus_delta2</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Q">Q</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQm">dQm</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#dQp">dQp</a></span>)) ≅ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof231')">Proof.</div>
<div class="proofscript" id="proof231">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bags_same_mult_has_equal">bags_same_mult_has_equal</a></span>; <span class="tactic">intro</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_delta2">bminus_delta2</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bplus_delta2">bplus_delta2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_mult">bminus_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bmin_mult">bmin_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">Q</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">nQ</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">dQm</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">ndQm</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult">mult</a></span> <span class="id">dQp</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">ndQp</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#compare_either">compare_either</a></span> <span class="id">nQ</span> <span class="id">ndQm</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min">min</a></span> <span class="id">nQ</span> <span class="id">ndQm</span> = <span class="id">nQ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_l">min_l</a></span>; [<span class="tactic">reflexivity</span>|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#compare_either">compare_either</a></span> <span class="id">nQ</span> <span class="id">ndQp</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_l">min_l</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_r">min_r</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min">min</a></span> <span class="id">nQ</span> <span class="id">ndQm</span> = <span class="id">ndQm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_r">min_r</a></span>; [<span class="tactic">reflexivity</span>|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#compare_either">compare_either</a></span> <span class="id">ndQm</span> <span class="id">ndQp</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_l">min_l</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Min.html#min_r">min_r</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="remove_one_bminus">remove_one_bminus</a></span> <span class="id">r</span> <span class="id">s</span> <span class="id">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#r">r</a></span>) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> ⊖ (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> :: <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#r">r</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof232')">Proof.</div>
<div class="proofscript" id="proof232">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s</span> <span class="id">r</span>. <span class="tactic">induction</span> <span class="id">r</span>; <span class="tactic">intros</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="remove_bminus_comm">remove_bminus_comm</a></span> <span class="id">r</span> <span class="id">s</span> <span class="id">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#r">r</a></span>) = (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#r">r</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof233')">Proof.</div>
<div class="proofscript" id="proof233">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">r</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">r</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one_comm">remove_one_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHr</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id">a0</span> <span class="id">s</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="filter_remove_one_false">filter_remove_one_false</a></span> <span class="id">s</span> {<span class="id">p</span> <span class="id">a</span>} : <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof234')">Proof.</div>
<div class="proofscript" id="proof234">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">eqf</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">case_eq</span> (<span class="id">p</span> <span class="id">a0</span>); <span class="tactic">intros</span> <span class="id">eqf0</span>; <span class="tactic">rewrite</span> <span class="id">IHs</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="filter_remove_one">filter_remove_one</a></span> <span class="id">s</span> {<span class="id">p</span> <span class="id">a</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>)) = <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one">remove_one</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#a">a</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof235')">Proof.</div>
<div class="proofscript" id="proof235">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">p</span> <span class="id">a0</span>); <span class="tactic">intros</span> <span class="id">eqf0</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">a0</span> <span class="id">a0</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#filter_remove_one_false">filter_remove_one_false</a></span> <span class="kwd">in</span> <span class="id">IHs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">case_eq</span> (<span class="id">p</span> <span class="id">a0</span>); <span class="tactic">intros</span> <span class="id">eqf0</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">EquivDec.equiv_dec</a></span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHs</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bunion_filter">bunion_filter</a></span> (<span class="id">s</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">ds</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) (<span class="id">p</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> ⊎ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#ds">ds</a></span>)) = ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) ⊎ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#ds">ds</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof236')">Proof.</div>
<div class="proofscript" id="proof236">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion">bunion</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsCoqLibAdd.html#two_cases">two_cases</a></span> <span class="id">p</span> <span class="id">a</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">try</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_comm_cons">app_comm_cons</a></span>; <span class="tactic">rewrite</span> <span class="id">IHs</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="bminus_filter">bminus_filter</a></span> (<span class="id">p</span>:<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">s</span> <span class="id">ds</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag.A">A</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> (<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span> ⊖ <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#ds">ds</a></span>)) = ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#s">s</a></span>) ⊖ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">filter</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#p">p</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#ds">ds</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof237')">Proof.</div>
<div class="proofscript" id="proof237">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ds</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHds</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">p</span> <span class="id">a</span>); <span class="tactic">intros</span> <span class="id">eqf</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#filter_remove_one">filter_remove_one</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#filter_remove_one_false">filter_remove_one_false</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#Bag">Bag</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="NumMinMax">NumMinMax</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bnummin">bnummin</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">x0</span> :: <span class="id">l</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.min">Z.min</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span>) <span class="id">x0</span> <span class="id">l</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="bnummax">bnummax</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">x0</span> :: <span class="id">l</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#x">x</a></span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#y">y</a></span>) <span class="id">x0</span> <span class="id">l</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#NumMinMax">NumMinMax</a></span>.<br/>
<br/>
<span class="kwd">Hint</span> <span class="id">Rewrite</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_nil_to_self">bminus_nil_to_self</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_to_nil">bminus_to_nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_self">bminus_self</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_naught">bminus_naught</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bminus_cons">bminus_cons</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#bunion_bminus">bunion_bminus</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#remove_one_consed">remove_one_consed</a></span> : <span class="id">bag</span>.<br/>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsListAdd.html#ldeqA">ldeqA</a></span> : <span class="id">bag</span>.<br/>
<span class="kwd">Hint</span> <span class="kwd">Unfold</span> <span class="id"><a href="CertRL.lib_utils.LibUtilsBag.html#mult_equiv">mult_equiv</a></span> : <span class="id">bag</span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
