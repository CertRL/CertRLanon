
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CertRL.utils.improper_integrals</title>
<meta name="description" content="Documentation of Coq module CertRL.utils.improper_integrals" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CertRL.utils.improper_integrals</h1>
<div class="coq">
<span class="id">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ssreflect</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Reals.html">Reals</a></span> <span class="id">Coquelicot.Coquelicot</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lra.html">Lra</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ball_Rabs">ball_Rabs</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">e</span> : <span class="id">ball</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#e">e</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> - <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#e">e</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1230')">Proof.</div>
<div class="proofscript" id="proof1230">
 <span class="tactic">intros</span>; <span class="tactic">tauto</span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="filter_Rlt">filter_Rlt</a></span> <span class="id">F1</span> <span class="id">F2</span> :=<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>, <span class="id">filter_prod</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F1">F1</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F2">F2</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#m">m</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_witness">filter_Rlt_witness</a></span> <span class="id">m</span> (<span class="id">F1</span> <span class="id">F2</span>  : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#F1">F1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rgt">Rgt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#m">m</a></span>) -&gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#F2">F2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rlt">Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#m">m</a></span>) -&gt;  <span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F1">F1</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F2">F2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1231')">Proof.</div>
<div class="proofscript" id="proof1231">
<span class="id">exists</span> <span class="id">m</span>; <span class="tactic">split</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rgt">Rgt</a></span> <span class="id">m</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rlt">Rlt</a></span> <span class="id">m</span>); <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_m_infty_p_infty">filter_Rlt_m_infty_p_infty</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">Rbar_locally</span> <span class="id">m_infty</span>) (<span class="id">Rbar_locally</span> <span class="id">p_infty</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1232')">Proof.</div>
<div class="proofscript" id="proof1232">
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> 0); <span class="id">exists</span> 0; <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_m_infty_at_left">filter_Rlt_m_infty_at_left</a></span> <span class="id">b</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">Rbar_locally</span> <span class="id">m_infty</span>) (<span class="id">at_left</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1233')">Proof.</div>
<div class="proofscript" id="proof1233">
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> (<span class="id">b</span> - 1)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">exists</span> (<span class="id">b</span> - 1); <span class="tactic">intros</span> <span class="id">x</span> <span class="id">cmpx</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_gt">Rlt_gt</a></span>.<br/>
<span class="id">exists</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pos_half">pos_half</a></span>; <span class="tactic">intros</span> <span class="id">x</span> <span class="id">yb</span> <span class="id">_</span>.<br/>
<span class="id">enough</span> (<span class="id">b</span> - <span class="id">x</span>  &lt; 1) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">abs</span> (<span class="id">minus</span> <span class="id">b</span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span> <span class="kwd">in</span> <span class="id">yb</span>; <span class="tactic">apply</span> <span class="id">AbsRing_norm_compat2</span> <span class="kwd">in</span> <span class="id">yb</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">yb</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_at_right_p_infty">filter_Rlt_at_right_p_infty</a></span> <span class="id">b</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">at_right</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>) (<span class="id">Rbar_locally</span> <span class="id">p_infty</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1234')">Proof.</div>
<div class="proofscript" id="proof1234">
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> (<span class="id">b</span> + 1)).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pos_half">pos_half</a></span>; <span class="tactic">intros</span> <span class="id">y</span> <span class="id">yb</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">enough</span> (<span class="id">y</span> - <span class="id">b</span> &lt; 1) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">abs</span> (<span class="id">minus</span> <span class="id">y</span> <span class="id">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">AbsRing_norm_compat2</span> <span class="kwd">in</span> <span class="id">yb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">yb</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
<span class="id">now</span> <span class="id">exists</span> (<span class="id">b</span> + 1); <span class="tactic">intros</span> <span class="id">x</span> <span class="id">cmpx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_at_point_p_infty">filter_Rlt_at_point_p_infty</a></span> <span class="id">b</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>) (<span class="id">Rbar_locally</span> <span class="id">p_infty</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1235')">Proof.</div>
<div class="proofscript" id="proof1235">
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> (<span class="id">b</span> + 1)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">at_point</span>; <span class="id">lra</span>.<br/>
<span class="id">now</span> <span class="id">exists</span> (<span class="id">b</span> + 1); <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_m_infty_at_point">filter_Rlt_m_infty_at_point</a></span> <span class="id">b</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">Rbar_locally</span> <span class="id">m_infty</span>) (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1236')">Proof.</div>
<div class="proofscript" id="proof1236">
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> (<span class="id">b</span> - 1)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">exists</span> (<span class="id">b</span> - 1); <span class="tactic">tauto</span>.<br/>
<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">at_point</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Lemma</span> <span class="id"><a name="compare_half_sum">compare_half_sum</a></span> <span class="id">a</span> <span class="id">b</span> (<span class="id">altb</span> : <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>) : <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> &lt; (<span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> + <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>) / 2 &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1237')">Proof.</div>
<div class="proofscript" id="proof1237">
<span class="tactic">assert</span> ((<span class="id">a</span> + <span class="id">b</span>) / 2 * 2 = <span class="id">a</span> + <span class="id">b</span>) <span class="tactic">by</span> <span class="id">field</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> 2; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_at_point">filter_Rlt_at_point</a></span> <span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1238')">Proof.</div>
<div class="proofscript" id="proof1238">
<span class="tactic">intros</span> <span class="id">altb</span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> <span class="kwd">with</span> ((<span class="id">a</span> + <span class="id">b</span>) / 2).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">at_point</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#compare_half_sum">compare_half_sum</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">altb</span>); <span class="tactic">tauto</span>.<br/>
<span class="tactic">unfold</span> <span class="id">at_point</span>.<br/>
<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#compare_half_sum">compare_half_sum</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">altb</span>); <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Rplus_minus_cancel1">Rplus_minus_cancel1</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> + <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> - <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> = <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1239')">Proof.</div>
<div class="proofscript" id="proof1239">
 <span class="tactic">intros</span>; <span class="tactic">ring</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_locally">filter_Rlt_locally</a></span> <span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">Rbar_locally</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) (<span class="id">Rbar_locally</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1240')">Proof.</div>
<div class="proofscript" id="proof1240">
<span class="tactic">intros</span> <span class="id">ab</span>.<br/>
<span class="tactic">assert</span> (<span class="id">bmap</span>: 0 &lt; (<span class="id">b</span> - <span class="id">a</span>)/2).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> 2;[<span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>;[ | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]; <span class="id">lra</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> ((<span class="id">a</span> + <span class="id">b</span>)/2)).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">bmap</span>); <span class="tactic">intros</span> <span class="id">y</span> <span class="id">ya</span>.<br/>
&nbsp;&nbsp;<span class="id">enough</span> (<span class="id">yma</span> : <span class="id">y</span> * 2 - <span class="id">a</span> * 2 &lt; <span class="id">b</span> - <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> 2;[<span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>;[ | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Rmult_minus_distr_r</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> (/2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>;[|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">lra</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">abs</span> (<span class="id">minus</span> <span class="id">y</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">AbsRing_norm_compat2</span> <span class="kwd">in</span> <span class="id">ya</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">ya</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">bmap</span>); <span class="tactic">intros</span> <span class="id">y</span> <span class="id">yb</span>.<br/>
<span class="id">enough</span> (<span class="id">yma</span> : <span class="id">b</span> * 2 - <span class="id">y</span> * 2 &lt; <span class="id">b</span> - <span class="id">a</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> 2;[<span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>;[ | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">lra</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>; <span class="id">lra</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Rmult_minus_distr_r</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> (/2).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="id">lra</span>.<br/>
<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>;[|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">lra</span>].<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">abs</span> (<span class="id">minus</span> <span class="id">b</span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span> <span class="kwd">in</span> <span class="id">yb</span>; <span class="tactic">apply</span> <span class="id">AbsRing_norm_compat2</span> <span class="kwd">in</span> <span class="id">yb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">yb</span>).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_left_right">filter_Rlt_left_right</a></span>  <span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">at_left</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) (<span class="id">at_right</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>).<br/>
<span class="tactic">intros</span> <span class="id">ab</span>; <span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">exists</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pos_half">pos_half</a></span>; <span class="tactic">intros</span> <span class="id">y</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_lt">Rgt_lt</a></span>.<br/>
<span class="id">now</span> <span class="id">exists</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pos_half">pos_half</a></span>; <span class="tactic">intros</span> <span class="id">y</span> <span class="id">_</span> <span class="id">yb</span> ; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> <span class="id">b</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_trans">filter_Rlt_trans</a></span> <span class="id">a</span> <span class="id">F</span> <span class="id">G</span> {<span class="id">FF</span> : <span class="id">Filter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>} {<span class="id">GG</span> : <span class="id">Filter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>} :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1241')">Proof.</div>
<div class="proofscript" id="proof1241">
<span class="tactic">intros</span> [<span class="id">m1</span> <span class="id">Pm1</span>] [<span class="id">m2</span> <span class="id">Pm2</span>].<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> <span class="kwd">with</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Pm1</span> <span class="kwd">as</span> [<span class="id">P</span> <span class="id">Q</span> <span class="id">FP</span> <span class="id">atQ</span> <span class="id">cnd1</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">qa</span> : <span class="id">Q</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id">atQ</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">filter_imp</span> <span class="id">P</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">px</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">t</span> := <span class="id">cnd1</span> <span class="id">x</span> <span class="id">a</span> <span class="id">px</span> <span class="id">qa</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">t</span>; <span class="tactic">destruct</span> <span class="id">t</span>; <span class="id">lra</span>.<br/>
<span class="tactic">destruct</span> <span class="id">Pm2</span> <span class="kwd">as</span> [<span class="id">P</span> <span class="id">Q</span> <span class="id">atP</span> <span class="id">GQ</span> <span class="id">cnd2</span>].<br/>
<span class="tactic">assert</span> (<span class="id">pa</span> : <span class="id">P</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id">atP</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
<span class="tactic">apply</span> (<span class="id">filter_imp</span> <span class="id">Q</span>); <span class="tactic">auto</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">qx</span>.<br/>
<span class="tactic">assert</span> (<span class="id">t</span> := <span class="id">cnd2</span> <span class="id">a</span> <span class="id">x</span> <span class="id">pa</span> <span class="id">qx</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">t</span>; <span class="tactic">destruct</span> <span class="id">t</span>; <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_Rlt_right_left">filter_Rlt_right_left</a></span> <span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">at_right</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) (<span class="id">at_left</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1242')">Proof.</div>
<div class="proofscript" id="proof1242">
<span class="tactic">intros</span> <span class="id">ab</span>.<br/>
<span class="tactic">assert</span> (<span class="id">bmap</span>: 0 &lt; (<span class="id">b</span> - <span class="id">a</span>)/2).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> 2;[<span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>;[ | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]; <span class="id">lra</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_witness">filter_Rlt_witness</a></span> ((<span class="id">a</span> + <span class="id">b</span>)/2)).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">bmap</span>); <span class="tactic">intros</span> <span class="id">y</span> <span class="id">ya</span> <span class="id">cmp</span>.<br/>
&nbsp;&nbsp;<span class="id">enough</span> (<span class="id">yma</span> : <span class="id">y</span> * 2 - <span class="id">a</span> * 2 &lt; <span class="id">b</span> - <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> 2;[<span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>;[ | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Rmult_minus_distr_r</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> (/2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>;[|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">lra</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">abs</span> (<span class="id">minus</span> <span class="id">y</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">AbsRing_norm_compat2</span> <span class="kwd">in</span> <span class="id">ya</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">ya</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">bmap</span>); <span class="tactic">intros</span> <span class="id">y</span> <span class="id">yb</span> <span class="id">cmp</span>.<br/>
<span class="id">enough</span> (<span class="id">yma</span> : <span class="id">b</span> * 2 - <span class="id">y</span> * 2 &lt; <span class="id">b</span> - <span class="id">a</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> 2;[<span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>;[ | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">lra</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>; <span class="id">lra</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Rmult_minus_distr_r</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="kwd">with</span> (/2).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="id">lra</span>.<br/>
<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>;[|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="id">lra</span>].<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">abs</span> (<span class="id">minus</span> <span class="id">b</span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span> <span class="kwd">in</span> <span class="id">yb</span>; <span class="tactic">apply</span> <span class="id">AbsRing_norm_compat2</span> <span class="kwd">in</span> <span class="id">yb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">yb</span>).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">real</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Ltac</span> <span class="id">chain_comparisons</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">h</span> : ?<span class="id">a</span> &lt;= <span class="id">_</span> |- ?<span class="id">a</span> &lt; <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">h</span>)<br/>
&nbsp;&nbsp;| <span class="id">h</span> : <span class="id">_</span> &lt;= ?<span class="id">a</span> |- <span class="id">_</span> &lt; ?<span class="id">a</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (2 := <span class="id">h</span>)<br/>
&nbsp;&nbsp;| <span class="id">h</span> : ?<span class="id">a</span> &lt; <span class="id">_</span> |- ?<span class="id">a</span> &lt; <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">h</span>)<br/>
&nbsp;&nbsp;| <span class="id">h</span> : <span class="id">_</span> &lt; ?<span class="id">a</span> |- <span class="id">_</span> &lt; ?<span class="id">a</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> (2 := <span class="id">h</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_RInt_gen_bound">ex_RInt_gen_bound</a></span> (<span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">F</span> <span class="id">G</span><br/>
&nbsp;&nbsp;{<span class="id">PF</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>} {<span class="id">PG</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>} :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">filter_prod</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">p</span> =&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span> -&gt; 0 &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_RInt</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1243')">Proof.</div>
<div class="proofscript" id="proof1243">
<span class="tactic">intros</span> [<span class="id">m</span> <span class="id">mmid</span>] [<span class="id">gl</span> <span class="id">intg</span>] <span class="id">cmp</span>.<br/>
<span class="tactic">assert</span> (<span class="id">F</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rgt">Rgt</a></span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mmid</span> <span class="kwd">as</span> [<span class="id">pf</span> <span class="id">pg</span> <span class="id">fpf</span> <span class="id">gpg</span> <span class="id">cmp</span>'].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">filter_imp</span> <span class="id">pf</span>); <span class="tactic">destruct</span> (<span class="id">filter_ex</span> <span class="id">pg</span>) <span class="kwd">as</span> [<span class="id">y</span> <span class="id">py</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">px</span>; <span class="tactic">destruct</span> (<span class="id">cmp</span>' <span class="id">x</span> <span class="id">y</span> <span class="id">px</span> <span class="id">py</span>) <span class="kwd">as</span> [<span class="id">it</span> <span class="id">_</span>]; <span class="tactic">exact</span> <span class="id">it</span>.<br/>
<span class="tactic">assert</span> (<span class="id">G</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rlt">Rlt</a></span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mmid</span> <span class="kwd">as</span> [<span class="id">pf</span> <span class="id">pg</span> <span class="id">fpf</span> <span class="id">gpg</span> <span class="id">cmp</span>'].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">filter_imp</span> <span class="id">pg</span>); <span class="tactic">destruct</span> (<span class="id">filter_ex</span> (<span class="id">F</span> := <span class="id">F</span>) <span class="id">pf</span>) <span class="kwd">as</span> [<span class="id">x</span> <span class="id">px</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">y</span> <span class="id">py</span>; <span class="tactic">destruct</span> (<span class="id">cmp</span>' <span class="id">x</span> <span class="id">y</span> <span class="id">px</span> <span class="id">py</span>) <span class="kwd">as</span> [<span class="id">_</span> <span class="id">it</span>]; <span class="tactic">exact</span> <span class="id">it</span>.<br/>
<span class="id">exists</span> (<span class="id">lim</span> (<span class="id">filtermap</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>)) (<span class="id">filter_prod</span> <span class="id">F</span> <span class="id">G</span>))).<br/>
<span class="tactic">destruct</span> <span class="id">cmp</span> <span class="kwd">as</span> [<span class="id">Q1</span> <span class="id">R1</span> <span class="id">fq1</span> <span class="id">gr1</span> <span class="id">cmp</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">cmp</span>.<br/>
<span class="tactic">assert</span> (<span class="id">cc</span> : <span class="id">cauchy</span> (<span class="id">filtermap</span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">filter_prod</span> <span class="id">F</span> <span class="id">G</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eps</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">intg</span> <span class="id">_</span> (<span class="id">locally_ball</span> <span class="id">gl</span> (<span class="id">pos_div_2</span> <span class="id">eps</span>))) <span class="kwd">as</span> [<span class="id">Qg</span> <span class="id">Rg</span> <span class="id">FQg</span> <span class="id">GRg</span> <span class="id">main</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">fq</span> : <span class="id">F</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">Q1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">Qg</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">m</span> &gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">filter_and</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">gr</span> : <span class="id">G</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">R1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">Rg</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">m</span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">filter_and</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">filter_ex</span> <span class="id">_</span> <span class="id">fq</span>) <span class="kwd">as</span> [<span class="id">x</span> <span class="id">qx</span>], (<span class="id">filter_ex</span> <span class="id">_</span> <span class="id">gr</span>) <span class="kwd">as</span> [<span class="id">y</span> <span class="id">ry</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">Q1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">Qg</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">m</span> &gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">R1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> /\ <span class="id">Rg</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> /\ <span class="id">m</span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">filter_and</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">u</span> <span class="id">v</span> <span class="id">Qu</span> <span class="id">Rv</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">wlog_cc</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Q1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> /\ <span class="id">Qg</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Q1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> /\ <span class="id">Qg</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#c">c</a></span> /\ <span class="id">Rg</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#d">d</a></span> /\ <span class="id">Rg</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#d">d</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> -&gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#c">c</a></span> &lt;=<span class="id"><a href="CertRL.utils.improper_integrals.html#d">d</a></span> -&gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> &lt; <span class="id">m</span> -&gt; <span class="id">m</span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ball</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#d">d</a></span>) <span class="id">eps</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#c">c</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#c">c</a></span>) <span class="id">eps</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#d">d</a></span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">x</span> <span class="id">y</span> <span class="id">qx</span> <span class="id">ry</span> <span class="id">u</span> <span class="id">v</span> <span class="id">Qu</span> <span class="id">Rv</span>; <span class="tactic">intros</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">Qa</span> <span class="id">Qb</span> <span class="id">Rc</span> <span class="id">Rd</span> <span class="id">ab</span> <span class="id">cd</span> <span class="id">bm</span> <span class="id">mc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">c</span> /\ <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">b</span> <span class="id">c</span> /\ <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">b</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span>; <span class="tactic">apply</span> <span class="id">cmp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">move</span> <span class="id">main</span> <span class="id">after</span> <span class="id">mc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">main</span> <span class="id">a</span> <span class="id">c</span>) <span class="kwd">as</span> [<span class="id">gac</span> [<span class="id">acP</span> <span class="id">acQ</span>]]; <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">acP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">g</span> <span class="id">a</span> <span class="id">c</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#ex_intro">ex_intro</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">main</span> <span class="id">b</span> <span class="id">c</span>) <span class="kwd">as</span> [<span class="id">gbc</span> [<span class="id">bcP</span> <span class="id">bcQ</span>]]; <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">bcP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">g</span> <span class="id">b</span> <span class="id">c</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#ex_intro">ex_intro</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">main</span> <span class="id">b</span> <span class="id">d</span>) <span class="kwd">as</span> [<span class="id">gbd</span> [<span class="id">bdP</span> <span class="id">bdQ</span>]]; <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">bdP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">g</span> <span class="id">b</span> <span class="id">d</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#ex_intro">ex_intro</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">ex_RInt_Chasles</span> <span class="kwd">with</span> <span class="id">c</span>;[ | <span class="tactic">apply</span> <span class="id">ex_RInt_swap</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">c</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">ex_RInt_Chasles</span> <span class="kwd">with</span> <span class="id">b</span>;[<span class="tactic">apply</span> <span class="id">ex_RInt_swap</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">g</span> <span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">ex_RInt_Chasles</span> <span class="kwd">with</span> <span class="id">c</span>;[ | <span class="tactic">apply</span> <span class="id">ex_RInt_swap</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#ex_intro">ex_intro</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">g</span> <span class="id">c</span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">ex_RInt_Chasles</span> <span class="kwd">with</span> <span class="id">b</span>;[<span class="tactic">apply</span> <span class="id">ex_RInt_swap</span> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#ex_intro">ex_intro</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">bc</span> : <span class="id">b</span> &lt; <span class="id">c</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> <span class="id">m</span>; <span class="tactic">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ball_sym</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">RInt</span> <span class="id">g</span> <span class="id">a</span> <span class="id">d</span> - <span class="id">RInt</span> <span class="id">g</span> <span class="id">b</span> <span class="id">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">RInt_Chasles</span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> <span class="id">d</span>), &lt;- (<span class="id">RInt_Chasles</span> <span class="id">f</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;- (<span class="id">RInt_Chasles</span> <span class="id">g</span> <span class="id">a</span> <span class="id">b</span> <span class="id">d</span>), &lt;- (<span class="id">RInt_Chasles</span> <span class="id">g</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> (<span class="id">RInt</span> <span class="id">_</span> <span class="id">a</span> <span class="id">b</span>)), !<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>, !<span class="id"><a href="CertRL.utils.improper_integrals.html#Rplus_minus_cancel1">Rplus_minus_cancel1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">abs</span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> -&gt; !<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>; <span class="tactic">apply</span> <span class="id">RInt_ge_0</span>; <span class="tactic">auto</span>);<br/>
<span class="comment">(*&nbsp;The&nbsp;following&nbsp;fragment&nbsp;duplicated&nbsp;several&nbsp;times.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">intros</span> <span class="id">x</span> [<span class="id">x1</span> <span class="id">x2</span>]; <span class="id">enough</span> (0 &lt;= <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">g</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">solve</span>[<span class="tactic">tauto</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">x</span>); <span class="tactic">tauto</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">cmp</span> <span class="id">a</span> <span class="id">d</span>); <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">repeat</span> (<span class="tactic">auto</span>; <span class="id">chain_comparisons</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>; <span class="tactic">apply</span> <span class="id">RInt_le</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>;<br/>
<span class="comment">(*&nbsp;the&nbsp;following&nbsp;fragment&nbsp;duplicated&nbsp;several&nbsp;times.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">intros</span> <span class="id">x</span> [<span class="id">x1</span> <span class="id">x2</span>]; <span class="id">enough</span> (0 &lt;= <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">g</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">solve</span>[<span class="tactic">tauto</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">x</span>); <span class="tactic">tauto</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">cmp</span> <span class="id">a</span> <span class="id">d</span>); <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">repeat</span> (<span class="tactic">auto</span>; <span class="id">chain_comparisons</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id">ball</span> (<span class="id">RInt</span> <span class="id">g</span> <span class="id">b</span> <span class="id">c</span>) <span class="id">eps</span> (<span class="id">RInt</span> <span class="id">g</span> <span class="id">a</span> <span class="id">d</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">with</span> (<span class="id">pos_div_2</span> <span class="id">eps</span> + <span class="id">pos_div_2</span> <span class="id">eps</span>) <span class="tactic">by</span> (<span class="tactic">simpl</span>; <span class="id">field</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> <span class="id">gl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">bcP</span>); <span class="tactic">apply</span> <span class="id">ball_sym</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">main</span> <span class="id">a</span> <span class="id">d</span>) <span class="kwd">as</span> [<span class="id">gad</span> [<span class="id">adP</span> <span class="id">adQ</span>]]; <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">adP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">adP</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">b</span> <span class="id">d</span> + - <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">c</span>) &lt; <span class="id">eps</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">RInt_Chasles</span> <span class="id">f</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span>), &lt;- (<span class="id">RInt_Chasles</span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_plus_distr">Ropp_plus_distr</a></span>, !<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>, (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">b</span> <span class="id">c</span>)), !<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_opp_l">Rplus_opp_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_Ropp">Rabs_Ropp</a></span>, !<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>, <span class="id">RInt_ge_0</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>);<br/>
<span class="comment">(*&nbsp;the&nbsp;following&nbsp;fragment&nbsp;duplicated&nbsp;several&nbsp;times.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">intros</span> <span class="id">x</span> [<span class="id">x1</span> <span class="id">x2</span>]; <span class="id">enough</span> (0 &lt;= <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">g</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">solve</span>[<span class="tactic">tauto</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">x</span>); <span class="tactic">tauto</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">cmp</span> <span class="id">a</span> <span class="id">d</span>); <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">repeat</span> (<span class="tactic">auto</span>; <span class="id">chain_comparisons</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">with</span> (<span class="id">pos_div_2</span> <span class="id">eps</span> + <span class="id">pos_div_2</span> <span class="id">eps</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">simpl</span>; <span class="id">field</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">dc</span> : <span class="id">RInt</span> <span class="id">f</span> <span class="id">c</span> <span class="id">d</span> &lt;= <span class="id">RInt</span> <span class="id">g</span> <span class="id">c</span> <span class="id">d</span> /\ <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> &lt;= <span class="id">RInt</span> <span class="id">g</span> <span class="id">a</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id">RInt_le</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>;<br/>
<span class="comment">(*&nbsp;the&nbsp;following&nbsp;fragment&nbsp;duplicated&nbsp;several&nbsp;times.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">intros</span> <span class="id">x</span> [<span class="id">x1</span> <span class="id">x2</span>]; <span class="id">enough</span> (0 &lt;= <span class="id">f</span> <span class="id">x</span> &lt;= <span class="id">g</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">solve</span>[<span class="tactic">tauto</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">f</span> <span class="id">x</span>); <span class="tactic">tauto</span>]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">cmp</span> <span class="id">a</span> <span class="id">d</span>); <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">repeat</span> (<span class="tactic">auto</span>; <span class="id">chain_comparisons</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">dc</span>)(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">dc</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">RInt</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">RInt</span> <span class="id">g</span> <span class="id">a</span> <span class="id">d</span> - <span class="id">gl</span>) - (<span class="id">RInt</span> <span class="id">g</span> <span class="id">b</span> <span class="id">c</span> - <span class="id">gl</span>)) <span class="tactic">by</span> <span class="comment">(*TODO&nbsp;:&nbsp;explain&nbsp;this!&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">rewrite</span> &lt;- (<span class="id">RInt_Chasles</span> <span class="id">g</span> <span class="id">a</span> <span class="id">b</span> <span class="id">d</span>), &lt;- (<span class="id">RInt_Chasles</span> <span class="id">g</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">set</span> (<span class="id">zoo</span> := <span class="id">plus</span>); <span class="id">change</span> <span class="id">zoo</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.Rplus">Rplus</a></span>; <span class="tactic">ring</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_compat">Rplus_lt_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">main</span> <span class="id">a</span> <span class="id">d</span>) <span class="kwd">as</span> [<span class="id">gad</span> [<span class="id">adP</span> <span class="id">adQ</span>]]; <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">adP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">adP</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_Ropp">Rabs_Ropp</a></span>; <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">bcP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_dec">Rlt_dec</a></span> <span class="id">x</span> <span class="id">u</span>), (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_dec">Rlt_dec</a></span> <span class="id">v</span> <span class="id">y</span>);<br/>
&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> (<span class="id">wlog_cc</span> <span class="id">x</span> <span class="id">u</span> <span class="id">v</span> <span class="id">y</span>) | <span class="tactic">apply</span> (<span class="id">wlog_cc</span> <span class="id">x</span> <span class="id">u</span> <span class="id">y</span> <span class="id">v</span>) |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ball_sym</span>, (<span class="id">wlog_cc</span> <span class="id">u</span> <span class="id">x</span> <span class="id">v</span> <span class="id">y</span>) | <span class="tactic">apply</span> <span class="id">ball_sym</span>, (<span class="id">wlog_cc</span> <span class="id">u</span> <span class="id">x</span> <span class="id">y</span> <span class="id">v</span>)];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span>[<span class="tactic">tauto</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>; <span class="tactic">tauto</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>; <span class="tactic">tauto</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">tauto</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_lt_le">Rnot_lt_le</a></span>; <span class="tactic">tauto</span>].<br/>
<span class="tactic">intros</span> <span class="id">P</span> [<span class="id">eps</span> <span class="id">Peps</span>].<br/>
<span class="tactic">move</span> <span class="id">cc</span> <span class="id">after</span> <span class="id">Peps</span>.<br/>
<span class="tactic">unfold</span> <span class="id">filtermapi</span>.<br/>
<span class="tactic">assert</span> (<span class="id">tmp</span> := <span class="id">complete_cauchy</span> <span class="id">_</span> <span class="id">_</span> <span class="id">cc</span> <span class="id">eps</span>).<br/>
<span class="tactic">destruct</span> <span class="id">tmp</span> <span class="kwd">as</span> [<span class="id">Q2</span> <span class="id">R2</span> <span class="id">Q2P</span> <span class="id">R2P</span> <span class="id">PP2</span>].<br/>
<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">Q2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">Q1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">R2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">R1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">auto</span>).<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> [<span class="id">Q2x</span> <span class="id">Q1x</span>] [<span class="id">R2x</span> <span class="id">R1x</span>].<br/>
<span class="tactic">destruct</span> (<span class="id">cmp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Q1x</span> <span class="id">R1x</span>) <span class="kwd">as</span> [<span class="id">cmp</span>' [<span class="id">fxy</span> <span class="id">intxy</span>]].<br/>
<span class="id">exists</span> <span class="id">fxy</span>; <span class="tactic">split</span>;[<span class="tactic">assumption</span> | <span class="tactic">apply</span> <span class="id">Peps</span>].<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">intxy</span>); <span class="tactic">apply</span> <span class="id">PP2</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_Rle">is_RInt_gen_Rle</a></span> (<span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">gl</span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">fl</span> <span class="id">F</span> <span class="id">G</span><br/>
&nbsp;&nbsp;{<span class="id">PF</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>} {<span class="id">PG</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>} :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#gl">gl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#fl">fl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">filter_prod</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">p</span> =&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span> -&gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#fl">fl</a></span> &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#gl">gl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1244')">Proof.</div>
<div class="proofscript" id="proof1244">
<span class="tactic">intros</span> [<span class="id">m</span> <span class="id">mmid</span>] <span class="id">intg</span> <span class="id">intf</span> <span class="id">cmp</span>.<br/>
<span class="tactic">apply</span> (<span class="id">filterlim_le</span> (<span class="id">F</span> := <span class="id">filter_prod</span> <span class="id">F</span> <span class="id">G</span>) (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id">RInt</span> <span class="id">g</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>)) <span class="id">fl</span> <span class="id">gl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">intf</span> <span class="id">_</span> (<span class="id">locally_ball</span> <span class="id">fl</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">intg</span> <span class="id">_</span> (<span class="id">locally_ball</span> <span class="id">gl</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">filtermapi</span> <span class="kwd">in</span> <span class="id">intg</span>, <span class="id">intf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span>: <span class="id">filter_imp</span> (<span class="id">filter_and</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">filter_and</span> <span class="id">_</span> <span class="id">_</span> <span class="id">intg</span> <span class="id">intf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">filter_and</span> <span class="id">_</span> <span class="id">_</span> <span class="id">mmid</span> <span class="id">cmp</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">a</span> <span class="id">b</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span> [[[<span class="id">Ig</span> [<span class="id">Hg1</span> <span class="id">Hg2</span>]] [<span class="id">If</span> [<span class="id">Hf1</span> <span class="id">Hf2</span>]]] [<span class="id">cmp</span>']]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">RInt_le</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> <span class="id">m</span>;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> | <span class="id">exists</span> <span class="id">If</span>| <span class="id">exists</span> <span class="id">Ig</span>| ]; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">P</span> <span class="id">HP</span>; <span class="id">specialize</span> (<span class="id">intf</span> <span class="id">P</span> <span class="id">HP</span>); <span class="tactic">unfold</span> <span class="id">filtermapi</span>, <span class="id">filtermap</span> <span class="kwd">in</span> <span class="id">intf</span> |- *.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span>: <span class="id">filter_imp</span> <span class="id">intf</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">a</span> <span class="id">b</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span> [<span class="id">y</span> [<span class="id">inty</span> <span class="id">Py</span>]].<br/>
&nbsp;&nbsp;<span class="id">now</span>  <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">inty</span>).<br/>
<span class="tactic">intros</span> <span class="id">P</span> <span class="id">HP</span>; <span class="id">specialize</span> (<span class="id">intg</span> <span class="id">P</span> <span class="id">HP</span>); <span class="tactic">unfold</span> <span class="id">filtermapi</span>, <span class="id">filtermap</span> <span class="kwd">in</span> <span class="id">intg</span> |- *.<br/>
<span class="tactic">apply</span>: <span class="id">filter_imp</span> <span class="id">intg</span>.<br/>
<span class="tactic">intros</span> [<span class="id">a</span> <span class="id">b</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span> [<span class="id">y</span> [<span class="id">inty</span> <span class="id">Py</span>]].<br/>
<span class="id">now</span>  <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">inty</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_at_point_at_right">is_RInt_gen_at_point_at_right</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">F</span> {<span class="id">FF</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>}<br/>
&nbsp;&nbsp;<span class="id">v</span> : <span class="id">locally</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> (<span class="id">continuous</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span>) -&gt; <span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> -&gt;  <span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id">at_right</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1245')">Proof.</div>
<div class="proofscript" id="proof1245">
<span class="tactic">intros</span> [<span class="id">delta1</span> <span class="id">pd1</span>] <span class="id">intf</span> [<span class="id">m</span> [<span class="id">P</span> <span class="id">Q</span> <span class="id">FP</span> <span class="id">FQ</span> <span class="id">cmp</span>]]; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">cmp</span>.<br/>
<span class="tactic">destruct</span> (<span class="id">pd1</span> <span class="id">a</span> (<span class="id">ball_center</span> <span class="id">a</span> <span class="id">delta1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ball</span> (<span class="id">f</span> <span class="id">a</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>)) (<span class="id">locally_ball</span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">delta2</span> <span class="id">Pd2</span>].<br/>
<span class="tactic">assert</span> (<span class="id">pa</span> : <span class="id">P</span> <span class="id">a</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">FP</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>).<br/>
<span class="tactic">assert</span> (<span class="id">intf2</span> := <span class="id">intf</span>).<br/>
<span class="tactic">intros</span> <span class="id">P2</span> <span class="id">PP2</span>; <span class="id">specialize</span> (<span class="id">intf</span> <span class="id">P2</span> <span class="id">PP2</span>); <span class="tactic">destruct</span> <span class="id">PP2</span> <span class="kwd">as</span> [<span class="id">eps</span> <span class="id">P2eps</span>].<br/>
<span class="tactic">set</span> (<span class="id">M</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>) + 1).<br/>
<span class="tactic">assert</span> (<span class="id">M0</span> : 0 &lt; <span class="id">eps</span> / <span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>; <span class="tactic">unfold</span> <span class="id">M</span>; <span class="id">lra</span>.<br/>
<span class="tactic">assert</span> (<span class="id">close</span> : <span class="kwd">forall</span> <span class="id">y</span>, <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> &lt;&gt; <span class="id">a</span> -&gt; <span class="id">ball</span> <span class="id">a</span> <span class="id">delta2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>) &lt; <span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">y</span> <span class="id">ay</span> <span class="id">b_y</span>; <span class="tactic">unfold</span> <span class="id">M</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">f</span> <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">f</span> <span class="id">a</span> + (<span class="id">f</span> <span class="id">y</span> - <span class="id">f</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>, <span class="id">Pd2</span>; <span class="tactic">auto</span>.<br/>
<span class="tactic">assert</span> (<span class="id">exrint_close</span> : <span class="kwd">forall</span> <span class="id">a</span>', <span class="id">ball</span> <span class="id">a</span> <span class="id">delta1</span> <span class="id">a</span>' -&gt; <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">a</span>').<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span>' <span class="id">baa</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">ex_RInt_continuous</span> <span class="id">f</span>); <span class="tactic">intros</span> <span class="id">z</span> <span class="id">pz</span>; <span class="tactic">apply</span> <span class="id">pd1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">a</span> <span class="id">a</span>') <span class="kwd">as</span> [<span class="id">aa</span>' | <span class="id">a</span>'<span class="id">a</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_left">Rmin_left</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_right">Rmax_right</a></span> <span class="kwd">in</span> <span class="id">pz</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">z</span> - <span class="id">a</span>) &lt; <span class="id">delta1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pz</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pz</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span>' - <span class="id">a</span>); <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id">a</span>' - <span class="id">a</span>)); <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">z</span> - <span class="id">a</span>) &lt; <span class="id">delta1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">a</span> <span class="id">z</span>) <span class="kwd">as</span> [<span class="id">az</span> | <span class="id">za</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="kwd">in</span> <span class="id">a</span>'<span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_right">Rmin_right</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span> <span class="kwd">in</span> <span class="id">pz</span>; <span class="tactic">try</span> (<span class="tactic">destruct</span> <span class="id">pz</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">za</span>' : <span class="id">z</span> = <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>; (<span class="tactic">destruct</span> <span class="id">pz</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id">za</span>', <span class="id">Rminus_eq_0</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>; <span class="tactic">case</span> <span class="id">delta1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="kwd">in</span> <span class="id">a</span>'<span class="id">a</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="kwd">in</span> <span class="id">za</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_right">Rmin_right</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span> <span class="kwd">in</span> <span class="id">pz</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left">Rabs_left</a></span>;[ | <span class="id">lra</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span> - <span class="id">a</span>'); <span class="tactic">try</span> (<span class="tactic">intuition</span> <span class="id">lra</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id">a</span> - <span class="id">a</span>')); <span class="tactic">try</span> (<span class="tactic">intuition</span> <span class="id">lra</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">change</span> (<span class="id">ball</span> <span class="id">a</span>' <span class="id">delta1</span> <span class="id">a</span>); <span class="tactic">apply</span> <span class="id">ball_sym</span>; <span class="tactic">tauto</span>.<br/>
<span class="tactic">assert</span> (<span class="id">pre_ep2</span> : 0 &lt; <span class="id">eps</span> / 2 * /<span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="id">lra</span>;[<span class="tactic">destruct</span> <span class="id">eps</span>; <span class="tactic">tauto</span> | ].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="tactic">unfold</span> <span class="id">M</span>; <span class="tactic">assert</span> (<span class="id">t</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> (<span class="id">f</span> <span class="id">a</span>)); <span class="id">lra</span>.<br/>
<span class="tactic">set</span> (<span class="id">ep2</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">pre_ep2</span>).<br/>
<span class="tactic">assert</span> (<span class="id">at_right</span> <span class="id">a</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">ball</span> <span class="id">a</span> <span class="id">delta1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">ball</span> <span class="id">a</span> <span class="id">ep2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> <span class="id">a</span> <span class="id">delta2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">a</span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt; <span class="id">m</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">try</span> (<span class="id">now</span> <span class="tactic">apply</span> <span class="id">filter_le_within</span>, <span class="id">locally_ball</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">exists</span> <span class="id">ep2</span>; <span class="tactic">intros</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">filter_ex</span> <span class="id">_</span> <span class="id">FQ</span>) <span class="kwd">as</span> [<span class="id">y</span>' <span class="id">Py</span>'].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ma0</span> : 0 &lt; <span class="id">m</span> - <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id">cmp</span> <span class="id">a</span> <span class="id">y</span>'); <span class="tactic">auto</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">ma0</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">bay</span> <span class="id">ay</span>; <span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">y</span> - <span class="id">a</span>) &lt; <span class="id">m</span> - <span class="id">a</span>) <span class="kwd">in</span> <span class="id">bay</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="kwd">in</span> <span class="id">bay</span>; <span class="id">lra</span>.<br/>
<span class="id">specialize</span> (<span class="id">intf2</span> <span class="id">_</span> (<span class="id">locally_ball</span> <span class="id">v</span> (<span class="id">pos_div_2</span> <span class="id">eps</span>))).<br/>
<span class="tactic">destruct</span> <span class="id">intf2</span> <span class="kwd">as</span> [<span class="id">Pl</span> <span class="id">Ql</span> <span class="id">FPl</span> <span class="id">FQl</span> <span class="id">closerint</span>].<br/>
<span class="tactic">assert</span> (<span class="id">pla</span> : <span class="id">Pl</span> <span class="id">a</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">FPl</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>).<br/>
<span class="tactic">assert</span> (<span class="id">F</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">Q</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> /\ <span class="id">Ql</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">auto</span>).<br/>
<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">ball</span> <span class="id">a</span> <span class="id">delta1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">ball</span> <span class="id">a</span> <span class="id">ep2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> <span class="id">a</span> <span class="id">delta2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">a</span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt; <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">Q</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> /\ <span class="id">Ql</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>); <span class="tactic">auto</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">bx</span> <span class="id">Ry</span>; <span class="id">exists</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>).<br/>
<span class="tactic">destruct</span> (<span class="id">closerint</span> <span class="id">a</span> <span class="id">y</span>) <span class="kwd">as</span> [<span class="id">fay</span> [<span class="id">close_fay</span>]]; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> (<span class="id">RInt_correct</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">ex_RInt_Chasles_2</span> <span class="id">f</span> <span class="id">a</span>);[ | <span class="id">exists</span> <span class="id">fay</span>; <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> <span class="id">m</span>; <span class="tactic">assert</span> (<span class="id">t</span> := <span class="id">cmp</span> <span class="id">a</span> <span class="id">y</span> <span class="id">pa</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Ry</span>))]; <span class="tactic">tauto</span>.<br/>
<span class="tactic">apply</span> <span class="id">P2eps</span>.<br/>
<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">x</span>) &lt; <span class="id">pos_div_2</span> <span class="id">eps</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> ((<span class="id">x</span> - <span class="id">a</span>) * <span class="id">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">abs_RInt_le_const</span>;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>; <span class="tactic">tauto</span> | | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">exrint_close</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">atx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">f</span> <span class="id">t</span>) <span class="kwd">with</span> (<span class="id">f</span> <span class="id">a</span> + (<span class="id">f</span> <span class="id">t</span> - <span class="id">f</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>, (<span class="id">Pd2</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">t</span> - <span class="id">a</span>) &lt; <span class="id">delta2</span>); <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>;[ | <span class="tactic">intuition</span> <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">x</span> - <span class="id">a</span>);[<span class="tactic">intuition</span> <span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id">x</span> - <span class="id">a</span>));[<span class="tactic">tauto</span> | <span class="tactic">intuition</span> <span class="id">lra</span>].<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> (<span class="id">pos_div_2</span> <span class="id">eps</span>)) <span class="kwd">with</span> (<span class="id">ep2</span> * <span class="id">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id">x</span> - <span class="id">a</span>));[|<span class="tactic">intuition</span> <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>;[<span class="tactic">unfold</span> <span class="id">M</span>  | <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">assert</span> (<span class="id">t</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> (<span class="id">f</span> <span class="id">a</span>)); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">field</span>; <span class="tactic">unfold</span> <span class="id">M</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">assert</span> (<span class="id">t</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> (<span class="id">f</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">lra</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">with</span> (<span class="id">pos_div_2</span> <span class="id">eps</span> + <span class="id">pos_div_2</span> <span class="id">eps</span>) <span class="tactic">by</span> (<span class="tactic">simpl</span>; <span class="id">field</span>).<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> - <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>) &lt; <span class="id">pos_div_2</span> <span class="id">eps</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">x</span> + <span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">RInt_Chasles</span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">exrint_close</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">ex_RInt_Chasles_2</span> <span class="id">f</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>; <span class="tactic">tauto</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> <span class="id">m</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id">cmp</span> <span class="id">a</span> <span class="id">y</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">exists</span> <span class="id">fay</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> ?<span class="id">v</span> &lt; <span class="id">_</span> =&gt; <span class="tactic">replace</span> <span class="id">v</span> <span class="kwd">with</span> (-<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">x</span>) <span class="tactic">by</span> <span class="tactic">ring</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_Ropp">Rabs_Ropp</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_unique</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span> <span class="id">fay</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_at_point_at_left">is_RInt_gen_at_point_at_left</a></span> (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">F</span> {<span class="id">FF</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>}<br/>
&nbsp;&nbsp;<span class="id">v</span> : <span class="id">locally</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span> (<span class="id">continuous</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span>) -&gt; <span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) -&gt;  <span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> (<span class="id">at_left</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1246')">Proof.</div>
<div class="proofscript" id="proof1246">
<span class="tactic">intros</span> [<span class="id">delta1</span> <span class="id">pd1</span>] <span class="id">intf</span> [<span class="id">m</span> [<span class="id">P</span> <span class="id">Q</span> <span class="id">FP</span> <span class="id">FQ</span> <span class="id">cmp</span>]]; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">cmp</span>.<br/>
<span class="tactic">destruct</span> (<span class="id">pd1</span> <span class="id">a</span> (<span class="id">ball_center</span> <span class="id">a</span> <span class="id">delta1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ball</span> (<span class="id">f</span> <span class="id">a</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>)) (<span class="id">locally_ball</span> <span class="id">_</span> <span class="id">_</span>)) <span class="kwd">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">delta2</span> <span class="id">Pd2</span>].<br/>
<span class="tactic">assert</span> (<span class="id">qa</span> : <span class="id">Q</span> <span class="id">a</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">FQ</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>).<br/>
<span class="tactic">assert</span> (<span class="id">intf2</span> := <span class="id">intf</span>).<br/>
<span class="tactic">intros</span> <span class="id">P2</span> <span class="id">PP2</span>; <span class="id">specialize</span> (<span class="id">intf</span> <span class="id">P2</span> <span class="id">PP2</span>); <span class="tactic">destruct</span> <span class="id">PP2</span> <span class="kwd">as</span> [<span class="id">eps</span> <span class="id">P2eps</span>].<br/>
<span class="tactic">set</span> (<span class="id">M</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>) + 1).<br/>
<span class="tactic">assert</span> (<span class="id">M0</span> : 0 &lt; <span class="id">eps</span> / <span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>; <span class="tactic">unfold</span> <span class="id">M</span>; <span class="id">lra</span>.<br/>
<span class="tactic">assert</span> (<span class="id">close</span> : <span class="kwd">forall</span> <span class="id">y</span>, <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> &lt;&gt; <span class="id">a</span> -&gt; <span class="id">ball</span> <span class="id">a</span> <span class="id">delta2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">f</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>) &lt; <span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">y</span> <span class="id">ay</span> <span class="id">b_y</span>; <span class="tactic">unfold</span> <span class="id">M</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">f</span> <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">f</span> <span class="id">a</span> + (<span class="id">f</span> <span class="id">y</span> - <span class="id">f</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>, <span class="id">Pd2</span>; <span class="tactic">auto</span>.<br/>
<span class="tactic">assert</span> (<span class="id">exrint_close</span> : <span class="kwd">forall</span> <span class="id">a</span>', <span class="id">ball</span> <span class="id">a</span> <span class="id">delta1</span> <span class="id">a</span>' -&gt; <span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">a</span>' <span class="id">a</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span>' <span class="id">baa</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">ex_RInt_continuous</span> <span class="id">f</span>); <span class="tactic">intros</span> <span class="id">z</span> <span class="id">pz</span>; <span class="tactic">apply</span> <span class="id">pd1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">a</span> <span class="id">a</span>') <span class="kwd">as</span> [<span class="id">aa</span>' | <span class="id">a</span>'<span class="id">a</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_right">Rmin_right</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_left">Rmax_left</a></span> <span class="kwd">in</span> <span class="id">pz</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">z</span> - <span class="id">a</span>) &lt; <span class="id">delta1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pz</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pz</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span>' - <span class="id">a</span>); <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id">a</span>' - <span class="id">a</span>)); <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">z</span> - <span class="id">a</span>) &lt; <span class="id">delta1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> <span class="id">a</span> <span class="id">z</span>) <span class="kwd">as</span> [<span class="id">az</span> | <span class="id">za</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="kwd">in</span> <span class="id">a</span>'<span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_left">Rmin_left</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_right">Rmax_right</a></span> <span class="kwd">in</span> <span class="id">pz</span>; <span class="tactic">try</span> (<span class="tactic">destruct</span> <span class="id">pz</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">za</span>' : <span class="id">z</span> = <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>; (<span class="tactic">destruct</span> <span class="id">pz</span>; <span class="id">lra</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id">za</span>', <span class="id">Rminus_eq_0</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>; <span class="tactic">case</span> <span class="id">delta1</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="kwd">in</span> <span class="id">a</span>'<span class="id">a</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="kwd">in</span> <span class="id">za</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_left">Rmin_left</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax_right">Rmax_right</a></span> <span class="kwd">in</span> <span class="id">pz</span>; <span class="tactic">try</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left">Rabs_left</a></span>;[ | <span class="id">lra</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span> - <span class="id">a</span>'); <span class="tactic">try</span> (<span class="tactic">intuition</span> <span class="id">lra</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id">a</span> - <span class="id">a</span>')); <span class="tactic">try</span> (<span class="tactic">intuition</span> <span class="id">lra</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">change</span> (<span class="id">ball</span> <span class="id">a</span>' <span class="id">delta1</span> <span class="id">a</span>); <span class="tactic">apply</span> <span class="id">ball_sym</span>; <span class="tactic">tauto</span>.<br/>
<span class="tactic">assert</span> (<span class="id">pre_ep2</span> : 0 &lt; <span class="id">eps</span> / 2 * /<span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="id">lra</span>;[<span class="tactic">destruct</span> <span class="id">eps</span>; <span class="tactic">tauto</span> | ].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>; <span class="tactic">unfold</span> <span class="id">M</span>; <span class="tactic">assert</span> (<span class="id">t</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> (<span class="id">f</span> <span class="id">a</span>)); <span class="id">lra</span>.<br/>
<span class="tactic">set</span> (<span class="id">ep2</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">pre_ep2</span>).<br/>
<span class="tactic">assert</span> (<span class="id">at_left</span> <span class="id">a</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">ball</span> <span class="id">a</span> <span class="id">delta1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">ball</span> <span class="id">a</span> <span class="id">ep2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> <span class="id">a</span> <span class="id">delta2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">m</span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt; <span class="id">a</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">try</span> (<span class="id">now</span> <span class="tactic">apply</span> <span class="id">filter_le_within</span>, <span class="id">locally_ball</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">filter_ex</span> <span class="id">_</span> <span class="id">FP</span>) <span class="kwd">as</span> [<span class="id">y</span>' <span class="id">Py</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ma0</span> : 0 &lt; <span class="id">a</span> - <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id">cmp</span> <span class="id">y</span>' <span class="id">a</span>); <span class="tactic">auto</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">ma0</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#ball_Rabs">ball_Rabs</a></span>; <span class="tactic">intros</span> <span class="id">bay</span> <span class="id">ay</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left">Rabs_left</a></span> <span class="kwd">in</span> <span class="id">bay</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">exists</span> <span class="id">ep2</span>; <span class="tactic">intros</span>; <span class="tactic">tauto</span>.<br/>
<span class="id">specialize</span> (<span class="id">intf2</span> <span class="id">_</span> (<span class="id">locally_ball</span> <span class="id">v</span> (<span class="id">pos_div_2</span> <span class="id">eps</span>))).<br/>
<span class="tactic">destruct</span> <span class="id">intf2</span> <span class="kwd">as</span> [<span class="id">Pl</span> <span class="id">Ql</span> <span class="id">FPl</span> <span class="id">FQl</span> <span class="id">closerint</span>].<br/>
<span class="tactic">assert</span> (<span class="id">pla</span> : <span class="id">Ql</span> <span class="id">a</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">FQl</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>).<br/>
<span class="tactic">assert</span> (<span class="id">F</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">P</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> /\ <span class="id">Pl</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">auto</span>).<br/>
<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">P</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> /\ <span class="id">Pl</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">ball</span> <span class="id">a</span> <span class="id">delta1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">ball</span> <span class="id">a</span> <span class="id">ep2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> <span class="id">a</span> <span class="id">delta2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">m</span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt; <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">bx</span> <span class="id">Ry</span>; <span class="id">exists</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>).<br/>
<span class="tactic">destruct</span> (<span class="id">closerint</span> <span class="id">x</span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">fxa</span> [<span class="id">close_fxa</span>]]; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> (<span class="id">RInt_correct</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">ex_RInt_Chasles_1</span> <span class="id">f</span> <span class="id">_</span> <span class="id">_</span> <span class="id">a</span>);[ | <span class="id">exists</span> <span class="id">fxa</span>; <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> <span class="id">m</span>; <span class="tactic">assert</span> (<span class="id">t</span> := <span class="id">cmp</span> <span class="id">x</span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">bx</span>) <span class="id">qa</span>) |]; <span class="tactic">tauto</span>.<br/>
<span class="tactic">apply</span> <span class="id">P2eps</span>.<br/>
<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">y</span> <span class="id">a</span>) &lt; <span class="id">pos_div_2</span> <span class="id">eps</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> ((<span class="id">a</span> - <span class="id">y</span>) * <span class="id">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">abs_RInt_le_const</span>;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>; <span class="tactic">tauto</span> | | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">exrint_close</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">t</span> <span class="id">yta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">f</span> <span class="id">t</span>) <span class="kwd">with</span> (<span class="id">f</span> <span class="id">a</span> + (<span class="id">f</span> <span class="id">t</span> - <span class="id">f</span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>;[<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>, (<span class="id">Pd2</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">t</span> - <span class="id">a</span>) &lt; <span class="id">delta2</span>); <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left1">Rabs_left1</a></span>;[ |<span class="tactic">intuition</span> <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span> - <span class="id">y</span>);[<span class="tactic">intuition</span> <span class="id">lra</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id">a</span> - <span class="id">y</span>));[ | <span class="tactic">intuition</span> <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_Ropp">Rabs_Ropp</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_minus_distr">Ropp_minus_distr</a></span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> (<span class="id">pos_div_2</span> <span class="id">eps</span>)) <span class="kwd">with</span> (<span class="id">ep2</span> * <span class="id">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id">a</span> - <span class="id">y</span>));[|<span class="tactic">intuition</span> <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>;[<span class="tactic">unfold</span> <span class="id">M</span>  |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">assert</span> (<span class="id">t</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> (<span class="id">f</span> <span class="id">a</span>)); <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_Ropp">Rabs_Ropp</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_minus_distr">Ropp_minus_distr</a></span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">field</span>; <span class="tactic">unfold</span> <span class="id">M</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">assert</span> (<span class="id">t</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> (<span class="id">f</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">lra</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">with</span> (<span class="id">pos_div_2</span> <span class="id">eps</span> + <span class="id">pos_div_2</span> <span class="id">eps</span>) <span class="tactic">by</span> (<span class="tactic">simpl</span>; <span class="id">field</span>).<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">a</span>); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> - <span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">a</span>) &lt; <span class="id">pos_div_2</span> <span class="id">eps</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">a</span>) <span class="kwd">with</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span> + <span class="id">RInt</span> <span class="id">f</span> <span class="id">y</span> <span class="id">a</span>); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">RInt_Chasles</span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">ex_RInt_Chasles_1</span> <span class="id">f</span> <span class="id">_</span> <span class="id">_</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> <span class="id">m</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>| <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>; <span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id">cmp</span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">exists</span> <span class="id">fxa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">exrint_close</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> ?<span class="id">v</span> &lt; <span class="id">_</span> =&gt; <span class="tactic">replace</span> <span class="id">v</span> <span class="kwd">with</span> (-<span class="id">RInt</span> <span class="id">f</span> <span class="id">y</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="tactic">ring</span> <span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_Ropp">Rabs_Ropp</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_unique</span> <span class="id">f</span> <span class="id">x</span> <span class="id">a</span> <span class="id">fxa</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_RInt_gen_cut">ex_RInt_gen_cut</a></span> (<span class="id">a</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">F</span> <span class="id">G</span>: (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;{<span class="id">FF</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>} {<span class="id">FG</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>} (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) -&gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt; <span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#a">a</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1247')">Proof.</div>
<div class="proofscript" id="proof1247">
<span class="tactic">intros</span> <span class="id">lFa</span> <span class="id">laG</span> [<span class="id">vfg</span> <span class="id">Pvfg</span>].<br/>
<span class="tactic">assert</span> (<span class="id">lFG</span> := <span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt_trans">filter_Rlt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">lFa</span> <span class="id">laG</span>).<br/>
<span class="tactic">set</span> (<span class="id">v</span> := <span class="id">R_complete_lim</span> (<span class="id">filtermap</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) <span class="id">G</span>)).<br/>
<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">intros</span> <span class="id">P</span> <span class="id">PP2</span>.<br/>
<span class="tactic">destruct</span> <span class="id">laG</span> <span class="kwd">as</span> [<span class="id">m</span> [<span class="id">S1</span> <span class="id">S2</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">laG</span>]]; <span class="id">cbn</span> <span class="kwd">in</span> <span class="id">laG</span>.<br/>
<span class="tactic">destruct</span> <span class="id">lFa</span> <span class="kwd">as</span> [<span class="id">m</span>' [<span class="id">S5</span> <span class="id">S6</span> <span class="id">p5</span> <span class="id">p6</span> <span class="id">lFa</span>]]; <span class="id">cbn</span> <span class="kwd">in</span> <span class="id">lFa</span>.<br/>
<span class="tactic">assert</span> (<span class="id">S6</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id">p6</span>.<br/>
<span class="tactic">assert</span> (<span class="id">S1</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id">p1</span>.<br/>
<span class="tactic">assert</span> (<span class="id">t</span>': <span class="kwd">forall</span> <span class="id">eps</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id">exists</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">filtermap</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) <span class="id">G</span> (<span class="id">ball</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#eps">eps</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eps</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Pvfg</span> (<span class="id">ball</span> <span class="id">vfg</span> (<span class="id">pos_div_2</span> <span class="id">eps</span>)) (<span class="id">locally_ball</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Pvfg</span> <span class="kwd">as</span> [<span class="id">S7</span> <span class="id">S8</span> <span class="id">p7</span> <span class="id">p8</span> <span class="id">vfg</span>'].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">filter_ex</span> (<span class="id">F</span> := <span class="id">G</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">S8</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> /\ <span class="id">S2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>)) <span class="kwd">as</span> [<span class="id">y</span> <span class="id">Py</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>); <span class="tactic">destruct</span> (<span class="id">filter_ex</span> (<span class="id">F</span> := <span class="id">F</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">S7</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">S5</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>)) <span class="kwd">as</span> [<span class="id">x</span> <span class="id">Px</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">filtermap</span>; <span class="tactic">apply</span> (<span class="id">filter_imp</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">S8</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> /\ <span class="id">S2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">z</span> <span class="id">PZ</span>; <span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">z</span> - <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>) &lt; <span class="id">eps</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">z</span> - <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">a</span> + <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">z</span>) - (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">a</span> + <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">vfg</span>' <span class="id">x</span> <span class="id">y</span>) <span class="kwd">as</span> [<span class="id">xy</span> <span class="id">pxy</span>]; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">vfg</span>' <span class="id">x</span> <span class="id">z</span>) <span class="kwd">as</span> [<span class="id">xz</span> <span class="id">pxz</span>]; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>) <span class="tactic">by</span> (<span class="id">exists</span> <span class="id">xy</span>; <span class="tactic">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">z</span>) <span class="tactic">by</span> (<span class="id">exists</span> <span class="id">xz</span>; <span class="tactic">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">x</span> &lt; <span class="id">a</span>) <span class="tactic">by</span> (<span class="tactic">destruct</span> (<span class="id">lFa</span> <span class="id">x</span> <span class="id">a</span>); <span class="tactic">intuition</span> <span class="id">lra</span> || <span class="tactic">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">a</span> &lt; <span class="id">y</span>) <span class="tactic">by</span> (<span class="tactic">destruct</span> (<span class="id">laG</span> <span class="id">a</span> <span class="id">y</span>); <span class="tactic">intuition</span> <span class="id">lra</span> || <span class="tactic">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">a</span> &lt; <span class="id">z</span>) <span class="tactic">by</span> (<span class="tactic">destruct</span> (<span class="id">laG</span> <span class="id">a</span> <span class="id">z</span>); <span class="tactic">intuition</span> <span class="id">lra</span> || <span class="tactic">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ex_RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">ex_RInt_Chasles_1</span> <span class="id">f</span> <span class="id">x</span> <span class="id">a</span> <span class="id">y</span>);[<span class="tactic">intuition</span> <span class="id">lra</span> | <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> -&gt; !(<span class="id">RInt_Chasles</span> <span class="id">f</span>); <span class="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">apply</span> (<span class="id">ex_RInt_Chasles_2</span> <span class="id">f</span> <span class="id">x</span>); <span class="tactic">auto</span>; <span class="tactic">intuition</span> <span class="id">lra</span>); <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id">ball</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>) <span class="id">eps</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">z</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">with</span> (<span class="id">pos_div_2</span> <span class="id">eps</span> + <span class="id">pos_div_2</span> <span class="id">eps</span>) <span class="tactic">by</span> (<span class="tactic">simpl</span>; <span class="id">field</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">y</span>) <span class="kwd">with</span> <span class="id">xy</span> <span class="tactic">by</span> (<span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id">is_RInt_unique</span>; <span class="tactic">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">x</span> <span class="id">z</span>) <span class="kwd">with</span> <span class="id">xz</span> <span class="tactic">by</span> (<span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id">is_RInt_unique</span>; <span class="tactic">tauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id">ball_triangle</span> <span class="id">_</span> <span class="id">vfg</span>); [<span class="tactic">apply</span> <span class="id">ball_sym</span> | ]; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">tauto</span>.<br/>
<span class="tactic">destruct</span> <span class="id">PP2</span> <span class="kwd">as</span> [<span class="id">eps</span> <span class="id">Peps</span>].<br/>
<span class="tactic">assert</span> (<span class="id">t</span> := (<span class="id">R_complete</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">filtermap</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) <span class="id">G</span>) <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span>' <span class="id">eps</span>)).<br/>
<span class="tactic">unfold</span> <span class="id">filtermap</span>, <span class="id">filtermapi</span> <span class="kwd">in</span> <span class="id">t</span> |- *.<br/>
<span class="tactic">assert</span> (<span class="id">atpa</span> : <span class="id">at_point</span> <span class="id">a</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id">a</span>)) <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="id">enough</span> (<span class="id">H1</span> : <span class="id">exists</span> <span class="id">S4</span>, <span class="id">G</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#S4">S4</a></span> /\ <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.utils.improper_integrals.html#S4">S4</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> -&gt; <span class="id">is_RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">S4</span> [<span class="id">gs4</span> <span class="id">Ps4</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Filter_prod</span> (<span class="id">at_point</span> <span class="id">a</span>) <span class="id">G</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id">a</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">ball</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R_complete_lim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">P</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="kwd">Prop</span> =&gt; <span class="id">G</span> (<span class="kwd">fun</span> <span class="id">x0</span> =&gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#P">P</a></span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x0">x0</a></span>)))) <span class="id">eps</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) /\ <span class="id">S4</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) <span class="id">atpa</span> (<span class="id">filter_and</span> <span class="id">_</span> <span class="id">_</span> <span class="id">t</span> <span class="id">gs4</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> &lt;- <span class="id">dist</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">exists</span> (<span class="id">RInt</span> <span class="id">f</span> <span class="id">a</span> <span class="id">y</span>);<span class="tactic">split</span>;[<span class="tactic">apply</span> <span class="id">Ps4</span>; <span class="tactic">tauto</span>| <span class="tactic">apply</span> <span class="id">Peps</span>; <span class="tactic">tauto</span>].<br/>
<span class="tactic">destruct</span> (<span class="id">Pvfg</span> (<span class="id">ball</span> <span class="id">vfg</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>))) <span class="kwd">as</span> [<span class="id">S3</span> <span class="id">S4</span> <span class="id">fs3</span> <span class="id">gs4</span> <span class="id">Ps4</span>].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">locally_ball</span>.<br/>
<span class="tactic">assert</span> (<span class="id">F</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rgt">Rgt</a></span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">filter_imp</span> <span class="id">S5</span>); [<span class="tactic">intros</span> <span class="id">x</span> <span class="id">s5x</span> | <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">s6a</span> : <span class="id">S6</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id">p6</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">lFa</span> <span class="id">x</span> <span class="id">a</span> <span class="id">s5x</span> <span class="id">s6a</span>); <span class="id">lra</span>.<br/>
<span class="tactic">destruct</span> (<span class="id">filter_ex</span> (<span class="id">F</span> := <span class="id">F</span>) (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">a</span> &gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">S3</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>)) <span class="kwd">as</span> [<span class="id">w</span> <span class="id">Pw</span>];<br/>
&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">auto</span> | ].<br/>
<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">S4</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> /\ <span class="id">a</span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>); <span class="tactic">split</span>;[ | <span class="tactic">intros</span> <span class="id">x</span> <span class="id">px</span>; <span class="tactic">apply</span> (<span class="id">RInt_correct</span> <span class="id">f</span>)].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filter_and</span>;[<span class="tactic">assumption</span> | <span class="tactic">apply</span> (<span class="id">filter_imp</span> <span class="id">S2</span>);[<span class="tactic">intros</span> <span class="id">x</span> <span class="id">s2x</span> | <span class="id">easy</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">s1a</span> : <span class="id">S1</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id">p1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">laG</span> <span class="id">a</span> <span class="id">x</span> <span class="id">s1a</span> <span class="id">s2x</span>); <span class="id">lra</span>.<br/>
<span class="tactic">apply</span> <span class="id">ex_RInt_Chasles_2</span> <span class="kwd">with</span> <span class="id">w</span>;[<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>; <span class="tactic">tauto</span> | ].<br/>
<span class="tactic">destruct</span> (<span class="id">Ps4</span> <span class="id">w</span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">wx</span> [<span class="id">Pwx</span> <span class="id">closewx</span>]]; <span class="tactic">try</span> <span class="tactic">tauto</span>; <span class="id">exists</span> <span class="id">wx</span>; <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="id">Mode</span> <span class="id">ProperFilter</span>' - + : <span class="id">typeclass_instances</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="filter_prod_le">filter_prod_le</a></span> {<span class="id">T</span> : <span class="kwd">Type</span>} (<span class="id">F</span> <span class="id">G</span> <span class="id">F</span>' <span class="id">G</span>' : (<span class="id"><a href="CertRL.utils.improper_integrals.html#T">T</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) :<br/>
&nbsp;&nbsp;<span class="id">filter_le</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id">F</span>' -&gt; <span class="id">filter_le</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> <span class="id">G</span>' -&gt; <span class="id">filter_le</span> (<span class="id">filter_prod</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">filter_prod</span> <span class="id">F</span>' <span class="id">G</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1248')">Proof.</div>
<div class="proofscript" id="proof1248">
  <span class="id">now</span> <span class="tactic">intros</span> <span class="id">FF</span> <span class="id">GG</span> <span class="id">S</span> [<span class="id">S1</span> <span class="id">S2</span> <span class="id">FS</span> <span class="id">GS</span> <span class="id">Imp</span>]; <span class="id">exists</span> <span class="id">S1</span> <span class="id">S2</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_filter_le">is_RInt_gen_filter_le</a></span> {<span class="id">T</span> : <span class="id">NormedModule</span> <span class="id">R_AbsRing</span>}<br/>
&nbsp;&nbsp;<span class="id">F</span> <span class="id">G</span> <span class="id">F</span>' <span class="id">G</span>' {<span class="id">FF</span> : <span class="id">Filter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>} {<span class="id">FG</span> : <span class="id">Filter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>}<br/>
&nbsp;&nbsp;{<span class="id">FF</span>' : <span class="id">Filter</span> <span class="id">F</span>'} {<span class="id">FG</span>' : <span class="id">Filter</span> <span class="id">G</span>'} (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#T">T</a></span>) <span class="id">v</span> :<br/>
&nbsp;&nbsp;<span class="id">filter_le</span> <span class="id">F</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> -&gt; <span class="id">filter_le</span> <span class="id">G</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt; <span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id">F</span>' <span class="id">G</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1249')">Proof.</div>
<div class="proofscript" id="proof1249">
<span class="tactic">intros</span> <span class="id">lef</span> <span class="id">leg</span> <span class="id">intf</span> <span class="id">P</span> <span class="id">PP</span>; <span class="tactic">unfold</span> <span class="id">filtermapi</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_prod_le">filter_prod_le</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">lef</span> <span class="id">leg</span>), <span class="id">intf</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_comp">is_RInt_gen_comp</a></span> {<span class="id">Fa</span> <span class="id">Fb</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>} {<span class="id">FFa</span> : <span class="id">Filter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span>}<br/>
&nbsp;&nbsp;{<span class="id">FFb</span> : <span class="id">Filter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span>} (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">dg</span> <span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">l</span> :<br/>
&nbsp;&nbsp;<span class="id">filter_prod</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">continuous</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#dg">dg</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>) /\ <span class="id">continuous</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#dg">dg</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id">filtermap</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span>) (<span class="id">filtermap</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">scal</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#dg">dg</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) (<span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>))) <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1250')">Proof.</div>
<div class="proofscript" id="proof1250">
<span class="tactic">intros</span> <span class="id">dp</span> <span class="id">intf</span> <span class="id">P</span> <span class="id">PP</span>.<br/>
<span class="tactic">destruct</span> <span class="id">dp</span> <span class="kwd">as</span> [<span class="id">S1</span> <span class="id">S2</span> <span class="id">FS1</span> <span class="id">FS2</span> <span class="id">dp</span>].<br/>
<span class="tactic">destruct</span> (<span class="id">intf</span> <span class="id">P</span> <span class="id">PP</span>) <span class="kwd">as</span> [<span class="id">S</span> <span class="id">S</span>' <span class="id">FS</span> <span class="id">FS</span>' <span class="id">fp1</span>].<br/>
<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">S</span> (<span class="id">g</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) /\ <span class="id">S1</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">S</span>' (<span class="id">g</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) /\ <span class="id">S2</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id">filter_and</span>; <span class="tactic">auto</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> [<span class="id">sgx</span> <span class="id">s1x</span>] [<span class="id">sgy</span> <span class="id">s2y</span>]; <span class="tactic">simpl</span>.<br/>
<span class="id">exists</span> (<span class="id">RInt</span> <span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>) (<span class="id">g</span> <span class="id">y</span>)); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">fp1</span> (<span class="id">g</span> <span class="id">x</span>) (<span class="id">g</span> <span class="id">y</span>)); <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_RInt_comp</span> <span class="id">f</span> <span class="id">g</span> <span class="id">dg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">z</span> <span class="id">zcond</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id">dp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">s1x</span> <span class="id">s2y</span> <span class="id">z</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">z</span> <span class="id">zcond</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id">dp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">s1x</span> <span class="id">s2y</span> <span class="id">z</span>); <span class="tactic">auto</span>.<br/>
<span class="tactic">destruct</span> (<span class="id">fp1</span> (<span class="id">g</span> <span class="id">x</span>) (<span class="id">g</span> <span class="id">y</span>) <span class="id">sgx</span> <span class="id">sgy</span>) <span class="kwd">as</span> [<span class="id">v</span> [<span class="id">isint</span> <span class="id">Pv</span>]]; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">isint</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">isint</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_equiv">is_RInt_gen_equiv</a></span> <span class="id">F</span> <span class="id">G</span> <span class="id">F</span>' <span class="id">G</span>' (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">v</span>:<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#s">s</a></span> &lt;-&gt; <span class="id">F</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#s">s</a></span>) -&gt; (<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#s">s</a></span> &lt;-&gt; <span class="id">G</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#s">s</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#v">v</a></span> -&gt; <span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id">F</span>' <span class="id">G</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1251')">Proof.</div>
<div class="proofscript" id="proof1251">
<span class="tactic">intros</span> <span class="id">eqF</span> <span class="id">eqG</span> <span class="id">intf</span> <span class="id">P</span> <span class="id">PP</span>'; <span class="tactic">unfold</span> <span class="id">filtermapi</span>.<br/>
<span class="tactic">assert</span> (<span class="id">tmp</span> := <span class="id"><a href="CertRL.utils.improper_integrals.html#filter_prod_le">filter_prod_le</a></span> <span class="id">F</span>' <span class="id">G</span>' <span class="id">F</span> <span class="id">G</span>); <span class="tactic">unfold</span> <span class="id">filter_le</span> <span class="kwd">in</span> <span class="id">tmp</span>; <span class="tactic">apply</span> <span class="id">tmp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">A</span>; <span class="tactic">rewrite</span> <span class="id">eqF</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">A</span>; <span class="tactic">rewrite</span> <span class="id">eqG</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> (<span class="id">intf</span> <span class="id">P</span> <span class="id">PP</span>').<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_RInt_gen_unique">ex_RInt_gen_unique</a></span><br/>
&nbsp;&nbsp;(<span class="id">F</span> <span class="id">G</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) {<span class="id">FF</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>}<br/>
&nbsp;&nbsp;{<span class="id">FG</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>} (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt; <span class="id">exists</span> ! <span class="id">v</span>, <span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1252')">Proof.</div>
<div class="proofscript" id="proof1252">
<span class="tactic">intros</span> [<span class="id">v</span> <span class="id">Pv</span>]; <span class="id">exists</span> (<span class="id">RInt_gen</span> <span class="id">f</span> <span class="id">F</span> <span class="id">G</span>); <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#unique">unique</a></span>.<br/>
<span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_gen_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Pv</span>) <span class="tactic">at</span> 1; <span class="tactic">split</span>;[<span class="tactic">assumption</span> | ].<br/>
<span class="id">now</span> <span class="tactic">intros</span> <span class="id">v</span>' <span class="id">Pv</span>'; <span class="tactic">rewrite</span> -&gt; (<span class="id">is_RInt_gen_unique</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Pv</span>').<br/>
Qed.</div>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_RInt_gen_Rle0">is_RInt_gen_Rle0</a></span> (<span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">gl</span> <span class="id">F</span> <span class="id">G</span><br/>
&nbsp;&nbsp;{<span class="id">PF</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>} {<span class="id">PG</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>} :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#gl">gl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">filter_prod</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">p</span> =&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span> -&gt; 0 &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#gl">gl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1253')">Proof.</div>
<div class="proofscript" id="proof1253">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#is_RInt_gen_Rle">is_RInt_gen_Rle</a></span> <span class="kwd">with</span> (<span class="id">g</span> := <span class="id">g</span>) (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; 0) (<span class="id">F</span> := <span class="id">F</span>) (<span class="id">G</span> := <span class="id">G</span>).<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">is_RInt_gen_ext</span> (<span class="id">Derive</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filter_forall</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Derive_const</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (0) <span class="kwd">with</span> (0 - 0) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_RInt_gen_Derive</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filter_forall</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ex_derive_const</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filter_forall</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">continuous_ext</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; 0)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Derive_const</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">continuous_const</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filterlim_const</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filterlim_const</span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="RInt_gen_Rle0">RInt_gen_Rle0</a></span> (<span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) <span class="id">F</span> <span class="id">G</span><br/>
&nbsp;&nbsp;{<span class="id">PF</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span>} {<span class="id">PG</span> : <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>} :<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.utils.improper_integrals.html#filter_Rlt">filter_Rlt</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">filter_prod</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">p</span> =&gt; (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span> &lt; <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span> -&gt; 0 &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id">RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#F">F</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#G">G</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1254')">Proof.</div>
<div class="proofscript" id="proof1254">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ex_RInt_gen</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">RInt_gen</span> <span class="id">g</span> <span class="id">F</span> <span class="id">G</span>) <span class="kwd">with</span> (<span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#is_RInt_gen_Rle0">is_RInt_gen_Rle0</a></span> <span class="kwd">with</span> (<span class="id">g</span> := <span class="id">g</span>) (<span class="id">F</span> := <span class="id">F</span>) (<span class="id">G</span> := <span class="id">G</span>).<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_RInt_gen_unique</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="RInt_gen_comp">RInt_gen_comp</a></span> {<span class="id">Fa</span> <span class="id">Fb</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>} {<span class="id">FFa</span> : <span class="id">ProperFilter</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span>}<br/>
&nbsp;&nbsp;{<span class="id">FFb</span> : <span class="id">ProperFilter</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span>} (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">dg</span> <span class="id">g</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">filter_prod</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">y</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) &lt;= <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmax">Rmax</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#p">p</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">continuous</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#dg">dg</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>) /\ <span class="id">continuous</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#dg">dg</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id">filtermap</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span>) (<span class="id">filtermap</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id">filtermap</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span>) (<span class="id">filtermap</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span>) =<br/>
&nbsp;&nbsp;<span class="id">RInt_gen</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">scal</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#dg">dg</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>) (<span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#g">g</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#x">x</a></span>))) <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1255')">Proof.</div>
<div class="proofscript" id="proof1255">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">l</span> <span class="id">lpf</span>].<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#is_RInt_gen_comp">is_RInt_gen_comp</a></span> <span class="id">f</span> <span class="id">dg</span> <span class="id">g</span> <span class="id">l</span> <span class="id">H</span> <span class="id">lpf</span>); <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">is_RInt_gen_unique</span>) <span class="kwd">in</span> <span class="id">HH</span><br/>
&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">is_RInt_gen_unique</span>) <span class="kwd">in</span> <span class="id">lpf</span><br/>
&nbsp;&nbsp;; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">filtermap_proper_filter</span>'.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">filtermap_proper_filter</span>'.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="RInt_gen_scal">RInt_gen_scal</a></span> {<span class="id">Fa</span> <span class="id">Fb</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>}<br/>
&nbsp;&nbsp;{<span class="id">FFa</span> : <span class="id">ProperFilter</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span>} {<span class="id">FFb</span> : <span class="id">ProperFilter</span>' <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span>} (<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">k</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">RInt_gen</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">scal</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#k">k</a></span> (<span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#y">y</a></span>)) <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span>  = <span class="id">scal</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#k">k</a></span> (<span class="id">RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fb">Fb</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1256')">Proof.</div>
<div class="proofscript" id="proof1256">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">is_RInt_gen_unique</span>).<br/>
&nbsp;&nbsp;<span class="id">easy</span>.<br/>
&nbsp;&nbsp;<span class="id">easy</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (@<span class="id">is_RInt_gen_scal</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filter_filter</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filter_filter</span>'.  <br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">RInt_gen_correct</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="integrals_over_V">integrals_over_V</a></span>.<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Context</span> {<span class="id">V</span> : <span class="id">NormedModule</span> <span class="id">R_AbsRing</span>}.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ex_RInt_gen_Chasles">ex_RInt_gen_Chasles</a></span> {<span class="id">Fa</span> <span class="id">Fc</span> : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>}<br/>
&nbsp;&nbsp;{<span class="id">FFa</span> : <span class="id">Filter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span>} {<span class="id">FFc</span> : <span class="id">Filter</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fc">Fc</a></span>}<br/>
&nbsp;&nbsp;(<span class="id">f</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="CertRL.utils.improper_integrals.html#integrals_over_V.V">V</a></span>) (<span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :<br/>
&nbsp;&nbsp;<span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>) -&gt; <span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> (<span class="id">at_point</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#b">b</a></span>) <span class="id"><a href="CertRL.utils.improper_integrals.html#Fc">Fc</a></span><br/>
&nbsp;&nbsp;-&gt; <span class="id">ex_RInt_gen</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#f">f</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fa">Fa</a></span> <span class="id"><a href="CertRL.utils.improper_integrals.html#Fc">Fc</a></span> .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1257')">Proof.</div>
<div class="proofscript" id="proof1257">
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">l1</span> <span class="id">H1</span>] [<span class="id">l2</span> <span class="id">H2</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">plus</span> <span class="id">l1</span> <span class="id">l2</span>).  <br/>
&nbsp;&nbsp;<span class="tactic">by</span> <span class="tactic">apply</span> <span class="id">is_RInt_gen_Chasles</span> <span class="kwd">with</span> <span class="id">b</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.utils.improper_integrals.html#integrals_over_V">integrals_over_V</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
