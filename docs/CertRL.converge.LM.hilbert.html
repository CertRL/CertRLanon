
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CertRL.converge.LM.hilbert</title>
<meta name="description" content="Documentation of Coq module CertRL.converge.LM.hilbert" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CertRL.converge.LM.hilbert</h1>
<div class="coq">
<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="CertRL.converge.LM.linear_map.html">linear_map</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="CertRL.converge.LM.R_compl.html">R_compl</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">mathcomp.ssreflect.ssreflect</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html">FunctionalExtensionality</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Decidable.html">Decidable</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="CertRL.converge.LM.logic_tricks.html">logic_tricks</a></span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id"><a name="prop_extensionality">prop_extensionality</a></span> : <span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span>:<span class="kwd">Prop</span>, (<span class="id"><a href="CertRL.converge.LM.hilbert.html#A">A</a></span> &lt;-&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#B">B</a></span>) -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#A">A</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#B">B</a></span>.<br/>
<br/>
<div class="doc">Complete subsets </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="CompleteSubset">CompleteSubset</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id">NormedModule</span> <span class="id">R_AbsRing</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="complete_subset">complete_subset</a></span> (<span class="id">phi</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#CompleteSubset.E">E</a></span>-&gt;<span class="kwd">Prop</span>) :=<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">lime</span> : ((<span class="id"><a href="CertRL.converge.LM.hilbert.html#CompleteSubset.E">E</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#CompleteSubset.E">E</a></span>),<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">F</span>, <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span> -&gt; <span class="id">cauchy</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">P</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#P">P</a></span> -&gt; ~~(<span class="id">exists</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#P">P</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#phi">phi</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#lime">lime</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">eps</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span> (<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#lime">lime</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>)).<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#CompleteSubset">CompleteSubset</a></span>.<br/>
<br/>
<h1> PreHilbert spaces </h1>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="PreHilbert">PreHilbert</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="PreHilbert.mixin_of">mixin_of</a></span> (<span class="id">E</span> : <span class="id">ModuleSpace</span> <span class="id">R_Ring</span>) := <span class="id"><a name="PreHilbert.Mixin">Mixin</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.inner">inner</a></span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax1">ax1</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax2">ax2</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span>), 0 &lt;= <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax3">ax3</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> = 0 -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> = <span class="id">zero</span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax4">ax4</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.ax5">ax5</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">plus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span><br/>
}.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PreHilbert.ClassDef">ClassDef</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="PreHilbert.class_of">class_of</a></span> (<span class="id">T</span> : <span class="kwd">Type</span>) := <span class="kwd">Class</span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.base">base</a></span> : <span class="id">ModuleSpace.class_of</span> <span class="id">R_Ring</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#T">T</a></span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="PreHilbert.mixin">mixin</a></span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.mixin_of">mixin_of</a></span> (<span class="id">ModuleSpace.Pack</span> <span class="id">R_Ring</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#T">T</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#base">base</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#T">T</a></span>)<br/>
}.<br/>
<span class="kwd">Local</span> <span class="kwd">Coercion</span> <span class="id">base</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">ModuleSpace.class_of</span>.<br/>
<br/>
<span class="kwd">Structure</span> <span class="id"><a name="PreHilbert.type">type</a></span> := <span class="id"><a name="PreHilbert.Pack">Pack</a></span> { <span class="id"><a name="PreHilbert.sort">sort</a></span>; <span class="id">_</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.class_of">class_of</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#sort">sort</a></span> ; <span class="id">_</span> : <span class="kwd">Type</span> }.<br/>
<span class="kwd">Local</span> <span class="kwd">Coercion</span> <span class="id">sort</span> : <span class="id">type</span> &gt;-&gt; <span class="id">Sortclass</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PreHilbert.ClassDef.cT">cT</a></span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.type">type</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert.class">class</a></span> := <span class="kwd">let</span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.Pack">Pack</a></span> <span class="id">_</span> <span class="id">c</span> <span class="id">_</span> := <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.ClassDef.cT">cT</a></span> <span class="kwd">return</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.class_of">class_of</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#cT">cT</a></span> <span class="kwd">in</span> <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PreHilbert.ClassDef.xT">xT</a></span> := <span class="kwd">let</span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.Pack">Pack</a></span> <span class="id">T</span> <span class="id">_</span> <span class="id">_</span> := <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.ClassDef.cT">cT</a></span> <span class="kwd">in</span> <span class="id">T</span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="PreHilbert.xclass">xclass</a></span> := (<span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.class">class</a></span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.class_of">class_of</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.ClassDef.xT">xT</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert.AbelianGroup">AbelianGroup</a></span> := <span class="id">AbelianGroup.Pack</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.xclass">xclass</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.ClassDef.xT">xT</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert.ModuleSpace">ModuleSpace</a></span> := <span class="id">ModuleSpace.Pack</span> <span class="id">_</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.xclass">xclass</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.ClassDef.xT">xT</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.ClassDef">ClassDef</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="PreHilbert.Exports">Exports</a></span>.<br/>
<br/>
<span class="kwd">Coercion</span> <span class="id">base</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">ModuleSpace.class_of</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">mixin</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">mixin_of</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">sort</span> : <span class="id">type</span> &gt;-&gt; <span class="id">Sortclass</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">AbelianGroup</span> : <span class="id">type</span> &gt;-&gt; <span class="id">AbelianGroup.type</span>.<br/>
<span class="id">Canonical</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.AbelianGroup">AbelianGroup</a></span>.<br/>
<span class="kwd">Coercion</span> <span class="id">ModuleSpace</span> : <span class="id">type</span> &gt;-&gt; <span class="id">ModuleSpace.type</span>.<br/>
<span class="id">Canonical</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.ModuleSpace">ModuleSpace</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> <span class="id"><a name="PreHilbert.Exports.PreHilbert">PreHilbert</a></span> := <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.type">type</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.Exports">Exports</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert">PreHilbert</a></span>.<br/>
<br/>
<span class="kwd">Export</span> <span class="id">PreHilbert.Exports</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="AboutPreHilbert">AboutPreHilbert</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="inner">inner</a></span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert.E">E</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert.E">E</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> := <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">PreHilbert.inner</a></span> <span class="id">_</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#class">PreHilbert.class</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert.E">E</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hnorm">Hnorm</a></span> <span class="id">x</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_is_bilinear_form">inner_is_bilinear_form</a></span>: <span class="id"><a href="CertRL.converge.LM.linear_map.html#is_bilinear_mapping">is_bilinear_mapping</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1143')">Proof.</div>
<div class="proofscript" id="proof1143">
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax4">PreHilbert.ax4</a></span>.<br/>
<span class="tactic">split</span>.<br/>
&nbsp;+ <span class="tactic">intros</span> <span class="id">x0</span> <span class="id">y0</span> <span class="id">l0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">x0</span> (<span class="id">scal</span> <span class="id">l0</span> <span class="id">y0</span>)) <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">scal</span> <span class="id">l0</span> <span class="id">y0</span>) <span class="id">x0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">x0</span> <span class="id">y0</span>) <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">y0</span> <span class="id">x0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax4">PreHilbert.ax4</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
+  <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax5">PreHilbert.ax5</a></span>.<br/>
+  <span class="tactic">intros</span> <span class="id">x2</span> <span class="id">y2</span> <span class="id">z0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">x2</span> (<span class="id">plus</span> <span class="id">y2</span> <span class="id">z0</span>)) <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">plus</span> <span class="id">y2</span> <span class="id">z0</span>) <span class="id">x2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">x2</span> <span class="id">y2</span>) <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">y2</span> <span class="id">x2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">x2</span> <span class="id">z0</span>) <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">z0</span> <span class="id">x2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax5">PreHilbert.ax5</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_sym">inner_sym</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,  <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1144')">Proof.</div>
<div class="proofscript" id="proof1144">
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax1">PreHilbert.ax1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_ge_0">inner_ge_0</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, 0 &lt;= <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1145')">Proof.</div>
<div class="proofscript" id="proof1145">
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax2">PreHilbert.ax2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_eq_0">inner_eq_0</a></span> : <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> = 0 -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> = <span class="id">zero</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1146')">Proof.</div>
<div class="proofscript" id="proof1146">
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax3">PreHilbert.ax3</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_ge_0">norm_ge_0</a></span>: <span class="kwd">forall</span> <span class="id">x</span>,  0 &lt;= <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1147')">Proof.</div>
<div class="proofscript" id="proof1147">
<span class="tactic">intros</span> <span class="id">x</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_eq_0">norm_eq_0</a></span>: <span class="kwd">forall</span> <span class="id">x</span>,  <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> = 0 -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> = <span class="id">zero</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1148')">Proof.</div>
<div class="proofscript" id="proof1148">
<span class="tactic">intros</span> <span class="id">x</span>; <span class="tactic">unfold</span> <span class="id">norm</span>; <span class="tactic">intros</span> <span class="id">H</span>.<br/>
<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">x</span> = 0).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_eq_0">sqrt_eq_0</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_ge_0">inner_ge_0</a></span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ax3">PreHilbert.ax3</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_scal_l">inner_scal_l</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> :<span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert.E">E</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1149')">Proof.</div>
<div class="proofscript" id="proof1149">
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax4">PreHilbert.ax4</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_scal_r">inner_scal_r</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> :<span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert.E">E</a></span>) (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) = <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1150')">Proof.</div>
<div class="proofscript" id="proof1150">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">l</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_sym">inner_sym</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_zero_l">inner_zero_l</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">zero</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1151')">Proof.</div>
<div class="proofscript" id="proof1151">
<span class="tactic">intros</span> <span class="id">x</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#trans_eq">trans_eq</a></span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">scal</span> 0 <span class="id">zero</span>) <span class="id">x</span>).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">scal_zero_r</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_zero_r">inner_zero_r</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id">zero</span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1152')">Proof.</div>
<div class="proofscript" id="proof1152">
<span class="tactic">intros</span> <span class="id">x</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_sym">inner_sym</a></span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_plus_l">inner_plus_l</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert.E">E</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">plus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1153')">Proof.</div>
<div class="proofscript" id="proof1153">
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax5">PreHilbert.ax5</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_plus_r">inner_plus_r</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert.E">E</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> (<span class="id">plus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span>) = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1154')">Proof.</div>
<div class="proofscript" id="proof1154">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> 2!(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id">x</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_opp_r">inner_opp_r</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert.E">E</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> (<span class="id">opp</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) = - <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1155')">Proof.</div>
<div class="proofscript" id="proof1155">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="tactic">rewrite</span> - (<span class="id">scal_opp_one</span> <span class="id">y</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">opp</span>, <span class="id">one</span>; <span class="tactic">simpl</span>; <span class="tactic">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="inner_opp_l">inner_opp_l</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert.E">E</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">opp</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> = - <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_sym">inner_sym</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_zero">norm_zero</a></span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">zero</span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1156')">Proof.</div>
<div class="proofscript" id="proof1156">
<span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span>; <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_0">sqrt_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_opp">norm_opp</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">opp</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) = <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1157')">Proof.</div>
<div class="proofscript" id="proof1157">
<span class="tactic">intros</span> <span class="id">x</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span>; <span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">replace</span> (<span class="id">opp</span> <span class="id">x</span>) <span class="kwd">with</span> (<span class="id">scal</span> (<span class="id">opp</span> <span class="id">one</span>) <span class="id">x</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">opp</span>, <span class="id">one</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">ring</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> (<span class="id">scal_opp_one</span> <span class="id">x</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_scal">norm_scal</a></span> : <span class="kwd">forall</span> <span class="id">l</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">l</span> <span class="id">x</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_Rsqr_abs">sqrt_Rsqr_abs</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_mult">sqrt_mult</a></span>.<br/>
2: <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
2: <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_ge_0">inner_ge_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="tactic">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="squared_norm">squared_norm</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1158')">Proof.</div>
<div class="proofscript" id="proof1158">
<span class="tactic">intros</span> <span class="id">x</span>; <span class="tactic">unfold</span> <span class="id">norm</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_sqrt">sqrt_sqrt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_ge_0">inner_ge_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="square_expansion_plus">square_expansion_plus</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">plus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) (<span class="id">plus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> + 2 * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1159')">Proof.</div>
<div class="proofscript" id="proof1159">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> 2!<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_r">inner_plus_r</a></span>.<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_sym">inner_sym</a></span> <span class="id">x</span> <span class="id">y</span>).<br/>
<span class="tactic">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="square_expansion_minus">square_expansion_minus</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> - 2 * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1160')">Proof.</div>
<div class="proofscript" id="proof1160">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> 2!<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_r">inner_plus_r</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_sym">inner_sym</a></span>.<br/>
<span class="tactic">ring</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Equalities and inequalities </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="parallelogram_id">parallelogram_id</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">plus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) (<span class="id">plus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>)) + (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>))<br/>
&nbsp;&nbsp;= 2*((<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) + (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1161')">Proof.</div>
<div class="proofscript" id="proof1161">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#square_expansion_minus">square_expansion_minus</a></span>.<br/>
<span class="tactic">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Cauchy_Schwartz">Cauchy_Schwartz</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) &lt;= <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1162')">Proof.</div>
<div class="proofscript" id="proof1162">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> 4%<span class="id">R</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_le">Rminus_le</a></span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
<span class="tactic">replace</span> (4*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>)) <span class="kwd">with</span> ((2*<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>)*(2*<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">x</span> <span class="id">y</span>)).<br/>
2: <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.R_compl.html#discr_neg">discr_neg</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">l</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">plus</span> (<span class="id">scal</span> <span class="id">l</span> <span class="id">x</span>) <span class="id">y</span>) (<span class="id">plus</span> (<span class="id">scal</span> <span class="id">l</span> <span class="id">x</span>) <span class="id">y</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_ge_0">inner_ge_0</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
<span class="tactic">rewrite</span> 2!<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="id">right</span>; <span class="tactic">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Cauchy_Schwartz_with_norm">Cauchy_Schwartz_with_norm</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) &lt;= <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1163')">Proof.</div>
<div class="proofscript" id="proof1163">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_0_var">Rsqr_incr_0_var</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_abs">Rsqr_abs</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (1:=<span class="id"><a href="CertRL.converge.LM.hilbert.html#Cauchy_Schwartz">Cauchy_Schwartz</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_mult">Rsqr_mult</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">right</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> 2!<span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_triangle">norm_triangle</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">plus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) &lt;= <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1164')">Proof.</div>
<div class="proofscript" id="proof1164">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_0_var">Rsqr_incr_0_var</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- 2!<span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span> + 2 * (<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">x</span>*<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">y</span>) + <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">y</span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id">y</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#RRle_abs">RRle_abs</a></span> <span class="id">_</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Cauchy_Schwartz_with_norm">Cauchy_Schwartz_with_norm</a></span>.<br/>
<span class="id">right</span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#AboutPreHilbert">AboutPreHilbert</a></span>.<br/>
<br/>
<div class="doc">PreHilbert is NormedModule </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PreHNormedModule">PreHNormedModule</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ball">ball</a></span> := <span class="kwd">fun</span> (<span class="id">x</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>) <span class="id">eps</span> <span class="id">y</span> =&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>) &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ball_center">ball_center</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">e</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#e">e</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1165')">Proof.</div>
<div class="proofscript" id="proof1165">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">z</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span>, <span class="id">minus</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_zero">norm_zero</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ball_sym">ball_sym</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">e</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#e">e</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#e">e</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1166')">Proof.</div>
<div class="proofscript" id="proof1166">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">e</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span>; <span class="tactic">intros</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">H</span>); <span class="id">right</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_opp">norm_opp</a></span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>; <span class="tactic">rewrite</span> <span class="id">opp_plus</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">plus_comm</span> <span class="id">opp_opp</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ball_triangle">ball_triangle</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">e1</span> <span class="id">e2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#e1">e1</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#e2">e2</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#e1">e1</a></span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#e2">e2</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#z">z</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1167')">Proof.</div>
<div class="proofscript" id="proof1167">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">e1</span> <span class="id">e2</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span>; <span class="tactic">intros</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="tactic">replace</span> (<span class="id">minus</span> <span class="id">x</span> <span class="id">z</span>) <span class="kwd">with</span> (<span class="id">plus</span> (<span class="id">minus</span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">minus</span> <span class="id">y</span> <span class="id">z</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1:=<span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_triangle">norm_triangle</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_compat">Rplus_lt_compat</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>; <span class="tactic">rewrite</span> <span class="id">plus_assoc</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#f_equal2">f_equal2</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">plus_assoc</span>, <span class="id">plus_opp_l</span>.<br/>
<span class="tactic">apply</span> <span class="id">plus_zero_r</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert_UniformSpace_mixin">PreHilbert_UniformSpace_mixin</a></span> :=<br/>
&nbsp;&nbsp;<span class="id">UniformSpace.Mixin</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball_center">ball_center</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball_sym">ball_sym</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball_triangle">ball_triangle</a></span>.<br/>
<br/>
<span class="id">Canonical</span> <span class="id"><a name="PreHilbert_UniformSpace">PreHilbert_UniformSpace</a></span> :=<br/>
&nbsp;&nbsp;<span class="id">UniformSpace.Pack</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert_UniformSpace_mixin">PreHilbert_UniformSpace_mixin</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>.<br/>
<br/>
<span class="id">Canonical</span> <span class="id"><a name="PreHilbert_NormedModuleAux">PreHilbert_NormedModuleAux</a></span> :=<br/>
&nbsp;&nbsp;<span class="id">NormedModuleAux.Pack</span> <span class="id">R_AbsRing</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">NormedModuleAux.Class</span> <span class="id">R_AbsRing</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ModuleSpace.class</span> <span class="id">_</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ModuleSpace">PreHilbert.ModuleSpace</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert_UniformSpace_mixin">PreHilbert_UniformSpace_mixin</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_ball1">norm_ball1</a></span> : <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">eps</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span> -&gt; <span class="id">Hierarchy.ball</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1168')">Proof.</div>
<div class="proofscript" id="proof1168">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">eps</span> <span class="id">H</span>.<br/>
<span class="tactic">unfold</span> <span class="id">Hierarchy.ball</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball_sym">ball_sym</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_ball2">norm_ball2</a></span>: <span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>) (<span class="id">eps</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hierarchy.ball</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) &lt; 1 * <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1169')">Proof.</div>
<div class="proofscript" id="proof1169">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">eps</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">Hierarchy.ball</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">intros</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball_sym">ball_sym</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="tactic">exact</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="norm_scal_aux">norm_scal_aux</a></span>:<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">l</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">x</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) &lt;= <span class="id">abs</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#l">l</a></span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1170')">Proof.</div>
<div class="proofscript" id="proof1170">
<span class="tactic">intros</span> <span class="id">l</span> <span class="id">r</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_scal">norm_scal</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="PreHilbert_NormedModule_mixin">PreHilbert_NormedModule_mixin</a></span> :=<br/>
&nbsp;&nbsp;<span class="id">NormedModule.Mixin</span> <span class="id">R_AbsRing</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> 1%<span class="id">R</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_triangle">norm_triangle</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_scal_aux">norm_scal_aux</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ball1">norm_ball1</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ball2">norm_ball2</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_eq_0">norm_eq_0</a></span>.<br/>
<br/>
<span class="id">Canonical</span> <span class="id"><a name="PreHilbert_NormedModule">PreHilbert_NormedModule</a></span> :=<br/>
&nbsp;&nbsp;<span class="id">NormedModule.Pack</span> <span class="id">R_AbsRing</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NormedModule.Class</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert_NormedModule_mixin">PreHilbert_NormedModule_mixin</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule.E">E</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHNormedModule">PreHNormedModule</a></span>.<br/>
<h1> Hilbert spaces </h1>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Hilbert">Hilbert</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="Hilbert.mixin_of">mixin_of</a></span> (<span class="id">E</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.Exports.PreHilbert">PreHilbert</a></span>) := <span class="id"><a name="Hilbert.Mixin">Mixin</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="Hilbert.lim">lim</a></span> : ((<span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="Hilbert.ax1">ax1</a></span> : <span class="kwd">forall</span> <span class="id">F</span>, <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span> -&gt; <span class="id">cauchy</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">eps</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#lim">lim</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>)<br/>
}.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Hilbert.ClassDef">ClassDef</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="Hilbert.class_of">class_of</a></span> (<span class="id">T</span> : <span class="kwd">Type</span>) := <span class="kwd">Class</span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="Hilbert.base">base</a></span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.class_of">PreHilbert.class_of</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#T">T</a></span> ;<br/>
&nbsp;&nbsp;<span class="id"><a name="Hilbert.mixin">mixin</a></span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.mixin_of">mixin_of</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.Pack">PreHilbert.Pack</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#T">T</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#base">base</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#T">T</a></span>)<br/>
}.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Coercion</span> <span class="id">base</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">PreHilbert.class_of</span>.<br/>
<br/>
<span class="kwd">Structure</span> <span class="id"><a name="Hilbert.type">type</a></span> := <span class="id"><a name="Hilbert.Pack">Pack</a></span> { <span class="id"><a name="Hilbert.sort">sort</a></span>; <span class="id">_</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.class_of">class_of</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#sort">sort</a></span> ; <span class="id">_</span> : <span class="kwd">Type</span> }.<br/>
<span class="kwd">Local</span> <span class="kwd">Coercion</span> <span class="id">sort</span> : <span class="id">type</span> &gt;-&gt; <span class="id">Sortclass</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Hilbert.ClassDef.cT">cT</a></span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.type">type</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert.class">class</a></span> := <span class="kwd">let</span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.Pack">Pack</a></span> <span class="id">_</span> <span class="id">c</span> <span class="id">_</span> := <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="kwd">return</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.class_of">class_of</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#cT">cT</a></span> <span class="kwd">in</span> <span class="id">c</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="Hilbert.ClassDef.xT">xT</a></span> := <span class="kwd">let</span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.Pack">Pack</a></span> <span class="id">T</span> <span class="id">_</span> <span class="id">_</span> := <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="kwd">in</span> <span class="id">T</span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="Hilbert.xclass">xclass</a></span> := (<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.class">class</a></span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.class_of">class_of</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef.xT">xT</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert.AbelianGroup">AbelianGroup</a></span> := <span class="id">AbelianGroup.Pack</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.xclass">xclass</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef.xT">xT</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert.ModuleSpace">ModuleSpace</a></span> := <span class="id">ModuleSpace.Pack</span> <span class="id">_</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.xclass">xclass</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef.xT">xT</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert.PreHilbert">PreHilbert</a></span> := <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert.Pack">PreHilbert.Pack</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef.cT">cT</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.xclass">xclass</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef.xT">xT</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ClassDef">ClassDef</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="Hilbert.Exports">Exports</a></span>.<br/>
<br/>
<span class="kwd">Coercion</span> <span class="id">base</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">PreHilbert.class_of</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">mixin</span> : <span class="id">class_of</span> &gt;-&gt; <span class="id">mixin_of</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">sort</span> : <span class="id">type</span> &gt;-&gt; <span class="id">Sortclass</span>.<br/>
<span class="kwd">Coercion</span> <span class="id">AbelianGroup</span> : <span class="id">type</span> &gt;-&gt; <span class="id">AbelianGroup.type</span>.<br/>
<span class="id">Canonical</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.AbelianGroup">AbelianGroup</a></span>.<br/>
<span class="kwd">Coercion</span> <span class="id">ModuleSpace</span> : <span class="id">type</span> &gt;-&gt; <span class="id">ModuleSpace.type</span>.<br/>
<span class="id">Canonical</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.ModuleSpace">ModuleSpace</a></span>.<br/>
<span class="kwd">Coercion</span> <span class="id">PreHilbert</span> : <span class="id">type</span> &gt;-&gt; <span class="id">PreHilbert.type</span>.<br/>
<span class="id">Canonical</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.PreHilbert">PreHilbert</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> <span class="id"><a name="Hilbert.Exports.Hilbert">Hilbert</a></span> := <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.type">type</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert.Exports">Exports</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert">Hilbert</a></span>.<br/>
<br/>
<span class="kwd">Export</span> <span class="id">Hilbert.Exports</span>.<br/>
<br/>
<span class="id">Canonical</span> <span class="id"><a name="Hilbert_UniformSpace">Hilbert_UniformSpace</a></span> (<span class="id">E</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert">Hilbert</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id">UniformSpace.Pack</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert_UniformSpace_mixin">PreHilbert_UniformSpace_mixin</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span>.<br/>
<br/>
<span class="id">Canonical</span> <span class="id"><a name="Hilbert_NormedModule">Hilbert_NormedModule</a></span> (<span class="id">E</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert">Hilbert</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id">NormedModule.Pack</span> <span class="id">R_AbsRing</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NormedModule.Class</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert_NormedModule_mixin">PreHilbert_NormedModule_mixin</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#E">E</a></span>.<br/>
<br/>
<span class="kwd">Coercion</span> <span class="id">Hilbert_NormedModule</span>: <span class="id">Hilbert</span> &gt;-&gt; <span class="id">NormedModule</span>.<br/>
<br/>
<div class="doc">Hilbert is a CompleteScape </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Hilbert_aux">Hilbert_aux</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert">Hilbert</a></span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="lim">lim</a></span> : ((<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#lim">Hilbert.lim</a></span> <span class="id">_</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#class">Hilbert.class</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Hilbert_complete">Hilbert_complete</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">F</span>:(<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span>-&gt;<span class="kwd">Prop</span>)-&gt;<span class="kwd">Prop</span>), <span class="id">ProperFilter</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">cauchy</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">eps</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#lim">lim</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F">F</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1171')">Proof.</div>
<div class="proofscript" id="proof1171">
<span class="tactic">intros</span> <span class="id">F</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">eps</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ax1">Hilbert.ax1</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">F</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">eps</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Hilbert_close_lim">Hilbert_close_lim</a></span> : <br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F1</span> <span class="id">F2</span> : (<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">filter_le</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F1">F1</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F2">F2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">filter_le</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F2">F2</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F1">F1</a></span> -&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#lim">lim</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F1">F1</a></span>) (<span class="id"><a href="CertRL.converge.LM.hilbert.html#lim">lim</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#F2">F2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1172')">Proof.</div>
<div class="proofscript" id="proof1172">
<span class="tactic">intros</span> <span class="id">F1</span> <span class="id">F2</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="tactic">replace</span> <span class="id">F1</span> <span class="kwd">with</span> <span class="id">F2</span>.<br/>
<span class="tactic">apply</span> <span class="id">close_refl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span>.<br/>
<span class="tactic">unfold</span> <span class="id">filter_le</span> <span class="kwd">in</span> *.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#prop_extensionality">prop_extensionality</a></span>; <span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Hilbert_CompleteSpace_mixin">Hilbert_CompleteSpace_mixin</a></span> :=<br/>
&nbsp;&nbsp;<span class="id">CompleteSpace.Mixin</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert_UniformSpace">PreHilbert_UniformSpace</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#lim">lim</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_complete">Hilbert_complete</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_close_lim">Hilbert_close_lim</a></span>.<br/>
<br/>
<span class="id">Canonical</span> <span class="id"><a name="Hilbert_CompleteSpace">Hilbert_CompleteSpace</a></span> :=<br/>
&nbsp;&nbsp;<span class="id">CompleteSpace.Pack</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span> (<span class="id">CompleteSpace.Class</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_CompleteSpace_mixin">Hilbert_CompleteSpace_mixin</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span>.<br/>
<br/>
<span class="id">Canonical</span> <span class="id"><a name="Hilbert_CompleteNormedModule">Hilbert_CompleteNormedModule</a></span> :=<br/>
&nbsp;&nbsp;<span class="id">CompleteNormedModule.Pack</span> <span class="id">R_AbsRing</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">CompleteNormedModule.Class</span> <span class="id">R_AbsRing</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NormedModule.class</span> <span class="id">_</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert_NormedModule">PreHilbert_NormedModule</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_CompleteSpace_mixin">Hilbert_CompleteSpace_mixin</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux.E">E</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hilbert_aux">Hilbert_aux</a></span>.<br/>
<br/>
<div class="doc">Convexity </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Convex">Convex</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id">ModuleSpace</span> <span class="id">R_Ring</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="convex">convex</a></span> (<span class="id">phi</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#Convex.E">E</a></span> -&gt;<span class="kwd">Prop</span>) :=<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">u</span> <span class="id">v</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#Convex.E">E</a></span>) (<span class="id">theta</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; 0 &lt;= <span class="id"><a href="CertRL.converge.LM.hilbert.html#theta">theta</a></span> &lt;=1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#phi">phi</a></span> (<span class="id">plus</span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#theta">theta</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span>) (<span class="id">scal</span> (1-<span class="id"><a href="CertRL.converge.LM.hilbert.html#theta">theta</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)).<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Convex">Convex</a></span>.<br/>
<br/>
<div class="doc">Orthogonal projection </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="OrthogonalP">OrthogonalP</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="OrthogonalP.phi">phi</a></span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="OrthogonalP.phi_nonempty">phi_nonempty</a></span>: <span class="id">exists</span> <span class="id">y</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="OrthogonalP.phi_convex">phi_convex</a></span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ortho_projection_aux">ortho_projection_aux</a></span>: <span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;<span class="id">is_finite</span> (<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1173')">Proof.</div>
<div class="proofscript" id="proof1173">
<span class="tactic">intros</span> <span class="id">u</span>.<br/>
<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi_nonempty">phi_nonempty</a></span> <span class="kwd">as</span> (<span class="id">y</span>,<span class="id">Hy</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.R_compl.html#is_finite_betw">is_finite_betw</a></span> <span class="kwd">with</span> 0 (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">y</span>)).<br/>
<span class="tactic">apply</span> <span class="id">Glb_Rbar_correct</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> (<span class="id">w</span>,(<span class="id">H1</span>,<span class="id">H2</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Glb_Rbar_correct</span>.<br/>
<span class="id">exists</span> <span class="id">y</span>; <span class="id">now</span> <span class="tactic">split</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">ortho_projection_convex</span>': <span class="id"><a href="CertRL.converge.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Decidable.html#decidable">decidable</a></span> (<span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> /\ <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1174')">Proof.</div>
<div class="proofscript" id="proof1174">
<span class="tactic">intros</span> (<span class="id">lime</span>, <span class="id">Hlime</span>) <span class="id">u</span> <span class="id">Du</span>.<br/>
<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi_nonempty">phi_nonempty</a></span> <span class="kwd">as</span> (<span class="id">y</span>,<span class="id">Hy</span>).<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">pose</span> (<span class="id">delta</span>:= <span class="id">real</span> (<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))).<br/>
<span class="tactic">assert</span> (<span class="id">Hdelta</span>:0 &lt;= <span class="id">delta</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Rbar_le</span> 0 (<span class="id">Glb_Rbar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))).<br/>
<span class="tactic">apply</span> <span class="id">Glb_Rbar_correct</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> (<span class="id">w</span>,(<span class="id">H1</span>,<span class="id">H2</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id">H2</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">delta</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="id">u</span>) <span class="kwd">in</span> <span class="id">H</span>; <span class="id">easy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">V</span>: <span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, 0 &lt; <span class="id">delta</span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>).<br/>
<span class="tactic">intros</span> <span class="id">eps</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> <span class="id">eps</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> (-<span class="id">eps</span>); <span class="id">ring_simplify</span>; <span class="tactic">assumption</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="id">Kr</span>: <span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, ~~<span class="id">exists</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> /\ <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) &lt; <span class="id">delta</span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>).<br/>
<span class="tactic">intros</span> <span class="id">eps</span> <span class="id">H</span>.<br/>
<span class="id">absurd</span> (<span class="id">Rbar_lt</span> (<span class="id">Glb_Rbar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))) (<span class="id">delta</span> + <span class="id">eps</span>)).<br/>
<span class="tactic">apply</span> <span class="id">Rbar_le_not_lt</span>.<br/>
<span class="tactic">apply</span> <span class="id">Glb_Rbar_correct</span>.<br/>
<span class="tactic">intros</span> <span class="id">r</span> <span class="id">Hr</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_or_lt">Rle_or_lt</a></span> (<span class="id">delta</span> + <span class="id">eps</span>) <span class="id">r</span>); <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">intros</span> <span class="id">Hr</span>'.<br/>
<span class="id">exfalso</span>; <span class="tactic">apply</span> <span class="id">H</span>.<br/>
<span class="tactic">destruct</span> <span class="id">Hr</span> <span class="kwd">as</span> (<span class="id">w</span>, (<span class="id">J1</span>,<span class="id">J2</span>)).<br/>
<span class="id">exists</span> <span class="id">w</span>; <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">J2</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="id">u</span>); <span class="tactic">simpl</span>; <span class="id">fold</span> <span class="id">delta</span>.<br/>
<span class="tactic">apply</span> <span class="id">Rplus_lt_reg_l</span> <span class="kwd">with</span> (-<span class="id">delta</span>); <span class="id">ring_simplify</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">Kr</span>': <span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id">exists</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> /\ <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) &lt; <span class="id">delta</span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>).<br/>
<span class="tactic">intros</span> <span class="id">eps</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.logic_tricks.html#logic_dec_notnot">logic_dec_notnot</a></span>.<br/>
<span class="tactic">apply</span> (<span class="id">Du</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> (<span class="id">V</span> <span class="id">eps</span>))).<br/>
<span class="tactic">exact</span> (<span class="id">Kr</span> <span class="id">eps</span>).<br/>
<span class="id">pose</span> (<span class="id">F</span>:=<span class="kwd">fun</span> (<span class="id">f</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>-&gt;<span class="kwd">Prop</span>) =&gt; <span class="id">exists</span> <span class="id">eps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>) &lt; <span class="id">delta</span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>).<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="id">ProperFilter</span> <span class="id">F</span>).<br/>
<span class="tactic">split</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id">F</span>; <span class="tactic">intros</span> <span class="id">P</span> (<span class="id">eps</span>,<span class="id">Heps</span>).<br/>
<span class="tactic">destruct</span> (<span class="id">Kr</span>' <span class="id">eps</span>) <span class="kwd">as</span> (<span class="id">x</span>,(<span class="id">Hx1</span>,<span class="id">Hx2</span>)).<br/>
<span class="id">exists</span> <span class="id">x</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Heps</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">split</span>.<br/>
<span class="comment">(*&nbsp;..&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id">F</span>; <span class="tactic">simpl</span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>); <span class="id">easy</span>.<br/>
<span class="comment">(*&nbsp;..&nbsp;*)</span><br/>
<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> (<span class="id">e1</span>,<span class="id">HP2</span>) (<span class="id">e2</span>,<span class="id">HQ2</span>).<br/>
<span class="tactic">assert</span> (<span class="id">V</span>':0 &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span> <span class="id">e1</span> <span class="id">e2</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_pos">Rmin_pos</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">V</span>').<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx1</span> <span class="id">Hx2</span>; <span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id">HP2</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">Hx2</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
<span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_l">Rmin_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">HQ2</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1:=<span class="id">Hx2</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
<span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_r">Rmin_r</a></span>.<br/>
<span class="comment">(*&nbsp;..&nbsp;*)</span><br/>
<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">H</span> (<span class="id">e</span>,<span class="id">HP2</span>).<br/>
<span class="id">exists</span> <span class="id">e</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx1</span> <span class="id">Hx2</span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">HP2</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="id">cauchy</span> <span class="id">F</span>); <span class="tactic">unfold</span> <span class="id">cauchy</span>.<br/>
<span class="tactic">intros</span> <span class="id">eps</span>.<br/>
<span class="id">pose</span> (<span class="id">eta</span>:= <span class="kwd">match</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#left">left</a></span> <span class="id">_</span> =&gt; <span class="id">eps</span>/2<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#right">right</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span> ((<span class="id">eps</span>*<span class="id">eps</span>)/(16*<span class="id">delta</span>)) (<span class="id">eps</span>/(2*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Keta</span>: 0 &lt; <span class="id">eta</span>).<br/>
<span class="tactic">unfold</span> <span class="id">eta</span>; <span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="tactic">intros</span> <span class="id">Hd</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> (<span class="id">pos_div_2</span> <span class="id">eps</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="id">right</span>; <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_pos">Rmin_pos</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">case</span> <span class="id">Hdelta</span>; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">intros</span> <span class="id">Hd</span>'; <span class="id">contradict</span> <span class="id">Hd</span>'.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#sym_not_eq">sym_not_eq</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_calc.html#Rlt_sqrt2_0">Rlt_sqrt2_0</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id">Kr</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">Keta</span>)) <span class="kwd">as</span> (<span class="id">f</span>,(<span class="id">Hf1</span>,<span class="id">Hf2</span>)).<br/>
<span class="id">exists</span> <span class="id">f</span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">Keta</span>).<br/>
<span class="tactic">intros</span> <span class="id">g</span> <span class="id">Hg1</span> <span class="id">Hg2</span>.<br/>
<span class="tactic">unfold</span> <span class="id">Hierarchy.ball</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball">ball</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hf2</span>, <span class="id">Hg2</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="id">M</span>:4*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> (<span class="id">scal</span> (/2) (<span class="id">plus</span> <span class="id">f</span> <span class="id">g</span>)))) + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">f</span> <span class="id">g</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">f</span>)) + 2*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">g</span>))).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="tactic">at</span> 3 4; <span class="tactic">rewrite</span> 2!<span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#parallelogram_id">parallelogram_id</a></span>.<br/>
<span class="tactic">f_equal</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#trans_eq">trans_eq</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (2*<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> (<span class="id">scal</span> (/ 2) (<span class="id">plus</span> <span class="id">f</span> <span class="id">g</span>))))).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">replace</span> 2 <span class="kwd">with</span> (<span class="id">abs</span> 2) <span class="tactic">at</span> 1.<br/>
2: <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.R_compl.html#norm_scal_R">norm_scal_R</a></span>, &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">fold</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">plus</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">f</span>) (<span class="id">minus</span> <span class="id">u</span> <span class="id">g</span>)))).<br/>
<span class="tactic">f_equal</span>.<br/>
<span class="tactic">unfold</span> <span class="id">norm</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_distr_l</span> <span class="id">scal_opp_r</span> <span class="id">scal_assoc</span>.<br/>
<span class="tactic">replace</span> (@<span class="id">mult</span> <span class="id">R_AbsRing</span> 2 (/2)) <span class="kwd">with</span> 1.<br/>
2: <span class="tactic">unfold</span> <span class="id">mult</span>; <span class="tactic">simpl</span>; <span class="id">field</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_one</span>.<br/>
<span class="tactic">replace</span> 2 <span class="kwd">with</span> (<span class="id">plus</span> 1 1).<br/>
2: <span class="tactic">unfold</span> <span class="id">plus</span>; <span class="tactic">simpl</span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_distr_r</span> <span class="id">scal_one</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>; <span class="tactic">rewrite</span> &lt;- 2!<span class="id">plus_assoc</span>; <span class="tactic">f_equal</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">opp_plus</span> 2!<span class="id">plus_assoc</span>; <span class="tactic">f_equal</span>.<br/>
<span class="tactic">apply</span> <span class="id">plus_comm</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="id">fold</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">f</span>) (<span class="id">minus</span> <span class="id">u</span> <span class="id">g</span>)))).<br/>
<span class="tactic">f_equal</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_opp">norm_opp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">norm</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
<span class="tactic">rewrite</span> 2!<span class="id">opp_plus</span> 2!<span class="id">opp_opp</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_assoc</span>; <span class="tactic">f_equal</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_comm</span> <span class="id">plus_assoc</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">plus_opp_r</span> <span class="id">plus_zero_l</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_0">Rsqr_incrst_0</a></span>.<br/>
2: <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
2: <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (-4 * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> (<span class="id">scal</span> (/ 2) (<span class="id">plus</span> <span class="id">f</span> <span class="id">g</span>))))² +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2 * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">f</span>))² + 2 * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">g</span>))²).<br/>
<span class="id">right</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_reg_l">Rplus_eq_reg_l</a></span> <span class="kwd">with</span> (4 * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> (<span class="id">scal</span> (/ 2) (<span class="id">plus</span> <span class="id">f</span> <span class="id">g</span>))))²).<br/>
<span class="tactic">rewrite</span> <span class="id">M</span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (-4*<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">delta</span>+2 * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">f</span>))² +2 * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">g</span>))²).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_neg_l">Rmult_le_compat_neg_l</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incr_1">Rsqr_incr_1</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">assert</span> (<span class="id">H2</span>:<span class="id">Rbar_le</span> (<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w0</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w0">w0</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w0">w0</a></span>))) (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> (<span class="id">scal</span> (/ 2) (<span class="id">plus</span> <span class="id">f</span> <span class="id">g</span>))))).<br/>
<span class="tactic">apply</span> <span class="id">Glb_Rbar_correct</span>.<br/>
<span class="id">exists</span> (<span class="id">scal</span> (/ 2) (<span class="id">plus</span> <span class="id">f</span> <span class="id">g</span>)); <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">replace</span> (<span class="id">scal</span> (/ 2) (<span class="id">plus</span> <span class="id">f</span> <span class="id">g</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">plus</span> (<span class="id">scal</span> (/2) <span class="id">f</span>) (<span class="id">scal</span> (1-/2) <span class="id">g</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi_convex">phi_convex</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pos_half_prf">pos_half_prf</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> 2.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> (-1); <span class="id">ring_simplify</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_1">Rle_0_1</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">replace</span> (1-/2) <span class="kwd">with</span> (/2) <span class="tactic">by</span> <span class="id">field</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">scal_distr_l</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">easy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (-4*<span class="id">delta</span>²+2*(<span class="id">delta</span>+<span class="id">eta</span>)²+2*(<span class="id">delta</span>+<span class="id">eta</span>)²).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_compat">Rplus_lt_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_1">Rsqr_incrst_1</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqr.html#Rsqr_incrst_1">Rsqr_incrst_1</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span>  (8*<span class="id">delta</span>*<span class="id">eta</span>+4*<span class="id">eta</span>*<span class="id">eta</span>).<br/>
<span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">eps</span>) / 2 + (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> <span class="id">eps</span>) / 2).<br/>
2: <span class="id">right</span>; <span class="id">field</span>.<br/>
<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="tactic">intros</span> <span class="id">Y</span>.<br/>
<span class="tactic">replace</span> <span class="id">eta</span> <span class="kwd">with</span> (<span class="id">eps</span>/2).<br/>
<span class="tactic">rewrite</span> <span class="id">Y</span>; <span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">field</span>.<br/>
<span class="tactic">unfold</span> <span class="id">eta</span>; <span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="id">easy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat">Rplus_le_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (8*<span class="id">delta</span>*(<span class="id">eps</span> * <span class="id">eps</span> / (16 * <span class="id">delta</span>))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">eta</span>; <span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_l">Rmin_l</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">right</span>; <span class="id">field</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">assert</span> (<span class="id">eta</span> &lt;= <span class="id">eps</span> / (2 * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2)).<br/>
<span class="tactic">unfold</span> <span class="id">eta</span>; <span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">delta</span> 0); <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_r">Rmin_r</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (4*(<span class="id">eps</span> / (2 * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2))*(<span class="id">eps</span> / (2 * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="tactic">try</span> (<span class="id">left</span>; <span class="tactic">exact</span> <span class="id">Keta</span>); <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="tactic">try</span> (<span class="id">left</span>; <span class="tactic">exact</span> <span class="id">Keta</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">eps</span>²/((<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> 2)²)).<br/>
<span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>; <span class="id">field</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_calc.html#Rlt_sqrt2_0">Rlt_sqrt2_0</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#Rsqr_sqrt">Rsqr_sqrt</a></span>.<br/>
<span class="id">now</span> <span class="id">right</span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">P</span>, <span class="id">F</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#P">P</a></span> -&gt; ~ ~ (<span class="id">exists</span> <span class="id">x</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert_NormedModule">PreHilbert_NormedModule</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#P">P</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>)).<br/>
<span class="tactic">unfold</span> <span class="id">F</span>; <span class="tactic">intros</span> <span class="id">P</span> (<span class="id">n</span>,<span class="id">Hn</span>) <span class="id">K</span>.<br/>
<span class="tactic">apply</span> <span class="id">K</span>.<br/>
<span class="tactic">destruct</span> (<span class="id">Kr</span>' <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">x</span>,(<span class="id">Hx1</span>,<span class="id">Hx2</span>)).<br/>
<span class="id">exists</span> <span class="id">x</span>; <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hn</span>.<br/>
<span class="id">specialize</span> (<span class="id">Hlime</span> <span class="id">F</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H1</span>).<br/>
<span class="tactic">destruct</span> <span class="id">Hlime</span> <span class="kwd">as</span> (<span class="id">T1</span>,<span class="id">T2</span>).<br/>
<span class="id">exists</span> (<span class="id">lime</span> <span class="id">F</span>).<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">exact</span> <span class="id">T1</span>.<br/>
<span class="id">fold</span> <span class="id">delta</span>.<br/>
<span class="tactic">apply</span> @<span class="id">filterlim_locally_unique</span> <span class="kwd">with</span> (<span class="id">F</span>:=<span class="id">F</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:=<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>)).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Proper_StrongProper</span>.<br/>
<span class="tactic">apply</span> <span class="id">filterlim_comp</span> <span class="kwd">with</span> (<span class="id">G</span>:=<span class="id">locally</span> (<span class="id">minus</span> <span class="id">u</span> (<span class="id">lime</span> <span class="id">F</span>))).<br/>
<span class="tactic">unfold</span> <span class="id">filterlim</span>, <span class="id">filter_le</span>, <span class="id">filtermap</span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> (<span class="id">e</span>,<span class="id">He</span>).<br/>
<span class="id">pose</span> (<span class="id">v</span>:=@<span class="id">norm_factor</span> <span class="id">R_AbsRing</span> (@<span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert_NormedModule">PreHilbert_NormedModule</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>)).<br/>
<span class="tactic">assert</span> (<span class="id">J</span>: 0 &lt; <span class="id">e</span>/<span class="id">v</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">norm_factor_gt_0</span>.<br/>
<span class="tactic">destruct</span> (<span class="id">T2</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">J</span>)) <span class="kwd">as</span> (<span class="id">eps</span>, <span class="id">Heps</span>).<br/>
<span class="id">exists</span> <span class="id">eps</span>.<br/>
<span class="tactic">intros</span> <span class="id">w</span> <span class="id">Hw1</span> <span class="id">Hw2</span>.<br/>
<span class="tactic">apply</span> <span class="id">He</span>.<br/>
<span class="tactic">apply</span>: <span class="id">norm_compat1</span>.<br/>
<span class="tactic">unfold</span> <span class="id">norm</span> <span class="tactic">at</span> 1; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> (<span class="id">lime</span> <span class="id">F</span>) <span class="id">w</span>)).<br/>
<span class="id">right</span>; <span class="tactic">f_equal</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>; <span class="tactic">rewrite</span> <span class="id">plus_comm</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_assoc</span>; <span class="tactic">f_equal</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">opp_plus</span> <span class="id">plus_comm</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_assoc</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span> <span class="id">plus_zero_l</span>.<br/>
<span class="tactic">apply</span> <span class="id">opp_opp</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e</span>) <span class="kwd">with</span> (<span class="id">v</span>*(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">J</span>)).<br/>
<span class="tactic">unfold</span> <span class="id">v</span> <span class="tactic">at</span> 1.<br/>
<span class="tactic">apply</span> (<span class="id">norm_compat2</span> <span class="id">w</span> (<span class="id">lime</span> <span class="id">F</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">J</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ball_sym">ball_sym</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Heps</span>.<br/>
<span class="tactic">simpl</span>; <span class="id">field</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id">norm_factor_gt_0</span>.<br/>
<span class="tactic">apply</span>: <span class="id">filterlim_norm</span>.<br/>
<span class="tactic">unfold</span> <span class="id">filterlim</span>, <span class="id">filter_le</span>, <span class="id">filtermap</span>, <span class="id">F</span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> (<span class="id">e</span>,<span class="id">He</span>).<br/>
<span class="id">exists</span> <span class="id">e</span>; <span class="tactic">intros</span> <span class="id">w</span> <span class="id">Hw1</span> <span class="id">Hw2</span>.<br/>
<span class="tactic">apply</span> <span class="id">He</span>.<br/>
<span class="tactic">apply</span> <span class="id">norm_compat1</span>.<br/>
<span class="tactic">unfold</span> <span class="id">norm</span> <span class="tactic">at</span> 1; <span class="tactic">simpl</span>.<br/>
<span class="tactic">unfold</span> <span class="id">abs</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span> <span class="tactic">at</span> 1; <span class="tactic">unfold</span> <span class="id">plus</span>, <span class="id">opp</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id">Rplus_lt_reg_l</span> <span class="kwd">with</span> <span class="id">delta</span>; <span class="id">ring_simplify</span>.<br/>
<span class="tactic">exact</span> <span class="id">Hw2</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span> <span class="tactic">at</span> 1; <span class="tactic">unfold</span> <span class="id">plus</span>, <span class="id">opp</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> <span class="id">delta</span>; <span class="id">ring_simplify</span>.<br/>
<span class="tactic">assert</span> (<span class="id">H2</span>:<span class="id">Rbar_le</span> (<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w0</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w0">w0</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w0">w0</a></span>))) (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">w</span>))).<br/>
<span class="tactic">apply</span> <span class="id">Glb_Rbar_correct</span>.<br/>
<span class="id">exists</span> <span class="id">w</span>; <span class="id">now</span> <span class="tactic">split</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">easy</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ortho_projection_convex_unique">ortho_projection_convex_unique</a></span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">v</span> <span class="id">v</span>':<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))<br/>
&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id">v</span>' -&gt; <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id">v</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))<br/>
&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> = <span class="id">v</span>'.<br/>
<span class="tactic">intros</span> <span class="id">H</span> <span class="id">u</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">H0</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
<span class="id">pose</span> (<span class="id">a</span> := <span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>').<br/>
<span class="id">pose</span> (<span class="id">b</span> := <span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>).<br/>
<span class="id">pose</span> (<span class="id">v</span>'' := <span class="id">scal</span> (1/2) (<span class="id">plus</span> <span class="id">v</span> <span class="id">v</span>')).<br/>
<span class="id">pose</span> (<span class="id">d</span> := <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>)).<br/>
<span class="tactic">assert</span> (<span class="id">E1</span> : <span class="id">plus</span> (4*((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>''))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>''))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>'))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>')))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 4*(<span class="id">d</span>*<span class="id">d</span>)).<br/>
<span class="tactic">assert</span> (<span class="id">E2</span> : <span class="id">plus</span> ((<span class="id">norm</span> (<span class="id">plus</span> <span class="id">a</span> <span class="id">b</span>))*(<span class="id">norm</span> (<span class="id">plus</span> <span class="id">a</span> <span class="id">b</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">a</span> <span class="id">b</span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">a</span> <span class="id">b</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 4*(<span class="id">d</span>*<span class="id">d</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="tactic">replace</span> ((<span class="id">plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">plus</span> <span class="id">a</span> <span class="id">b</span>) (<span class="id">plus</span> <span class="id">a</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">a</span> <span class="id">b</span>) (<span class="id">minus</span> <span class="id">a</span> <span class="id">b</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">plus</span> <span class="id">a</span> <span class="id">b</span>) (<span class="id">plus</span> <span class="id">a</span> <span class="id">b</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">a</span> <span class="id">b</span>) (<span class="id">minus</span> <span class="id">a</span> <span class="id">b</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#parallelogram_id">parallelogram_id</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">d</span>, <span class="id">a</span>, <span class="id">b</span>.<br/>
<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>).<br/>
<span class="tactic">replace</span> ( <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>')) <span class="kwd">with</span> (<span class="id">norm</span> ((<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>')))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">replace</span> ( <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>)) <span class="kwd">with</span> (<span class="id">norm</span> ((<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">replace</span> (<span class="id">plus</span> (<span class="id">norm</span> (<span class="id">plus</span> <span class="id">a</span> <span class="id">b</span>) * <span class="id">norm</span> (<span class="id">plus</span> <span class="id">a</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">a</span> <span class="id">b</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">a</span> <span class="id">b</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">plus</span> (4 * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>'') * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>'')))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>') * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>'))) <span class="kwd">in</span> <span class="id">E2</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">replace</span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">a</span> <span class="id">b</span>)) <span class="kwd">with</span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>')).<br/>
<span class="tactic">unfold</span> <span class="id">a</span>, <span class="id">b</span>.<br/>
<span class="tactic">unfold</span> <span class="id">v</span>''.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_comm</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id">plus_comm</span> <span class="id">_</span> ((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>') * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>')))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_compat_l">Rplus_eq_compat_l</a></span>.<br/>
<span class="tactic">replace</span> (<span class="id">plus</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>') (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">minus</span> ((<span class="id">scal</span> 2) <span class="id">u</span>) (<span class="id">plus</span> <span class="id">v</span> <span class="id">v</span>')).<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
<span class="tactic">assert</span> (<span class="id">H42</span> : (4 *(<span class="id">norm</span> (<span class="id">plus</span> <span class="id">u</span> (<span class="id">opp</span> (<span class="id">scal</span> (1 / 2) (<span class="id">plus</span> <span class="id">v</span> <span class="id">v</span>')))) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">norm</span> (<span class="id">plus</span> <span class="id">u</span> (<span class="id">opp</span> (<span class="id">scal</span> (1 / 2) (<span class="id">plus</span> <span class="id">v</span> <span class="id">v</span>'))))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=((2*(<span class="id">norm</span> (<span class="id">plus</span> <span class="id">u</span> (<span class="id">opp</span> (<span class="id">scal</span> (1 / 2) (<span class="id">plus</span> <span class="id">v</span> <span class="id">v</span>'))))))*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2*(<span class="id">norm</span> (<span class="id">plus</span> <span class="id">u</span> (<span class="id">opp</span> (<span class="id">scal</span> (1 / 2) (<span class="id">plus</span> <span class="id">v</span> <span class="id">v</span>')))))))).<br/>
<span class="tactic">ring</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H42</span>.<br/>
<span class="tactic">replace</span> 2 <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> 2) <span class="tactic">at</span> 1.<br/>
<span class="tactic">replace</span> 2 <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> 2) <span class="tactic">at</span> 3.<br/>
<span class="tactic">unfold</span> <span class="id">norm</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_scal">norm_scal</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_distr_l</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">scal_opp_r</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_assoc</span>.<br/>
<span class="tactic">replace</span> (<span class="id">mult</span> 2 (1/2)) <span class="kwd">with</span> 1.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_one</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">unfold</span> <span class="id">mult</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="id">field</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> 2).<br/>
<span class="id">absurd</span> (2 &lt; 0).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span>.<br/>
<span class="tactic">intuition</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> 2).<br/>
<span class="id">absurd</span> (2 &lt; 0).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span>.<br/>
<span class="tactic">intuition</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_distr_r</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_one</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">opp_plus</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.compatible.html#plus_assoc_gen">plus_assoc_gen</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_comm</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">unfold</span> <span class="id">a</span>, <span class="id">b</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">opp_plus</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_comm</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">opp_opp</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id">plus_comm</span> (<span class="id">opp</span> <span class="id">u</span>) <span class="id">v</span>).<br/>
<span class="tactic">rewrite</span> <span class="id">plus_assoc</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id">plus_assoc</span> <span class="id">u</span> (<span class="id">opp</span> <span class="id">v</span>') <span class="id">v</span>).<br/>
<span class="tactic">rewrite</span> (<span class="id">plus_comm</span> <span class="id">u</span> (<span class="id">plus</span> (<span class="id">opp</span> <span class="id">v</span>') <span class="id">v</span>)).<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id">plus_assoc</span> (<span class="id">plus</span> (<span class="id">opp</span> <span class="id">v</span>') <span class="id">v</span>) <span class="id">u</span> (<span class="id">opp</span> <span class="id">u</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_zero_r</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hmin</span> : <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>') * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>') &lt;= 0).<br/>
<span class="tactic">replace</span> 0 <span class="kwd">with</span> (<span class="id">plus</span> (4*(<span class="id">d</span>*<span class="id">d</span>)) (-4*(<span class="id">d</span>*<span class="id">d</span>))).<br/>
<span class="tactic">replace</span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>') * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>')) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">minus</span> (4*(<span class="id">d</span>*<span class="id">d</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4 * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>'') * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>'')))).<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
<span class="tactic">replace</span> (-4 * (<span class="id">d</span> * <span class="id">d</span>)) <span class="kwd">with</span> (<span class="id">opp</span> (4*(<span class="id">d</span>*<span class="id">d</span>))).<br/>
<span class="tactic">assert</span> (<span class="id">Has</span>: <span class="id">opp</span> (4 * (<span class="id">norm</span> (<span class="id">plus</span> <span class="id">u</span> (<span class="id">opp</span> <span class="id">v</span>'')) * <span class="id">norm</span> (<span class="id">plus</span> <span class="id">u</span> (<span class="id">opp</span> <span class="id">v</span>''))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (-((4 * (<span class="id">norm</span> (<span class="id">plus</span> <span class="id">u</span> (<span class="id">opp</span> <span class="id">v</span>'')) * <span class="id">norm</span> (<span class="id">plus</span> <span class="id">u</span> (<span class="id">opp</span> <span class="id">v</span>''))))))).<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Has</span>.<br/>
<span class="tactic">clear</span> <span class="id">Has</span>.<br/>
<span class="tactic">replace</span> (<span class="id">opp</span> (4 * (<span class="id">d</span> * <span class="id">d</span>))) <span class="kwd">with</span> (-(4*(<span class="id">d</span>*<span class="id">d</span>))) <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hd</span> : <span class="id">d</span> &lt;= <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>'')).<br/>
<span class="tactic">assert</span> (<span class="id">HdGlb</span> : <span class="id">d</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))).<br/>
<span class="tactic">unfold</span> <span class="id">d</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">unfold</span> <span class="id">Glb_Rbar</span> <span class="kwd">in</span> <span class="id">HdGlb</span>.<br/>
<span class="tactic">destruct</span> (<span class="id">ex_glb_Rbar</span><br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))).<br/>
<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">HdGlb</span>.<br/>
<span class="tactic">unfold</span> <span class="id">is_glb_Rbar</span> <span class="kwd">in</span> <span class="id">HdGlb</span>.<br/>
<span class="tactic">unfold</span> <span class="id">is_glb_Rbar</span> <span class="kwd">in</span> <span class="id">i</span>.<br/>
<span class="tactic">unfold</span> <span class="id">is_lb_Rbar</span> <span class="kwd">in</span> <span class="id">i</span>.<br/>
<span class="tactic">destruct</span> <span class="id">i</span> <span class="kwd">as</span> (<span class="id">Hi1</span>,<span class="id">Hi2</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Hp</span> :<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; (<span class="id">Rbar_le</span> <span class="id">x</span>) (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))).<br/>
<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">Hi1</span>.<br/>
<span class="id">exists</span> <span class="id">w</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hf</span> :<span class="id">Rbar_le</span> <span class="id">x</span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>''))).<br/>
<span class="tactic">apply</span> <span class="id">Hp</span>.<br/>
<span class="tactic">unfold</span> <span class="id">v</span>''.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span> <span class="kwd">in</span> <span class="id">phi_convex</span>.<br/>
<span class="tactic">replace</span> (<span class="id">scal</span> (1 / 2) (<span class="id">plus</span> <span class="id">v</span> <span class="id">v</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">plus</span> (<span class="id">scal</span> (1/2) <span class="id">v</span>) (<span class="id">scal</span> (1/2) <span class="id">v</span>')).<br/>
<span class="tactic">replace</span> (1 / 2) <span class="kwd">with</span> (1 - (1 / 2)) <span class="tactic">at</span> 2 <span class="tactic">by</span> <span class="id">field</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi_convex">phi_convex</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hs</span> : 0 &lt; 1 / 2).<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">intuition</span>.<br/>
<span class="tactic">intuition</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> <span class="kwd">with</span> 2.<br/>
<span class="tactic">intuition</span>.<br/>
<span class="tactic">replace</span> (1 / 2 * 2) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="id">field</span>.<br/>
<span class="tactic">replace</span> 1 <span class="kwd">with</span> (1*1) <span class="tactic">at</span> 1 <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
<span class="tactic">intuition</span>. <span class="tactic">intuition</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
<span class="tactic">intuition</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_distr_l</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hrx</span> : <span class="id">real</span> <span class="id">x</span> &lt;= <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>'')).<br/>
<span class="tactic">unfold</span> <span class="id">Rbar_le</span> <span class="kwd">in</span> <span class="id">Hf</span>.<br/>
<span class="tactic">destruct</span> <span class="id">x</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">intuition</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">HdGlb</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="tactic">intuition</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>;<br/>
<span class="tactic">unfold</span> <span class="id">d</span>;<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">unfold</span> <span class="id">d</span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">d</span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">replace</span> (<span class="id">opp</span> (4 * (<span class="id">d</span> * <span class="id">d</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">opp</span> (<span class="id">scal</span> 4 (<span class="id">d</span>*<span class="id">d</span>))) <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">scal_opp_l</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">E1</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_comm</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_assoc</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_opp_l</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_zero_l</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">replace</span> ((-4 * (<span class="id">d</span> * <span class="id">d</span>))) <span class="kwd">with</span> (<span class="id">opp</span> (4*(<span class="id">d</span>*<span class="id">d</span>))).<br/>
<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">replace</span> (<span class="id">opp</span> (4 * (<span class="id">d</span> * <span class="id">d</span>))) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">opp</span> (<span class="id">scal</span> 4 (<span class="id">d</span>*<span class="id">d</span>))) <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">scal_opp_l</span>.<br/>
<span class="tactic">reflexivity</span>.<br/>
<span class="tactic">assert</span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>') * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>') = 0).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hsq</span> : <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">v</span>') = 0).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_integral">Rmult_integral</a></span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
<span class="tactic">destruct</span> <span class="id">H4</span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id">norm_eq_zero</span> <span class="kwd">in</span> <span class="id">Hsq</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span> <span class="kwd">in</span> <span class="id">Hsq</span>.<br/>
<span class="tactic">apply</span> <span class="id">plus_reg_r</span> <span class="kwd">with</span> (<span class="id">opp</span> <span class="id">v</span>').<br/>
<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span>.<br/>
<span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ortho_projection_convex">ortho_projection_convex</a></span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Decidable.html#decidable">decidable</a></span> (<span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">exists</span>! <span class="id">v</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> /\ <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1175')">Proof.</div>
<div class="proofscript" id="proof1175">
<span class="tactic">intros</span> <span class="id">H</span> <span class="id">u</span> <span class="id">Hu</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.logic_tricks.html#unique_existence1">unique_existence1</a></span>; <span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">ortho_projection_convex</span>'.<br/>
<span class="tactic">intros</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">Hv</span> <span class="id">Hv</span>'.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_projection_convex_unique">ortho_projection_convex_unique</a></span> <span class="kwd">with</span> <span class="id">u</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux1sq">charac_ortho_projection_convex_aux1sq</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; 0 &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)) = (<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> (<span class="id">plus</span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) (<span class="id">scal</span> (1-<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)))))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1176')">Proof.</div>
<div class="proofscript" id="proof1176">
<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span>.<br/>
<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_glb_Rbar</span> ((<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))).<br/>
<span class="tactic">apply</span> <span class="id">Glb_Rbar_correct</span>.<br/>
<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_projection_aux">ortho_projection_aux</a></span> <span class="id">u</span>) <span class="kwd">in</span> <span class="id">H3</span>, <span class="id">H4</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H3</span>, <span class="id">H4</span>. <span class="tactic">unfold</span> <span class="id">is_lb_Rbar</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">is_lb_Rbar</span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">apply</span> <span class="id">H3</span>.<br/>
<span class="id">exists</span> ((<span class="id">plus</span> (<span class="id">scal</span> <span class="id">t</span> <span class="id">w</span>) (<span class="id">scal</span> (1 - <span class="id">t</span>) <span class="id">v</span>))); <span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux1">charac_ortho_projection_convex_aux1</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; 0 &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)) = (<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> (<span class="id">plus</span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) (<span class="id">scal</span> (1-<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> (<span class="id">plus</span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) (<span class="id">scal</span> (1-<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))))))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1177')">Proof.</div>
<div class="proofscript" id="proof1177">
<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex_aux1sq">charac_ortho_projection_convex_aux1sq</a></span>; <span class="tactic">intuition</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex_aux1sq">charac_ortho_projection_convex_aux1sq</a></span>; <span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux2">charac_ortho_projection_convex_aux2</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; 0 &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> (<span class="id">plus</span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) (<span class="id">scal</span> (1-<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">plus</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1178')">Proof.</div>
<div class="proofscript" id="proof1178">
<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">minus</span> <span class="tactic">at</span> 1.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_distr_r</span>. <span class="tactic">rewrite</span> <span class="id">scal_one</span>. <span class="tactic">rewrite</span> <span class="id">scal_opp_l</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">opp_plus</span>. <span class="tactic">rewrite</span> (<span class="id">opp_plus</span> <span class="id">v</span> (<span class="id">opp</span> (<span class="id">scal</span> <span class="id">t</span> <span class="id">v</span>))).<br/>
<span class="tactic">rewrite</span> <span class="id">opp_opp</span>. <span class="tactic">rewrite</span> <span class="id">plus_assoc</span>. <span class="tactic">rewrite</span> <span class="id">plus_assoc</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id">plus_comm</span> (<span class="id">plus</span> <span class="id">u</span> (<span class="id">opp</span> (<span class="id">scal</span> <span class="id">t</span> <span class="id">w</span>))) (<span class="id">opp</span> <span class="id">v</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id">plus_assoc</span>. <span class="tactic">unfold</span> <span class="id">minus</span> <span class="tactic">at</span> 1.<br/>
<span class="tactic">rewrite</span> (<span class="id">plus_comm</span> (<span class="id">opp</span> <span class="id">v</span>) <span class="id">u</span>). <span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">plus_assoc</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">scal_opp_l</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_distr_l</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id">plus_comm</span> (<span class="id">scal</span> <span class="id">t</span> <span class="id">v</span>) (<span class="id">scal</span> <span class="id">t</span> (<span class="id">opp</span> <span class="id">w</span>))).<br/>
<span class="tactic">rewrite</span> (<span class="id">scal_opp_l</span> <span class="id">t</span> <span class="id">w</span>). <span class="tactic">rewrite</span> (<span class="id">scal_opp_r</span> <span class="id">t</span> <span class="id">w</span>).<br/>
<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux3">charac_ortho_projection_convex_aux3</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; 0 &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;-&gt; (<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> (<span class="id">plus</span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) (<span class="id">scal</span> (1-<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))))*<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> (<span class="id">plus</span> (<span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) (<span class="id">scal</span> (1-<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>) <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=  (<span class="id">minus</span> ((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((2*<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>)*(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)))) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>*<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>)*((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1179')">Proof.</div>
<div class="proofscript" id="proof1179">
<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex_aux2">charac_ortho_projection_convex_aux2</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_r">inner_scal_r</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id">opp_minus</span> <span class="id">v</span> <span class="id">w</span>). <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">t</span> * (<span class="id">t</span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span> * <span class="id">t</span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>. <span class="tactic">trivial</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))<br/>
(<span class="id">t</span> ^ 2 * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>))).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>.<br/>
<span class="tactic">f_equal</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>. <span class="tactic">symmetry</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>. <span class="tactic">rewrite</span> <span class="id">plus_comm</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.R_compl.html#Rplus_plus_reg_r">Rplus_plus_reg_r</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">opp_opp</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hminus</span> : <span class="kwd">forall</span> <span class="id">a</span>, -<span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> = <span class="id">opp</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span>).<br/>
<span class="tactic">intros</span>; <span class="tactic">reflexivity</span>. <span class="tactic">rewrite</span> <span class="id">Hminus</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hscal</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span>*<span class="id"><a href="CertRL.converge.LM.hilbert.html#b">b</a></span> = <span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#b">b</a></span>).<br/>
<span class="tactic">intros</span>; <span class="tactic">reflexivity</span>. <span class="tactic">rewrite</span> <span class="id">Hscal</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_opp_r</span>.<br/>
<span class="tactic">symmetry</span>. <span class="tactic">rewrite</span> <span class="id">Hscal</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux4">charac_ortho_projection_convex_aux4</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; 0 &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> &lt;= 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; 0 &lt;= (-(2*<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>*<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+(<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>*<span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>)*((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1180')">Proof.</div>
<div class="proofscript" id="proof1180">
<span class="tactic">intros</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hminus</span> : <span class="kwd">forall</span> <span class="id">a</span>, -<span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> = <span class="id">opp</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span>).<br/>
<span class="tactic">intros</span>; <span class="tactic">reflexivity</span>. <span class="tactic">rewrite</span> <span class="id">Hminus</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span><br/>
((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hrew</span> : <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">opp</span> (2 * <span class="id">t</span> * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span> * <span class="id">t</span> * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">minus</span> ((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((2*<span class="id">t</span>)*(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)))) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">t</span>*<span class="id">t</span>)*((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
<span class="tactic">assert</span> (<span class="id">Hperm</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> + (<span class="id">opp</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#b">b</a></span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#c">c</a></span>) = (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#b">b</a></span>) + <span class="id"><a href="CertRL.converge.LM.hilbert.html#c">c</a></span>).<br/>
<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">minus</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>. <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hperm</span>. <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hrew</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex_aux3">charac_ortho_projection_convex_aux3</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex_aux1">charac_ortho_projection_convex_aux1</a></span>;<br/>
<span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux5">charac_ortho_projection_convex_aux5</a></span> :  <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">t</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>,<br/>
&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; 0 &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span> &lt;= 1<br/>
&nbsp;&nbsp;-&gt; (<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))<br/>
&nbsp;&nbsp;-&gt; (2*(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="id"><a href="CertRL.converge.LM.hilbert.html#t">t</a></span>*((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))) .<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1181')">Proof.</div>
<div class="proofscript" id="proof1181">
<span class="tactic">intros</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> <span class="id">t</span>.<br/>
<span class="tactic">intuition</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">opp</span> (<span class="id">t</span>*(2 * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)))).<br/>
<span class="tactic">assert</span> (<span class="id">Hplus</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> + <span class="id"><a href="CertRL.converge.LM.hilbert.html#b">b</a></span> = <span class="id">plus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#b">b</a></span>).<br/>
<span class="tactic">intros</span>; <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hminus</span> : <span class="kwd">forall</span> <span class="id">a</span>, -<span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> = <span class="id">opp</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span>).<br/>
<span class="tactic">intros</span>; <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hplus</span>. <span class="tactic">rewrite</span> <span class="id">plus_opp_l</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>. <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">t</span> 2).<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hminus</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="id">t</span> <span class="id">t</span><br/>
&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex_aux4">charac_ortho_projection_convex_aux4</a></span>; <span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex_aux1_r">charac_ortho_projection_convex_aux1_r</a></span> : <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> :<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) &lt;= 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; ((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= ((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))).<br/>
<span class="tactic">intros</span>.<br/>
<span class="tactic">assert</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">w</span> = <span class="id">plus</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)).<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>. <span class="tactic">rewrite</span> (<span class="id">plus_comm</span> <span class="id">u</span> (<span class="id">opp</span> <span class="id">v</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.compatible.html#plus_assoc_gen">plus_assoc_gen</a></span>. <span class="tactic">rewrite</span> <span class="id">plus_opp_l</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_zero_l</span>. <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span> (<span class="id">plus</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>))).<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) +<br/>
&nbsp;&nbsp;2 * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))) <span class="tactic">at</span> 1.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>; <span class="tactic">intuition</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span><br/>
&nbsp;&nbsp;<span class="kwd">with</span> 2 (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)) 0 <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">intuition</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
<span class="tactic">assert</span> ((<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) = <span class="id">opp</span> (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id">opp_minus</span>. <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H3</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hscal</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span>*<span class="id"><a href="CertRL.converge.LM.hilbert.html#b">b</a></span> = <span class="id">scal</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#b">b</a></span>).<br/>
<span class="tactic">intros</span>; <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hscal</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hminus</span> : <span class="kwd">forall</span> <span class="id">a</span>, -<span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span> = <span class="id">opp</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#a">a</a></span>).<br/>
<span class="tactic">intros</span>; <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hminus</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">scal_opp_r</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hscal</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">intuition</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>))) <span class="tactic">at</span> 1.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="th">th</a></span> (<span class="id">u</span> <span class="id">v</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>)  := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span> 1 ((<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/((<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_convex">charac_ortho_projection_convex</a></span>: <span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="kwd">forall</span> <span class="id">v</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) = <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) &lt;= 0)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1182')">Proof.</div>
<div class="proofscript" id="proof1182">
<span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
+<span class="tactic">intros</span>.<br/>
&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)*<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)) 0).<br/>
&nbsp;- <span class="tactic">assert</span> (1*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)) = 0).<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="id">ring_simplify</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> 2%<span class="id">R</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span>. <span class="tactic">rewrite</span> &lt;-<span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex_aux5">charac_ortho_projection_convex_aux5</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rdichotomy">Rdichotomy</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">absurd</span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) &lt; 0).<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span>. <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>))).<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_dec">Rle_lt_dec</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)) 0).<br/>
&nbsp;&nbsp;&nbsp;* <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;* <span class="id">absurd</span> (0 &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2*(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= (<span class="id"><a href="CertRL.converge.LM.hilbert.html#th">th</a></span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span>)*((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex_aux5">charac_ortho_projection_convex_aux5</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#th">th</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin">Rmin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> 1 (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_l">Rmin_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="CertRL.converge.LM.hilbert.html#th">th</a></span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span>)*((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1 / (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> ((<span class="id"><a href="CertRL.converge.LM.hilbert.html#th">th</a></span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span>) * / 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_1">Rinv_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (1:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rmin_r">Rmin_r</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)) 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">absurd</span> (0 = 0). <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>. <span class="tactic">intuition</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)) 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">absurd</span> (0 = 0). <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>. <span class="tactic">intuition</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (2*(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.hilbert.html#th">th</a></span> <span class="id">u</span> <span class="id">v</span> <span class="id">w</span> * (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>))); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_dec">Rlt_dec</a></span> 0 (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">absurd</span> ( 2 * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_le">Rgt_not_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_gt_compat_r">Rmult_gt_compat_r</a></span>. <span class="tactic">trivial</span>. <span class="id">ring_simplify</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>. <span class="tactic">trivial</span>.<br/>
+<span class="tactic">intros</span>.<br/>
&nbsp;<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))).<br/>
&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>, <span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> = <span class="id">plus</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)).<br/>
&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span>. <span class="tactic">symmetry</span>. <span class="tactic">rewrite</span> (<span class="id">plus_comm</span> <span class="id">u</span> (<span class="id">opp</span> <span class="id">v</span>)).<br/>
&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.compatible.html#plus_assoc_gen">plus_assoc_gen</a></span>. <span class="tactic">rewrite</span> <span class="id">plus_opp_l</span>.<br/>
&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_zero_l</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; ((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))*(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>)) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)))*((<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))))).<br/>
&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> (<span class="id">H2</span> <span class="id">w0</span>).<br/>
&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span> (<span class="id">plus</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w0</span>))).<br/>
&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#square_expansion_plus">square_expansion_plus</a></span>.<br/>
&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>)).<br/>
&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w0</span>)).<br/>
&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>.<br/>
&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))).<br/>
&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#squared_norm">squared_norm</a></span>.<br/>
&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) * <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 (2 * <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w0</span>) * <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span> (<span class="id">minus</span> <span class="id">v</span> <span class="id">w0</span>))).<br/>
&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_le_0_compat">Rplus_le_le_0_compat</a></span>.<br/>
&nbsp;<span class="tactic">assert</span> (2*0 = 0). <span class="id">ring_simplify</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>.<br/>
&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>. <span class="tactic">intuition</span>.<br/>
&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">opp_minus</span> <span class="id">w0</span> <span class="id">v</span>). <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span>.<br/>
&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_cancel">Ropp_le_cancel</a></span>. <span class="id">ring_simplify</span>. <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
&nbsp;<span class="tactic">destruct</span><br/>
&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_dec">Rle_dec</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>)) (<span class="id">norm</span> (<span class="id">plus</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">v</span> <span class="id">w</span>)))).<br/>
&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">H2</span> <span class="id">w</span>) <span class="kwd">in</span> <span class="id">r</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;<span class="id">absurd</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">w</span>) * <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">w</span>)).<br/>
&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_le">Rlt_not_le</a></span>. <span class="tactic">rewrite</span> &lt;- (<span class="id">H2</span> <span class="id">w</span>) <span class="kwd">in</span> <span class="id">n</span>.<br/>
&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_le_lt">Rnot_le_lt</a></span> <span class="kwd">in</span> <span class="id">n</span>.<br/>
&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_0_lt_compat">Rmult_le_0_lt_compat</a></span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>)))<br/>
&nbsp;<span class="kwd">in</span> <span class="id">n</span>; <span class="tactic">trivial</span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#norm_ge_0">norm_ge_0</a></span>.<br/>
&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;<span class="tactic">unfold</span> <span class="id">Glb_Rbar</span>.<br/>
&nbsp;<span class="tactic">destruct</span> (<span class="id">ex_glb_Rbar</span><br/>
&nbsp;(<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))). <span class="tactic">simpl</span>.<br/>
&nbsp;<span class="tactic">unfold</span> <span class="id">is_glb_Rbar</span> <span class="kwd">in</span> <span class="id">i</span>.<br/>
&nbsp;<span class="tactic">unfold</span> <span class="id">is_lb_Rbar</span> <span class="kwd">in</span> <span class="id">i</span>.<br/>
&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>.<br/>
&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.E">E</a></span>,<br/>
&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; (<span class="id">Rbar_le</span> <span class="id">x</span>) (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))).<br/>
&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H2</span>.<br/>
&nbsp;<span class="id">exists</span> <span class="id">w</span>. <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;<span class="tactic">assert</span> (<span class="id">Rbar_le</span> <span class="id">x</span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>))).<br/>
&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>. <span class="id">exists</span> <span class="id">v</span>. <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;<span class="tactic">assert</span> (<span class="id">Rbar_le</span> (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>)) <span class="id">x</span>).<br/>
&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>. <span class="tactic">intros</span>.<br/>
&nbsp;<span class="tactic">destruct</span> <span class="id">H6</span> <span class="kwd">as</span> (<span class="id">w0</span>,(<span class="id">H61</span>,<span class="id">H62</span>)).<br/>
&nbsp;<span class="tactic">rewrite</span> <span class="id">H62</span>. <span class="tactic">apply</span> <span class="id">H1</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;<span class="tactic">apply</span> <span class="id">Rbar_finite_eq</span>.<br/>
&nbsp;<span class="tactic">apply</span> <span class="id">Rbar_le_antisym</span>.<br/>
&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;<span class="tactic">trivial</span>. <span class="tactic">trivial</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;<span class="id">exfalso</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">exfalso</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;<span class="tactic">trivial</span>. <span class="tactic">trivial</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;<span class="id">exfalso</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">exfalso</span>. <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalP">OrthogonalP</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="OrthogonalQ">OrthogonalQ</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="OrthogonalQ.phi">phi</a></span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.E">E</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="OrthogonalQ.phi_mod">phi_mod</a></span>: <span class="id"><a href="CertRL.converge.LM.compatible.html#compatible_m">compatible_m</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="OrthogonalQ.phi_compl">phi_compl</a></span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ortho_projection_subspace">ortho_projection_subspace</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.E">E</a></span>, (<span class="kwd">forall</span> <span class="id">eps</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#posreal">posreal</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Decidable.html#decidable">decidable</a></span> (<span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>) &lt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#eps">eps</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">exists</span>! <span class="id">v</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.E">E</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> /\ <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1183')">Proof.</div>
<div class="proofscript" id="proof1183">
<span class="tactic">intros</span> <span class="id">u</span> <span class="id">Hu</span>.<br/>
<span class="tactic">assert</span> (<span class="id">phi_convex</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span>).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">u0</span> <span class="id">v0</span> <span class="id">t</span> <span class="id">Hu0</span> <span class="id">Hv0</span> <span class="id">Th01</span>.<br/>
<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span> <span class="kwd">as</span> ((<span class="id">g1</span>,(<span class="id">s</span>,<span class="id">g2</span>)),<span class="id">mod2</span>).<br/>
<span class="tactic">assert</span> (<span class="id">H0</span> : <span class="id">scal</span> (1 - <span class="id">t</span>) <span class="id">v0</span> = <span class="id">opp</span> (<span class="id">scal</span> (<span class="id">opp</span> (1 - <span class="id">t</span>)) <span class="id">v0</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id">scal_opp_l</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">opp_opp</span>. <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
<span class="tactic">apply</span> <span class="id">g1</span>.<br/>
<span class="tactic">apply</span> <span class="id">mod2</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id">mod2</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.logic_tricks.html#unique_existence1">unique_existence1</a></span>; <span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id">ortho_projection_convex</span>'; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="id">exists</span> <span class="id">zero</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.converge.LM.compatible.html#compatible_m_zero">compatible_m_zero</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>).<br/>
<span class="tactic">intros</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">Hv</span> <span class="id">Hv</span>'.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_projection_convex_unique">ortho_projection_convex_unique</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id">phi_convex</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_compl">phi_compl</a></span> <span class="id">u</span>); <span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>: <span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="kwd">forall</span> <span class="id">v</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) = <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) &lt;= 0)).<br/>
<span class="tactic">split</span>.<br/>
+ <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex">charac_ortho_projection_convex</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">scal</span> (1 - <span class="id">theta</span>) <span class="id">v0</span> = <span class="id">opp</span> (<span class="id">scal</span> (1 - <span class="id">theta</span>) (<span class="id">opp</span> <span class="id">v0</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">scal_opp_r</span>. <span class="tactic">rewrite</span> <span class="id">opp_opp</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">scal_opp_one</span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">trivial</span>.<br/>
+ <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_convex">charac_ortho_projection_convex</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">scal</span> (1 - <span class="id">theta</span>) <span class="id">v0</span> = <span class="id">opp</span> (<span class="id">scal</span> (1 - <span class="id">theta</span>) (<span class="id">opp</span> <span class="id">v0</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">scal_opp_r</span>. <span class="tactic">rewrite</span> <span class="id">opp_opp</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">scal_opp_one</span>. <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ.phi_mod">phi_mod</a></span>. <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#OrthogonalQ">OrthogonalQ</a></span>.<br/>
<br/>
<div class="doc">Orthogonal complement </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ortho_compl">ortho_compl</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">E</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#PreHilbert">PreHilbert</a></span>}.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="ortho_compl.phi">phi</a></span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="ortho_compl.phi_compat">phi_compat</a></span>: <span class="id"><a href="CertRL.converge.LM.compatible.html#compatible_m">compatible_m</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="ortho_compl.phi_compl">phi_compl</a></span>: <span class="id"><a href="CertRL.converge.LM.hilbert.html#complete_subset">complete_subset</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="orth_compl">orth_compl</a></span> := <span class="kwd">fun</span> <span class="id">x</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span> =&gt; <span class="kwd">forall</span> (<span class="id">y</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>), <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#y">y</a></span> = 0.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="orth_compl_compat">orth_compl_compat</a></span>: <span class="id"><a href="CertRL.converge.LM.compatible.html#compatible_m">compatible_m</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1184')">Proof.</div>
<div class="proofscript" id="proof1184">
<span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">z</span> <span class="id">Hz</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> (<span class="id">H1</span> <span class="id">_</span> <span class="id">Hz</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span>.<br/>
<span class="tactic">rewrite</span> (<span class="id">H2</span> <span class="id">_</span> <span class="id">Hz</span>).<br/>
<span class="tactic">ring</span>.<br/>
<span class="id">exists</span> <span class="id">zero</span>.<br/>
<span class="tactic">intros</span> <span class="id">y</span> <span class="id">Hy</span>; <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">l</span> <span class="id">H1</span> <span class="id">y</span> <span class="id">Hy</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_scal_l">inner_scal_l</a></span>.<br/>
<span class="tactic">rewrite</span> (<span class="id">H1</span> <span class="id">_</span> <span class="id">Hy</span>); <span class="tactic">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="trivial_orth_compl">trivial_orth_compl</a></span> : <span class="kwd">forall</span> <span class="id">u</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, ((<span class="kwd">forall</span> <span class="id">v</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> = 0) &lt;-&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> = <span class="id">zero</span>).<br/>
<span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
<span class="tactic">intro</span> <span class="id">H0</span>. <span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">u</span> = 0). <span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax3">PreHilbert.ax3</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">trivial</span>.<br/>
<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">trivial_orth_compl</span>' : <span class="kwd">forall</span> (<span class="id">phi</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span> -&gt; <span class="kwd">Prop</span>) (<span class="id">u</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">closed</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#phi">phi</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> -&gt; ((<span class="kwd">forall</span> <span class="id">v</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> = 0) &lt;-&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> = <span class="id">zero</span>).<br/>
<span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
<span class="tactic">intro</span> <span class="id">H1</span>. <span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">u</span> = 0). <span class="tactic">apply</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ax3">PreHilbert.ax3</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">trivial</span>.<br/>
<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sumable_with_orth_compl">direct_sumable_with_orth_compl</a></span>: <span class="id"><a href="CertRL.converge.LM.compatible.html#direct_sumable">direct_sumable</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1185')">Proof.</div>
<div class="proofscript" id="proof1185">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="tactic">apply</span>: <span class="id">norm_eq_zero</span>.<br/>
<span class="tactic">unfold</span> <span class="id">norm</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#Hnorm">Hnorm</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id">H2</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_0">sqrt_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="charac_ortho_projection_subspace2">charac_ortho_projection_subspace2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">u</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="kwd">forall</span> <span class="id">v</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>) = <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)).<br/>
<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
+ <span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> <span class="id">v</span>) &lt;= 0).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">w</span>' := <span class="id">plus</span> <span class="id">w</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span> &lt;= 0).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hm1</span> : <span class="id">w</span> = <span class="id">minus</span> <span class="id">w</span>' <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">w</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">plus_assoc</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span>').<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">w</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">G1</span>,(<span class="id">z</span>,<span class="id">G2</span>)),<span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">opp_opp</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">G1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">plus_zero_l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">G1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">M</span> <span class="id">z</span> <span class="id">zero</span>) <span class="kwd">in</span> <span class="id">G2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">scal_zero_l</span> <span class="kwd">in</span> <span class="id">G2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hm1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">w</span>'' := <span class="id">plus</span> (<span class="id">opp</span> <span class="id">w</span>) <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">opp</span> <span class="id">w</span>) &lt;= 0).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hm1</span> : <span class="id">opp</span> <span class="id">w</span> = <span class="id">minus</span> <span class="id">w</span>'' <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">w</span>''.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">plus_assoc</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">w</span>'').<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">w</span>''.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">G1</span>,(<span class="id">z</span>,<span class="id">G2</span>)),<span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_comm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">G1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hm1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">HF</span> : (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span>) &lt;= 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="id">opp</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span>) &lt;= 0)).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_r">inner_opp_r</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">HF</span> <span class="kwd">as</span> (<span class="id">HF1</span>,<span class="id">HF2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span> = 0).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span> <span class="kwd">in</span> <span class="id">HF2</span>.<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">HF2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">opp</span> (<span class="id">opp</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= - (<span class="id">opp</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) <span class="id">w</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H5</span> <span class="kwd">in</span> <span class="id">HF2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">opp_opp</span> <span class="kwd">in</span> <span class="id">HF2</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_opp_r_uniq">Rplus_opp_r_uniq</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">symmetry</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_eq_compat">Ropp_eq_compat</a></span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
+ <span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">G1</span>,(<span class="id">z</span>,<span class="id">G2</span>)),<span class="id">M</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> <span class="id">v</span>) &lt;= 0).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">w</span> <span class="id">phiw</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">w</span>' := <span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">minus</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">w</span>') (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">w</span>')).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">w</span>'. <span class="tactic">unfold</span> <span class="id">minus</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_opp_l">inner_opp_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">w</span>' = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">w</span>').<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">w</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">G1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">minus</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">w</span>') (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">w</span>') = 0).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sum_with_orth_compl">direct_sum_with_orth_compl</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.compatible.html#m_plus">m_plus</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1186')">Proof.</div>
<div class="proofscript" id="proof1186">
<span class="tactic">intros</span> <span class="id">x</span>. <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.compatible.html#m_plus">m_plus</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<span class="id">exists</span> <span class="id">x</span>. <span class="id">exists</span> <span class="id">zero</span>. <span class="tactic">intro</span>. <span class="tactic">intros</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hierarchy.plus_zero_r</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sum_with_orth_compl_decomp">direct_sum_with_orth_compl_decomp</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1187')">Proof.</div>
<div class="proofscript" id="proof1187">
<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span>.<br/>
<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_subspace2">charac_ortho_projection_subspace2</a></span>; <span class="tactic">intuition</span>.<br/>
<span class="tactic">intros</span>.<br/>
<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">v</span> <span class="id">y</span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> <span class="id">u</span> <span class="id">y</span>).<br/>
<span class="tactic">apply</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">unfold</span> <span class="id">minus</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H3</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_plus_l">inner_plus_l</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sum_with_orth_compl_charac1">direct_sum_with_orth_compl_charac1</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> &lt;-&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> = <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span>).<br/>
<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
+ <span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">u</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">u</span> = <span class="id">zero</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span>. <span class="tactic">rewrite</span> <span class="id">plus_opp_r</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#inner_zero_l">inner_zero_l</a></span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">phi_convex</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">u0</span> <span class="id">v0</span> <span class="id">t</span> <span class="id">Hu0</span> <span class="id">Hv0</span> <span class="id">Th01</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">g1</span>,(<span class="id">s</span>,<span class="id">g2</span>)),<span class="id">mod2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H3</span> : <span class="id">scal</span> (1 - <span class="id">t</span>) <span class="id">v0</span> = <span class="id">opp</span> (<span class="id">scal</span> (<span class="id">opp</span> (1 - <span class="id">t</span>)) <span class="id">v0</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">scal_opp_l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">opp_opp</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">g1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mod2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mod2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_projection_convex_unique">ortho_projection_convex_unique</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">phi_convex</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compl">phi_compl</a></span> <span class="id">u</span>).<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>. <span class="tactic">trivial</span>. <span class="tactic">trivial</span>. <span class="tactic">trivial</span>.<br/>
+ <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="direct_sum_with_orth_compl_charac2">direct_sum_with_orth_compl_charac2</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> -&gt; <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">exists</span> <span class="id">w</span>:<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span> /\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#u">u</a></span> &lt;-&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#v">v</a></span> = <span class="id">zero</span>).<br/>
<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
+ <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">zero</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Glb_Rbar</span> (<span class="kwd">fun</span> <span class="id">r</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> =&gt; <span class="id">exists</span> <span class="id">w</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="CertRL.converge.LM.hilbert.html#r">r</a></span> = <span class="id">norm</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#w">w</a></span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#charac_ortho_projection_subspace1">charac_ortho_projection_subspace1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">zero</span> = <span class="id">scal</span> <span class="id">zero</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">scal_zero_l</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H4</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#direct_sum_with_orth_compl_decomp">direct_sum_with_orth_compl_decomp</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.E">E</a></span>, <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.hilbert.html#x">x</a></span> = <span class="id">zero</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#direct_sumable_with_orth_compl">direct_sumable_with_orth_compl</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#orth_compl">orth_compl</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#inner">inner</a></span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">zero</span>) (<span class="id">minus</span> <span class="id">w</span> <span class="id">zero</span>) = 0).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span>. <span class="tactic">rewrite</span> <span class="id">opp_zero</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_zero_r</span>. <span class="tactic">rewrite</span> <span class="id">plus_zero_r</span>. <span class="tactic">apply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>. <span class="tactic">unfold</span> <span class="id">minus</span>. <span class="tactic">rewrite</span> <span class="id">opp_zero</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_zero_r</span>. <span class="tactic">rewrite</span> <span class="id">plus_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">minus</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">rewrite</span> <span class="id">opp_zero</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_zero_r</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">rewrite</span> <span class="id">plus_zero_r</span> <span class="kwd">in</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>; <span class="tactic">intuition</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">phi_convex</span> : <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#convex">convex</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">u0</span> <span class="id">v0</span> <span class="id">t</span> <span class="id">Hu0</span> <span class="id">Hv0</span> <span class="id">Th01</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span> <span class="kwd">as</span> ((<span class="id">g1</span>,(<span class="id">s</span>,<span class="id">g2</span>)),<span class="id">mod2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H3</span> : <span class="id">scal</span> (1 - <span class="id">t</span>) <span class="id">v0</span> = <span class="id">opp</span> (<span class="id">scal</span> (<span class="id">opp</span> (1 - <span class="id">t</span>)) <span class="id">v0</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">scal_opp_l</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">opp_opp</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">g1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mod2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">mod2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_projection_convex_unique">ortho_projection_convex_unique</a></span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi">phi</a></span> <span class="id">phi_convex</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compl">phi_compl</a></span> <span class="id">u</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">zero</span> = <span class="id">scal</span> <span class="id">zero</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">scal_zero_l</span>. <span class="tactic">reflexivity</span>. <span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl.phi_compat">phi_compat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span>. <span class="tactic">apply</span> <span class="id">H5</span>; <span class="tactic">trivial</span>.<br/>
+ <span class="tactic">assert</span> (<span class="id">minus</span> <span class="id">u</span> <span class="id">v</span> = <span class="id">u</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id">minus</span>. <span class="tactic">rewrite</span> <span class="id">opp_zero</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">plus_zero_r</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#direct_sum_with_orth_compl_decomp">direct_sum_with_orth_compl_decomp</a></span>; <span class="tactic">trivial</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.hilbert.html#ortho_compl">ortho_compl</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
