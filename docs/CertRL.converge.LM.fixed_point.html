
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CertRL.converge.LM.fixed_point</title>
<meta name="description" content="Documentation of Coq module CertRL.converge.LM.fixed_point" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CertRL.converge.LM.fixed_point</h1>
<div class="coq">
<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Reals.html">Reals</a></span> <span class="id">Coquelicot.Coquelicot</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="CertRL.converge.LM.R_compl.html">R_compl</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id"><a href="CertRL.converge.LM.logic_tricks.html">logic_tricks</a></span>.<br/>
<br/>
<h1> Fixed Point Theorem without subspaces </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="FixedPoint_1">FixedPoint_1</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">X</span> : <span class="id">UniformSpace</span>}.<br/>
<span class="kwd">Context</span> {<span class="id">Y</span> : <span class="id">UniformSpace</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ball_x">ball_x</a></span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.X">X</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.X">X</a></span> -&gt; <span class="kwd">Prop</span> := <span class="id">UniformSpace.ball</span> <span class="id">_</span> (<span class="id">UniformSpace.class</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.X">X</a></span>).<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ball_y">ball_y</a></span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.Y">Y</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.Y">Y</a></span> -&gt; <span class="kwd">Prop</span> := <span class="id">UniformSpace.ball</span> <span class="id">_</span> (<span class="id">UniformSpace.class</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.Y">Y</a></span>).<br/>
<br/>
<div class="doc">Lispchitz functions </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_Lipschitz">is_Lipschitz</a></span> (<span class="id">f</span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.X">X</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.Y">Y</a></span>) (<span class="id">k</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) :=<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">r</span>, 0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#ball_x">ball_x</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x1">x1</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#r">r</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x2">x2</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#ball_y">ball_y</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x1">x1</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>*<span class="id"><a href="CertRL.converge.LM.fixed_point.html#r">r</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x2">x2</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_contraction">is_contraction</a></span> (<span class="id">f</span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.X">X</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1.Y">Y</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">k</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1 /\ <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz">is_Lipschitz</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1">FixedPoint_1</a></span>.<br/>
<br/>
<div class="doc">Balls and iterations </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="iter_dist">iter_dist</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">X</span> : <span class="id">UniformSpace</span>}.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="iter">iter</a></span> (<span class="id">f</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>) (<span class="id">n</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">x</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>) := <span class="kwd">match</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id">m</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter_aux_aux">dist_iter_aux_aux</a></span>: <span class="kwd">forall</span> (<span class="id">f</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>-&gt;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>) <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">D</span>, 0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1 -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz">is_Lipschitz</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> -&gt; <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> ^ <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> * <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> + 1) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1102')">Proof.</div>
<div class="proofscript" id="proof1102">
<span class="tactic">intros</span> <span class="id">f</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">D</span> (<span class="id">Hk1</span>',<span class="id">Hk2</span>') (<span class="id">_</span>,<span class="id">Hk2</span>) <span class="id">HD</span> <span class="id">H</span>.<br/>
<span class="tactic">induction</span> <span class="id">p</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">simpl</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Hk2</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter_aux">dist_iter_aux</a></span>: <span class="kwd">forall</span> (<span class="id">f</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>-&gt;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>) <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">D</span>, 0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1 -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz">is_Lipschitz</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> -&gt; <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) -&gt; (0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>^<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>*(1-<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>^<span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)/(1-<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>) *<span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span>)  (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>+<span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<span class="tactic">intros</span> <span class="id">f</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">D</span> (<span class="id">Hk1</span>',<span class="id">Hk2</span>') (<span class="id">Hk1</span>,<span class="id">Hk2</span>) <span class="id">HD</span> <span class="id">H</span> <span class="id">Hm</span>.<br/>
<span class="id">case_eq</span> <span class="id">m</span>.<br/>
<span class="tactic">intros</span> <span class="id">Y</span>; <span class="tactic">rewrite</span> <span class="id">Y</span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="id">contradict</span> <span class="id">Hm</span>.<br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">_</span>; <span class="tactic">clear</span> <span class="id">Hm</span>.<br/>
<span class="tactic">induction</span> <span class="id">n</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
<span class="tactic">replace</span> (<span class="id">k</span> ^ <span class="id">p</span> * (1 - <span class="id">k</span>) / (1 - <span class="id">k</span>) * <span class="id">D</span>) <span class="kwd">with</span> (<span class="id">k</span>^<span class="id">p</span>*<span class="id">D</span>).<br/>
2: <span class="id">field</span>.<br/>
2: <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_aux_aux">dist_iter_aux_aux</a></span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">replace</span> (<span class="id">k</span> ^ <span class="id">p</span> * (1 - <span class="id">k</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) / (1 - <span class="id">k</span>) * <span class="id">D</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;((<span class="id">k</span> ^ <span class="id">p</span> * (1 - <span class="id">k</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) / (1 - <span class="id">k</span>) * <span class="id">D</span>)+(<span class="id">k</span> ^ (<span class="id">p</span>+<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) * <span class="id">D</span>)).<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id">f</span> (<span class="id">p</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">a</span>).<br/>
<span class="tactic">exact</span> <span class="id">IHn</span>.<br/>
<span class="tactic">replace</span> (<span class="id">p</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))%<span class="id">nat</span> <span class="kwd">with</span> ((<span class="id">p</span>+<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)+1)%<span class="id">nat</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_aux_aux">dist_iter_aux_aux</a></span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">ring</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_add">pow_add</a></span>.<br/>
<span class="tactic">simpl</span>; <span class="id">field</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter">dist_iter</a></span>: <span class="kwd">forall</span> (<span class="id">f</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>-&gt;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>) <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">D</span>, 0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1 -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz">is_Lipschitz</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> -&gt; <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>^<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>/(1-<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>) *<span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span>)  (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>+<span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1103')">Proof.</div>
<div class="proofscript" id="proof1103">
<span class="tactic">intros</span> <span class="id">f</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">D</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span> <span class="id">H4</span>.<br/>
<span class="id">case_eq</span> <span class="id">m</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Plus.html#plus_0_r">plus_0_r</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">L</span>:(0 &lt; <span class="id">k</span> ^ <span class="id">p</span> / (1 - <span class="id">k</span>) * <span class="id">D</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">replace</span> (<span class="id">k</span> ^ <span class="id">p</span> / (1 - <span class="id">k</span>) * <span class="id">D</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">L</span>)) <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>^<span class="id">p</span>*(1-<span class="id">k</span>^<span class="id">m</span>)/(1-<span class="id">k</span>) *<span class="id">D</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span> (<span class="id">k</span>^<span class="id">p</span>)) <span class="tactic">at</span> 2.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
<span class="id">left</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> (-1).<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
<span class="id">left</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_aux">dist_iter_aux</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="iter_dist.f">f</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="iter_dist.phi">phi</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="iter_dist.phi_f">phi_f</a></span>: <span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi">phi</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="iter_dist.phi_distanceable">phi_distanceable</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#y">y</a></span>-&gt; <span class="id">exists</span> <span class="id">M</span>, 0 &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#M">M</a></span> /\ <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#M">M</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#y">y</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="phi_iter_f">phi_iter_f</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">n</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi">phi</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1104')">Proof.</div>
<div class="proofscript" id="proof1104">
<span class="tactic">intros</span> <span class="id">a</span>; <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">Phi_a</span>.<br/>
<span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi_f">phi_f</a></span>, <span class="id">IHn</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter_aux_zero">dist_iter_aux_zero</a></span>: <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.X">X</a></span>) <span class="id">p</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz">is_Lipschitz</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>)%<span class="id">nat</span> -&gt; (0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) 0 (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1105')">Proof.</div>
<div class="proofscript" id="proof1105">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">p</span> <span class="id">m</span> <span class="id">phi_a</span> (<span class="id">_</span>,<span class="id">H</span>) <span class="id">Hp</span> <span class="id">Hm</span>.<br/>
<span class="id">case_eq</span> <span class="id">p</span>.<br/>
<span class="tactic">intros</span> <span class="id">V</span>; <span class="tactic">rewrite</span> <span class="id">V</span> <span class="kwd">in</span> <span class="id">Hp</span>; <span class="id">now</span> <span class="id">contradict</span> <span class="id">Hp</span>.<br/>
<span class="tactic">intros</span> <span class="id">n1</span> <span class="id">Hn1</span>.<br/>
<span class="id">case_eq</span> <span class="id">m</span>.<br/>
<span class="tactic">intros</span> <span class="id">V</span>; <span class="tactic">rewrite</span> <span class="id">V</span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="id">now</span> <span class="id">contradict</span> <span class="id">Hm</span>.<br/>
<span class="tactic">intros</span> <span class="id">n2</span> <span class="id">Hn2</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi_distanceable">phi_distanceable</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id">n1</span> <span class="id">a</span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id">n2</span> <span class="id">a</span>)) <span class="kwd">as</span> (<span class="id">M</span>,(<span class="id">HM1</span>,<span class="id">HM2</span>)).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="tactic">replace</span> 0 <span class="kwd">with</span> (0*(<span class="id">M</span>+1)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">M</span>+0).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> <span class="id">M</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">M</span>+0).<br/>
<span class="id">right</span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_1">Rle_0_1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter_gen">dist_iter_gen</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">n</span> <span class="id">D</span>, 0 &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1 -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz">is_Lipschitz</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> -&gt; <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) -&gt; (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>)%<span class="id">nat</span> -&gt; (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)%<span class="id">nat</span> -&gt; (0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>^<span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span>/(1-<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>) *<span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1106')">Proof.</div>
<div class="proofscript" id="proof1106">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">n</span> <span class="id">D</span> (<span class="id">H1</span>,<span class="id">H1</span>') <span class="id">H2</span> <span class="id">Phi_a</span> <span class="id">H3</span> <span class="id">H4</span> <span class="id">Hp</span> <span class="id">Hm</span> <span class="id">Hn</span>.<br/>
<span class="tactic">case</span> <span class="id">H1</span>; <span class="tactic">intros</span> <span class="id">P</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Lt.html#le_or_lt">le_or_lt</a></span> <span class="id">p</span> <span class="id">m</span>); <span class="tactic">intros</span> <span class="id">H5</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">replace</span> <span class="id">m</span> <span class="kwd">with</span> (<span class="id">p</span>+(<span class="id">m</span>-<span class="id">p</span>))%<span class="id">nat</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>^<span class="id">p</span>/(1-<span class="id">k</span>) *<span class="id">D</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.R_compl.html#Rle_pow_le">Rle_pow_le</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">left</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter">dist_iter</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html#le_plus_minus_r">le_plus_minus_r</a></span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span>.<br/>
<span class="tactic">replace</span> <span class="id">p</span> <span class="kwd">with</span> (<span class="id">m</span>+(<span class="id">p</span>-<span class="id">m</span>))%<span class="id">nat</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>^<span class="id">m</span>/(1-<span class="id">k</span>) *<span class="id">D</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.R_compl.html#Rle_pow_le">Rle_pow_le</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter">dist_iter</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html#le_plus_minus_r">le_plus_minus_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Lt.html#lt_le_weak">lt_le_weak</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> 0.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">P</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#pow_i">pow_i</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_aux_zero">dist_iter_aux_zero</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">P</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Lt.html#lt_le_trans">lt_le_trans</a></span> <span class="kwd">with</span> <span class="id">n</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Lt.html#lt_le_trans">lt_le_trans</a></span> <span class="kwd">with</span> <span class="id">n</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist">iter_dist</a></span>.<br/>
<br/>
<div class="doc">My_complete </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="closed_compl">closed_compl</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">X</span> : <span class="id">CompleteSpace</span>}.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="lim">lim</a></span> : ((<span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl.X">X</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>) -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl.X">X</a></span> := <span class="id">CompleteSpace.lim</span> <span class="id">_</span> (<span class="id">CompleteSpace.class</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl.X">X</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="my_complete">my_complete</a></span> (<span class="id">phi</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl.X">X</a></span>-&gt;<span class="kwd">Prop</span>) := (<span class="kwd">forall</span> (<span class="id">F</span>:(<span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl.X">X</a></span> -&gt; <span class="kwd">Prop</span>) -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ProperFilter</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#F">F</a></span> -&gt; <span class="id">cauchy</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#F">F</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">P</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#F">F</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> -&gt; ~~(<span class="id">exists</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> /\ <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>)) -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi">phi</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#F">F</a></span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="closed_my_complete">closed_my_complete</a></span>: <span class="kwd">forall</span> <span class="id">phi</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">closed</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi">phi</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#my_complete">my_complete</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi">phi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1107')">Proof.</div>
<div class="proofscript" id="proof1107">
<span class="tactic">intros</span> <span class="id">phi</span> <span class="id">phi_closed</span> <span class="id">F</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">H3</span>.<br/>
<span class="tactic">generalize</span> (@<span class="id">complete_cauchy</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl.X">X</a></span> <span class="id">F</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
<span class="tactic">intros</span> <span class="id">H4</span>.<br/>
<span class="tactic">unfold</span> <span class="id">closed</span> <span class="kwd">in</span> *; <span class="tactic">unfold</span> <span class="id">open</span> <span class="kwd">in</span> *.<br/>
<span class="comment">(*apply&nbsp;H5.*)</span><br/>
<span class="tactic">apply</span> <span class="id">phi_closed</span>.<br/>
<span class="tactic">intros</span> <span class="id">H6</span>'.<br/>
<span class="tactic">destruct</span> <span class="id">H6</span>' <span class="kwd">as</span> (<span class="id">eps</span>,<span class="id">H6</span>).<br/>
<span class="id">specialize</span> (<span class="id">H3</span> (<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span> <span class="id">F</span>) <span class="id">eps</span>)).<br/>
<span class="tactic">apply</span> <span class="id">H3</span>.<br/>
<span class="tactic">apply</span> <span class="id">H4</span>.<br/>
<span class="tactic">intros</span> (<span class="id">y</span>,(<span class="id">Hy1</span>,<span class="id">Hy2</span>)).<br/>
<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">y</span> <span class="id">Hy1</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">H6</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl">closed_compl</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="closed_compl2">closed_compl2</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">X</span> : <span class="id">CompleteNormedModule</span> <span class="id">R_AbsRing</span>}.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="closed_compl2.phi">phi</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl2.X">X</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="my_complete_closed">my_complete_closed</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#my_complete">my_complete</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl2.phi">phi</a></span> -&gt; <span class="id">closed</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl2.phi">phi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1108')">Proof.</div>
<div class="proofscript" id="proof1108">
<span class="tactic">intros</span> <span class="id">H</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
<span class="id">pose</span> (<span class="id">F</span>:= <span class="id">locally</span> <span class="id">x</span>).<br/>
<span class="tactic">assert</span> (<span class="id">ProperFilter</span> <span class="id">F</span>).<br/>
<span class="tactic">apply</span> <span class="id">locally_filter</span>.<br/>
<span class="tactic">assert</span> (<span class="id">cauchy</span> <span class="id">F</span>).<br/>
<span class="tactic">intros</span> <span class="id">e</span>; <span class="tactic">unfold</span> <span class="id">F</span>.<br/>
<span class="id">exists</span> <span class="id">x</span>.<br/>
<span class="id">now</span> <span class="id">exists</span> <span class="id">e</span>.<br/>
<span class="tactic">replace</span> <span class="id">x</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span> <span class="id">F</span>).<br/>
<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">unfold</span> <span class="id">F</span>; <span class="tactic">intros</span> <span class="id">P</span> <span class="id">T1</span> <span class="id">T2</span>.<br/>
<span class="tactic">destruct</span> <span class="id">T1</span> <span class="kwd">as</span> (<span class="id">e</span>,<span class="id">He</span>).<br/>
<span class="tactic">apply</span> <span class="id">Hx</span>.<br/>
<span class="id">exists</span> <span class="id">e</span>.<br/>
<span class="tactic">intros</span> <span class="id">y</span> <span class="id">Hy1</span> <span class="id">Hy2</span>.<br/>
<span class="tactic">apply</span> <span class="id">T2</span>.<br/>
<span class="id">exists</span> <span class="id">y</span>; <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">He</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#sym_eq">sym_eq</a></span>, <span class="id">eq_close</span>.<br/>
<span class="tactic">intros</span> <span class="id">e</span>.<br/>
<span class="tactic">generalize</span> (<span class="id">complete_cauchy</span> <span class="id">F</span> <span class="id">H0</span> <span class="id">H1</span> <span class="id">e</span>).<br/>
<span class="tactic">unfold</span> <span class="id">F</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">intros</span> (<span class="id">ee</span>,<span class="id">Hee</span>).<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span>.<br/>
<span class="tactic">apply</span> <span class="id">Hee</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#closed_compl2">closed_compl2</a></span>.<br/>
<br/>
<div class="doc">Fixed Point Theorem </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="FixedPoint_2">FixedPoint_2</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">X</span> : <span class="id">CompleteSpace</span>}.<br/>
<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="FixedPoint_2.f">f</a></span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>-&gt;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>).<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="FixedPoint_2.phi">phi</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_2.phi_f">phi_f</a></span>: <span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_2.phi_distanceable">phi_distanceable</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#y">y</a></span>-&gt; <span class="id">exists</span> <span class="id">M</span>, 0 &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#M">M</a></span> /\ <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#M">M</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#y">y</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FixedPoint_uniqueness_weak">FixedPoint_uniqueness_weak</a></span>: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction">is_contraction</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">close</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1109')">Proof.</div>
<div class="proofscript" id="proof1109">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">k</span>,(<span class="id">Hk1</span>,(<span class="id">Hk2</span>,<span class="id">Hf</span>))) <span class="id">Phi_a</span> <span class="id">Phi_b</span> <span class="id">Ha</span> <span class="id">Hb</span> <span class="id">eps</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi_distanceable">phi_distanceable</a></span> <span class="id">a</span> <span class="id">b</span>) <span class="kwd">as</span> (<span class="id">M</span>,(<span class="id">HM1</span>,<span class="id">HM2</span>)); <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">destruct</span> <span class="id">HM1</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">pose</span> (<span class="id">k</span>' := (<span class="id">k</span> + 1)/2).<br/>
<span class="tactic">assert</span> (<span class="id">k</span> &lt; <span class="id">k</span>').<br/>
<span class="tactic">unfold</span> <span class="id">k</span>'; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> <span class="kwd">with</span> 2%<span class="id">R</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Rplus_lt_reg_l</span> <span class="kwd">with</span> (-<span class="id">k</span>).<br/>
<span class="tactic">replace</span> (-<span class="id">k</span>+2*<span class="id">k</span>) <span class="kwd">with</span> <span class="id">k</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
<span class="tactic">replace</span> (-<span class="id">k</span> + 2 * ((<span class="id">k</span> + 1) / 2)) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="id">field</span>.<br/>
<span class="tactic">assumption</span>.<br/>
<span class="tactic">assert</span> (0 &lt; <span class="id">k</span>' &lt; 1).<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> <span class="id">k</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span>'; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> <span class="kwd">with</span> 2%<span class="id">R</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Rplus_lt_reg_l</span> <span class="kwd">with</span> (-1).<br/>
<span class="tactic">replace</span> (-1+2*1) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
<span class="tactic">replace</span> (-1 + 2 * ((<span class="id">k</span> + 1) / 2)) <span class="kwd">with</span> <span class="id">k</span> <span class="tactic">by</span> <span class="id">field</span>.<br/>
<span class="tactic">assumption</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.converge.LM.R_compl.html#contraction_lt_any">contraction_lt_any</a></span> <span class="id">k</span>' (<span class="id">eps</span>/<span class="id">M</span>)) <span class="kwd">as</span> (<span class="id">N</span>,<span class="id">HN</span>).<br/>
<span class="id">now</span> (<span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">left</span>).<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">destruct</span> <span class="id">eps</span>; <span class="tactic">simpl</span>; <span class="id">easy</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">M</span>*<span class="id">k</span>'^<span class="id">N</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> <span class="kwd">with</span> (/<span class="id">M</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">HN</span>).<br/>
<span class="id">right</span>; <span class="id">field</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">clear</span> <span class="id">HN</span>; <span class="tactic">induction</span> <span class="id">N</span>.<br/>
<span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
<span class="tactic">assumption</span>.<br/>
<span class="tactic">assert</span> (<span class="id">L</span>:(0 &lt; <span class="id">M</span>*<span class="id">k</span>'^<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">N</span>*(<span class="id">k</span>'-<span class="id">k</span>)/2)).<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="id">specialize</span> (<span class="id">Ha</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">L</span>)).<br/>
<span class="id">specialize</span> (<span class="id">Hb</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">L</span>)).<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> ((<span class="id">M</span> * <span class="id">k</span>' ^ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">N</span>) * (<span class="id">k</span>' - <span class="id">k</span>) / 2) + ((<span class="id">k</span>*(<span class="id">M</span> * <span class="id">k</span>' ^ <span class="id">N</span>)) + (<span class="id">M</span> * <span class="id">k</span>' ^ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">N</span>) * (<span class="id">k</span>' - <span class="id">k</span>) / 2))).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> ((<span class="id">k</span>'*(<span class="id">k</span>' - <span class="id">k</span>)  + <span class="id">k</span>)*<span class="id">M</span>*<span class="id">k</span>'^<span class="id">N</span>).<br/>
<span class="id">right</span>; <span class="id">field</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">k</span>'*<span class="id">M</span>*<span class="id">k</span>'^<span class="id">N</span>).<br/>
2: <span class="id">right</span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">left</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> (-<span class="id">k</span>'*(<span class="id">k</span>'-<span class="id">k</span>)-<span class="id">k</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> 0.<br/>
<span class="id">right</span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> ((<span class="id">k</span>-1)/2)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
<span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>, <span class="id">k</span>'.<br/>
<span class="id">field</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span>, <span class="id">Ha</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id">b</span>).<br/>
<span class="tactic">apply</span> <span class="id">Hf</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Hb</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> <span class="id">M</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">eps</span>; <span class="tactic">simpl</span>; <span class="id">left</span>; <span class="id">easy</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Fixed_Point_aux_Proper">Fixed_Point_aux_Proper</a></span>: <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ProperFilter</span> (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1110')">Proof.</div>
<div class="proofscript" id="proof1110">
<span class="tactic">intros</span> <span class="id">a</span>; <span class="tactic">split</span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> (<span class="id">N</span>,<span class="id">HN</span>).<br/>
<span class="id">exists</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id">N</span> <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id">HN</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">exists</span> 0%<span class="id">nat</span>; <span class="id">easy</span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> (<span class="id">N1</span>,<span class="id">H1</span>) (<span class="id">N2</span>,<span class="id">H2</span>).<br/>
<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#max">max</a></span> <span class="id">N1</span> <span class="id">N2</span>).<br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">Hn</span>; <span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_trans">le_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">Hn</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#le_max_l">Max.le_max_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_trans">le_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">Hn</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#le_max_r">Max.le_max_r</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">H</span> (<span class="id">N</span>,<span class="id">HN</span>).<br/>
<span class="id">exists</span> <span class="id">N</span>.<br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">HN</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Fixed_Point_aux_cauchy">Fixed_Point_aux_cauchy</a></span>: <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction">is_contraction</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt; <span class="id">cauchy</span> (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>))).<br/>
<span class="tactic">intros</span> <span class="id">a</span> (<span class="id">k</span>,(<span class="id">Hk1</span>,(<span class="id">Hk2</span>,<span class="id">Hf</span>))) <span class="id">Phi_a</span>.<br/>
<span class="tactic">generalize</span> (@<span class="id">cauchy_distance</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span> <span class="id">_</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_Proper">Fixed_Point_aux_Proper</a></span> <span class="id">a</span>)).<br/>
<span class="tactic">unfold</span> <span class="id">cauchy</span>; <span class="tactic">intros</span> (<span class="id">_</span>,<span class="id">T</span>); <span class="tactic">apply</span> <span class="id">T</span>; <span class="tactic">clear</span> <span class="id">T</span>.<br/>
<span class="tactic">intros</span> <span class="id">eps</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi_distanceable">phi_distanceable</a></span> <span class="id">a</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id">a</span>)) <span class="kwd">as</span> (<span class="id">M</span>,(<span class="id">HM1</span>,<span class="id">HM2</span>)).<br/>
<span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi_f">phi_f</a></span>.<br/>
<span class="tactic">destruct</span> <span class="id">HM1</span>.<br/>
<span class="tactic">destruct</span> (<span class="id">contraction_lt_any</span>' <span class="id">k</span> (<span class="id">eps</span>/<span class="id">M</span>*(1-<span class="id">k</span>)*/3)) <span class="kwd">as</span> (<span class="id">n</span>,(<span class="id">Hn</span>',<span class="id">Hn</span>)).<br/>
<span class="id">now</span> <span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">destruct</span> <span class="id">eps</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">exists</span> <span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>, (<span class="id">n</span> &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)%<span class="id">nat</span> /\ <span class="id">close</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span> <span class="id">a</span>)).<br/>
<span class="tactic">split</span>.<br/>
<span class="id">exists</span> <span class="id">n</span>.<br/>
<span class="tactic">intros</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">exists</span> <span class="id">l</span>; <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">intros</span> <span class="id">E</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
<span class="tactic">intros</span> <span class="id">u</span> <span class="id">v</span> (<span class="id">n1</span>,(<span class="id">Hn1</span>,<span class="id">Hu</span>)) (<span class="id">n2</span>,(<span class="id">Hn2</span>,<span class="id">Hv</span>)).<br/>
<span class="tactic">assert</span> (<span class="id">L</span>:(0 &lt; <span class="id">eps</span>/3)).<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>.<br/>
<span class="tactic">destruct</span> <span class="id">eps</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">pose</span> (<span class="id">e</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">L</span>).<br/>
<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e</span>+(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e</span>+<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e</span>))%<span class="id">R</span> <span class="tactic">by</span> (<span class="tactic">simpl</span>;<span class="id">field</span>).<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id">n1</span> <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id">Hu</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id">n2</span> <span class="id">a</span>).<br/>
2: <span class="tactic">apply</span> <span class="id">ball_sym</span>, <span class="id">Hv</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span> ^ <span class="id">n</span> / (1 - <span class="id">k</span>) * <span class="id">M</span>).<br/>
<span class="tactic">unfold</span> <span class="id">e</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> (/<span class="id">M</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> (1-<span class="id">k</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">eps</span> / <span class="id">M</span> * (1 - <span class="id">k</span>) * / 3).<br/>
2: <span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">ring</span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">Hn</span>).<br/>
<span class="id">right</span>; <span class="id">field</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_gen">dist_iter_gen</a></span> <span class="kwd">with</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">split</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span> <span class="kwd">in</span> <span class="id">HM2</span>.<br/>
<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id">a</span>) <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.logic_tricks.html#strong_induction">strong_induction</a></span> <span class="kwd">with</span> (<span class="id">P</span>:= <span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id">a</span>) <span class="id">a</span>).<br/>
<span class="tactic">intros</span> <span class="id">n</span>; <span class="tactic">case</span> <span class="id">n</span>.<br/>
<span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">_</span>.<br/>
<span class="tactic">intros</span> <span class="id">e</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
<span class="tactic">clear</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">n</span>; <span class="tactic">case</span> <span class="id">n</span>.<br/>
<span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">intros</span> <span class="id">e</span>; <span class="tactic">apply</span> <span class="id">ball_sym</span>, <span class="id">ball_le</span> <span class="kwd">with</span> 0; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">left</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="tactic">clear</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">n</span> <span class="id">IH</span>.<br/>
<span class="tactic">apply</span> <span class="id">close_trans</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">a</span>).<br/>
2: <span class="tactic">apply</span> <span class="id">IH</span>.<br/>
2: <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">e</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>*<span class="id">e</span>).<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> <span class="id">e</span>) <span class="tactic">at</span> 2.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">left</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">apply</span> <span class="id">Hf</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">L</span>:(<span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">a</span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id">n</span> <span class="id">a</span>))).<br/>
<span class="tactic">apply</span> <span class="id">close_trans</span> <span class="kwd">with</span> <span class="id">a</span>.<br/>
<span class="tactic">apply</span> <span class="id">IH</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">close_sym</span>.<br/>
<span class="tactic">apply</span> <span class="id">IH</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_S">le_S</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">L</span>.<br/>
<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">close</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> <span class="id">a</span>).<br/>
<span class="tactic">split</span>.<br/>
<span class="id">exists</span> 0%<span class="id">nat</span>.<br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
<span class="tactic">intros</span> <span class="id">u</span> <span class="id">v</span> <span class="id">Hu</span> <span class="id">Hv</span>.<br/>
<span class="tactic">assert</span> (<span class="id">close</span> <span class="id">u</span> <span class="id">v</span>).<br/>
<span class="tactic">apply</span> <span class="id">close_trans</span> <span class="kwd">with</span> <span class="id">a</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">close_sym</span>.<br/>
<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FixedPoint_aux1">FixedPoint_aux1</a></span>: <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction">is_contraction</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span>  <span class="id">x</span> := <span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span>  (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1111')">Proof.</div>
<div class="proofscript" id="proof1111">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">Hf</span> <span class="id">Phi_a</span> <span class="id">x</span>.<br/>
<span class="tactic">generalize</span> (<span class="id">complete_cauchy</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id">a</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_Proper">Fixed_Point_aux_Proper</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_cauchy">Fixed_Point_aux_cauchy</a></span> <span class="id">a</span> <span class="id">Hf</span> <span class="id">Phi_a</span>)).<br/>
<span class="tactic">replace</span> ((<span class="id">Hierarchy.lim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">P</span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span> -&gt; <span class="kwd">Prop</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n0">n0</a></span> <span class="id">a</span>))))) <span class="kwd">with</span> <span class="id">x</span> <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">intros</span> <span class="id">H</span> <span class="id">eps</span>.<br/>
<span class="id">pose</span> (<span class="id">e2</span> :=<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> (<span class="id">is_pos_div_2</span> <span class="id">eps</span>)).<br/>
<span class="id">specialize</span> (<span class="id">H</span> <span class="id">e2</span>).<br/>
<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">n</span>,<span class="id">Hn</span>).<br/>
<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e2</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e2</span>).<br/>
2: <span class="tactic">simpl</span>; <span class="id">field</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_S">le_S</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">destruct</span> <span class="id">Hf</span> <span class="kwd">as</span> (<span class="id">k</span>,(<span class="id">Hk1</span>,(<span class="id">Hk2</span>,<span class="id">Hk3</span>))).<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>*<span class="id">e2</span>).<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> <span class="id">e2</span>) <span class="tactic">at</span> 2.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="tactic">destruct</span> <span class="id">e2</span>; <span class="id">left</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id">Hk3</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">e2</span>).<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span>.<br/>
<span class="tactic">apply</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_2.phi_X_not_empty">phi_X_not_empty</a></span>: <span class="id">exists</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_2.phi_closed">phi_closed</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#my_complete">my_complete</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FixedPoint_aux2">FixedPoint_aux2</a></span>: <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction">is_contraction</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span>  <span class="id">x</span> := <span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span><br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1112')">Proof.</div>
<div class="proofscript" id="proof1112">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">Hf</span> <span class="id">Phi_a</span> <span class="id">x</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi_closed">phi_closed</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_Proper">Fixed_Point_aux_Proper</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_cauchy">Fixed_Point_aux_cauchy</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> (<span class="id">N</span>,<span class="id">HN</span>).<br/>
<span class="tactic">intros</span> <span class="id">K</span>; <span class="tactic">apply</span> <span class="id">K</span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id">N</span> <span class="id">a</span>).<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id">HN</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="FixedPoint_C">FixedPoint_C</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction">is_contraction</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.X">X</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> -&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> -&gt; <span class="id">close</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span>  (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>)))) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1113')">Proof.</div>
<div class="proofscript" id="proof1113">
<span class="tactic">intros</span> <span class="id">Hf</span>.<br/>
<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.phi_X_not_empty">phi_X_not_empty</a></span> <span class="kwd">as</span> (<span class="id">a</span>, <span class="id">Ha</span>).<br/>
<span class="id">exists</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span> (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id">a</span>)))).<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux2">FixedPoint_aux2</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux1">FixedPoint_aux1</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">intros</span> <span class="id">b</span> <span class="id">Phi_b</span> <span class="id">Hb</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_uniqueness_weak">FixedPoint_uniqueness_weak</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux2">FixedPoint_aux2</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux1">FixedPoint_aux1</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Phi_x</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_uniqueness_weak">FixedPoint_uniqueness_weak</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux2">FixedPoint_aux2</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux2">FixedPoint_aux2</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux1">FixedPoint_aux1</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux1">FixedPoint_aux1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2">FixedPoint_2</a></span>.<br/>
<br/>
<div class="doc">Fixed Point Theorem without norms </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="FixedPoint_Normed">FixedPoint_Normed</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="FixedPoint_Normed.K">K</a></span> : <span class="id">AbsRing</span>.<br/>
<span class="kwd">Context</span> {<span class="id">X</span> : <span class="id">CompleteNormedModule</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.K">K</a></span>}.<br/>
<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="FixedPoint_Normed.f">f</a></span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.X">X</a></span>-&gt;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.X">X</a></span>).<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="FixedPoint_Normed.phi">phi</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.X">X</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_Normed.phi_f">phi_f</a></span>: <span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.X">X</a></span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.phi">phi</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_Normed.phi_X_not_empty">phi_X_not_empty</a></span>: <span class="id">exists</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_Normed.phi_closed">phi_closed</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#my_complete">my_complete</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.phi">phi</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="FixedPoint">FixedPoint</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction">is_contraction</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.X">X</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> = <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> = <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> = <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span>  (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>))) = <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1114')">Proof.</div>
<div class="proofscript" id="proof1114">
<span class="tactic">intros</span> <span class="id">Hf</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_C">FixedPoint_C</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed.phi">phi</a></span>) <span class="kwd">as</span> (<span class="id">a</span>,<span class="id">Ha</span>); <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">_</span> <span class="id">_</span>.<br/>
<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_or_eq_dec">Rle_lt_or_eq_dec</a></span> 0 (<span class="id">norm</span> (<span class="id">minus</span> <span class="id">y</span> <span class="id">x</span>))).<br/>
<span class="tactic">apply</span> <span class="id">norm_ge_0</span>.<br/>
<span class="tactic">intros</span> <span class="id">H1</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="id">Y</span>: 0 &lt; 2*<span class="id">norm</span> (<span class="id">minus</span> <span class="id">y</span> <span class="id">x</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>; <span class="tactic">assumption</span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">Y</span>).<br/>
<span class="tactic">split</span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">apply</span> (<span class="id">norm_compat1</span> <span class="id">x</span> <span class="id">y</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id">Rplus_lt_reg_r</span> <span class="kwd">with</span> (-<span class="id">norm</span> (<span class="id">minus</span> <span class="id">y</span> <span class="id">x</span>)).<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">H1</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_minus">Rle_minus</a></span>.<br/>
<span class="id">right</span>; <span class="tactic">reflexivity</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">intros</span> <span class="id">H1</span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>).<br/>
<span class="tactic">split</span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">replace</span> <span class="id">x</span> <span class="kwd">with</span> <span class="id">y</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
<span class="tactic">apply</span> <span class="id">plus_reg_r</span> <span class="kwd">with</span> (<span class="id">opp</span> <span class="id">x</span>).<br/>
<span class="tactic">rewrite</span> <span class="id">plus_opp_r</span>.<br/>
<span class="tactic">apply</span> (<span class="id">norm_eq_zero</span> (<span class="id">plus</span> <span class="id">y</span> (<span class="id">opp</span> <span class="id">x</span>))).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#sym_eq">sym_eq</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">destruct</span> <span class="id">Ha</span> <span class="kwd">as</span> (<span class="id">Ha1</span>,(<span class="id">Ha2</span>,(<span class="id">Ha3</span>,<span class="id">Ha4</span>))).<br/>
<span class="id">exists</span> <span class="id">a</span>.<br/>
<span class="tactic">split</span>; [<span class="tactic">assumption</span>|<span class="tactic">split</span>].<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">eq_close</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">intros</span> <span class="id">b</span> <span class="id">Hb1</span> <span class="id">Hb2</span>.<br/>
<span class="tactic">apply</span> <span class="id">eq_close</span>, <span class="id">Ha3</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hb2</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id">close_refl</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
<span class="tactic">apply</span> <span class="id">eq_close</span>, <span class="id">Ha4</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_Normed">FixedPoint_Normed</a></span>.<br/>
<br/>
<h1> Fixed Point Theorem with subsets </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="FixedPoint_1_sub">FixedPoint_1_sub</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">X</span> : <span class="id">UniformSpace</span>}.<br/>
<span class="kwd">Context</span> {<span class="id">Y</span> : <span class="id">UniformSpace</span>}.<br/>
<br/>
<div class="doc">Lispchitz functions with subsets </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_Lipschitz_phi">is_Lipschitz_phi</a></span> (<span class="id">f</span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1_sub.X">X</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1_sub.Y">Y</a></span>) (<span class="id">k</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span>) (<span class="id">P</span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1_sub.X">X</a></span> -&gt; <span class="kwd">Prop</span>) :=<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">r</span>, 0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#r">r</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x1">x1</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x2">x2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#ball_x">ball_x</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x1">x1</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#r">r</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x2">x2</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#ball_y">ball_y</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x1">x1</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>*<span class="id"><a href="CertRL.converge.LM.fixed_point.html#r">r</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x2">x2</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_contraction_phi">is_contraction_phi</a></span> (<span class="id">f</span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1_sub.X">X</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1_sub.Y">Y</a></span>) (<span class="id">P</span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1_sub.X">X</a></span> -&gt; <span class="kwd">Prop</span>) :=<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">k</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1 /\ <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz_phi">is_Lipschitz_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_1_sub">FixedPoint_1_sub</a></span>.<br/>
<br/>
<div class="doc">Balls and iterations with subsets </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="iter_dist_sub">iter_dist_sub</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">X</span> : <span class="id">UniformSpace</span>}.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter_aux_aux_phi">dist_iter_aux_aux_phi</a></span>: <span class="kwd">forall</span> (<span class="id">f</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>-&gt;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>) (<span class="id">P</span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">D</span>, 0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1<br/>
&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> <span class="id">p</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>)) -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz_phi">is_Lipschitz_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> -&gt; 0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> -&gt; <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> ^ <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> * <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> + 1) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1115')">Proof.</div>
<div class="proofscript" id="proof1115">
<span class="tactic">intros</span> <span class="id">f</span> <span class="id">P</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">D</span> (<span class="id">Hk1</span>',<span class="id">Hk2</span>') <span class="id">HH</span> (<span class="id">_</span>,<span class="id">Hk2</span>) <span class="id">HD</span> <span class="id">H</span>.<br/>
<span class="tactic">induction</span> <span class="id">p</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">simpl</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Hk2</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">HH</span>.<br/>
<span class="tactic">apply</span> <span class="id">HH</span>.<br/>
<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter_aux_phi">dist_iter_aux_phi</a></span> : <span class="kwd">forall</span> (<span class="id">f</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>-&gt;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>) (<span class="id">P</span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">D</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1 -&gt;  (<span class="kwd">forall</span> <span class="id">p</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>)) -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz_phi">is_Lipschitz_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> -&gt; <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) -&gt; (0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>^<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>*(1-<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>^<span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)/(1-<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>) *<span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span>)  (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>+<span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<span class="tactic">intros</span> <span class="id">f</span> <span class="id">P</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">D</span> (<span class="id">Hk1</span>',<span class="id">Hk2</span>') <span class="id">HH</span> (<span class="id">Hk1</span>,<span class="id">Hk2</span>) <span class="id">HD</span> <span class="id">H</span> <span class="id">Hm</span>.<br/>
<span class="id">case_eq</span> <span class="id">m</span>.<br/>
<span class="tactic">intros</span> <span class="id">Y</span>; <span class="tactic">rewrite</span> <span class="id">Y</span> <span class="kwd">in</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="id">contradict</span> <span class="id">Hm</span>.<br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">_</span>; <span class="tactic">clear</span> <span class="id">Hm</span>.<br/>
<span class="tactic">induction</span> <span class="id">n</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
<span class="tactic">replace</span> (<span class="id">k</span> ^ <span class="id">p</span> * (1 - <span class="id">k</span>) / (1 - <span class="id">k</span>) * <span class="id">D</span>) <span class="kwd">with</span> (<span class="id">k</span>^<span class="id">p</span>*<span class="id">D</span>).<br/>
2: <span class="id">field</span>.<br/>
2: <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_aux_aux_phi">dist_iter_aux_aux_phi</a></span> <span class="kwd">with</span> <span class="id">P</span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">replace</span> (<span class="id">k</span> ^ <span class="id">p</span> * (1 - <span class="id">k</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)) / (1 - <span class="id">k</span>) * <span class="id">D</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;((<span class="id">k</span> ^ <span class="id">p</span> * (1 - <span class="id">k</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) / (1 - <span class="id">k</span>) * <span class="id">D</span>)+(<span class="id">k</span> ^ (<span class="id">p</span>+<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) * <span class="id">D</span>)).<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id">f</span> (<span class="id">p</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">a</span>).<br/>
<span class="tactic">exact</span> <span class="id">IHn</span>.<br/>
<span class="tactic">replace</span> (<span class="id">p</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>))%<span class="id">nat</span> <span class="kwd">with</span> ((<span class="id">p</span>+<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>)+1)%<span class="id">nat</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_aux_aux_phi">dist_iter_aux_aux_phi</a></span> <span class="kwd">with</span> <span class="id">P</span>; <span class="tactic">try</span> <span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">ring</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_add">pow_add</a></span>.<br/>
<span class="tactic">simpl</span>; <span class="id">field</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter_phi">dist_iter_phi</a></span>: <span class="kwd">forall</span> (<span class="id">f</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>-&gt;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>) (<span class="id">P</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>-&gt; <span class="kwd">Prop</span>) <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">D</span>, 0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; (<span class="kwd">forall</span> <span class="id">p</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>)) -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz_phi">is_Lipschitz_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> -&gt; <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>^<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>/(1-<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>) *<span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span>)  (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#f">f</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>+<span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1116')">Proof.</div>
<div class="proofscript" id="proof1116">
<span class="tactic">intros</span> <span class="id">f</span> <span class="id">P</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">D</span> <span class="id">H1</span> <span class="id">H2</span> <span class="id">HH</span> <span class="id">H3</span> <span class="id">H4</span>.<br/>
<span class="id">case_eq</span> <span class="id">m</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Plus.html#plus_0_r">plus_0_r</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">L</span>:(0 &lt; <span class="id">k</span> ^ <span class="id">p</span> / (1 - <span class="id">k</span>) * <span class="id">D</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">replace</span> (<span class="id">k</span> ^ <span class="id">p</span> / (1 - <span class="id">k</span>) * <span class="id">D</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">L</span>)) <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>^<span class="id">p</span>*(1-<span class="id">k</span>^<span class="id">m</span>)/(1-<span class="id">k</span>) *<span class="id">D</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span> (<span class="id">k</span>^<span class="id">p</span>)) <span class="tactic">at</span> 2.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
<span class="id">left</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> (-1).<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
<span class="id">left</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_aux_phi">dist_iter_aux_phi</a></span> <span class="kwd">with</span> <span class="id">P</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="iter_dist_sub.f">f</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="iter_dist_sub.phi">phi</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="iter_dist_sub.phi_f">phi_f</a></span>: <span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="iter_dist_sub.phi_distanceable">phi_distanceable</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#y">y</a></span>-&gt; <span class="id">exists</span> <span class="id">M</span>, 0 &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#M">M</a></span> /\ <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#M">M</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#y">y</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter_aux_zero_phi">dist_iter_aux_zero_phi</a></span> : <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.X">X</a></span>) <span class="id">p</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz_phi">is_Lipschitz_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> 0 <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>)%<span class="id">nat</span> -&gt; (0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) 0 (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1117')">Proof.</div>
<div class="proofscript" id="proof1117">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">p</span> <span class="id">m</span> <span class="id">phi_a</span> (<span class="id">_</span>,<span class="id">H</span>) <span class="id">Hp</span> <span class="id">Hm</span>.<br/>
<span class="id">case_eq</span> <span class="id">p</span>.<br/>
<span class="tactic">intros</span> <span class="id">V</span>; <span class="tactic">rewrite</span> <span class="id">V</span> <span class="kwd">in</span> <span class="id">Hp</span>; <span class="id">now</span> <span class="id">contradict</span> <span class="id">Hp</span>.<br/>
<span class="tactic">intros</span> <span class="id">n1</span> <span class="id">Hn1</span>.<br/>
<span class="id">case_eq</span> <span class="id">m</span>.<br/>
<span class="tactic">intros</span> <span class="id">V</span>; <span class="tactic">rewrite</span> <span class="id">V</span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="id">now</span> <span class="id">contradict</span> <span class="id">Hm</span>.<br/>
<span class="tactic">intros</span> <span class="id">n2</span> <span class="id">Hn2</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi_distanceable">phi_distanceable</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> <span class="id">n1</span> <span class="id">a</span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> <span class="id">n2</span> <span class="id">a</span>)) <span class="kwd">as</span> (<span class="id">M</span>,(<span class="id">HM1</span>,<span class="id">HM2</span>)).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="tactic">replace</span> 0 <span class="kwd">with</span> (0*(<span class="id">M</span>+1)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">M</span>+0).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> <span class="id">M</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">M</span>+0).<br/>
<span class="id">right</span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_1">Rle_0_1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dist_iter_gen_phi">dist_iter_gen_phi</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">n</span> <span class="id">D</span>, 0 &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> &lt; 1 -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_Lipschitz_phi">is_Lipschitz_phi</a></span>  <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> -&gt; <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) -&gt; (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span>)%<span class="id">nat</span> -&gt; (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)%<span class="id">nat</span> -&gt; (0 &lt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span>)%<span class="id">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ball</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#p">p</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>^<span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span>/(1-<span class="id"><a href="CertRL.converge.LM.fixed_point.html#k">k</a></span>) *<span class="id"><a href="CertRL.converge.LM.fixed_point.html#D">D</a></span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1118')">Proof.</div>
<div class="proofscript" id="proof1118">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">k</span> <span class="id">p</span> <span class="id">m</span> <span class="id">n</span> <span class="id">D</span> (<span class="id">H1</span>,<span class="id">H1</span>') <span class="id">H2</span> <span class="id">Phi_a</span> <span class="id">H3</span> <span class="id">H4</span> <span class="id">Hp</span> <span class="id">Hm</span> <span class="id">Hn</span>.<br/>
<span class="tactic">case</span> <span class="id">H1</span>; <span class="tactic">intros</span> <span class="id">P0</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Lt.html#le_or_lt">le_or_lt</a></span> <span class="id">p</span> <span class="id">m</span>); <span class="tactic">intros</span> <span class="id">H5</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">replace</span> <span class="id">m</span> <span class="kwd">with</span> (<span class="id">p</span>+(<span class="id">m</span>-<span class="id">p</span>))%<span class="id">nat</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>^<span class="id">p</span>/(1-<span class="id">k</span>) *<span class="id">D</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.R_compl.html#Rle_pow_le">Rle_pow_le</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">left</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_phi">dist_iter_phi</a></span> <span class="kwd">with</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">intros</span> <span class="id">p0</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html#le_plus_minus_r">le_plus_minus_r</a></span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span>.<br/>
<span class="tactic">replace</span> <span class="id">p</span> <span class="kwd">with</span> (<span class="id">m</span>+(<span class="id">p</span>-<span class="id">m</span>))%<span class="id">nat</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>^<span class="id">m</span>/(1-<span class="id">k</span>) *<span class="id">D</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.R_compl.html#Rle_pow_le">Rle_pow_le</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_phi">dist_iter_phi</a></span> <span class="kwd">with</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub.phi">phi</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">intros</span> <span class="id">p0</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html#le_plus_minus_r">le_plus_minus_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Lt.html#lt_le_weak">lt_le_weak</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> 0.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">P0</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtrigo_def.html#pow_i">pow_i</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_aux_zero_phi">dist_iter_aux_zero_phi</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">P0</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Lt.html#lt_le_trans">lt_le_trans</a></span> <span class="kwd">with</span> <span class="id">n</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Lt.html#lt_le_trans">lt_le_trans</a></span> <span class="kwd">with</span> <span class="id">n</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter_dist_sub">iter_dist_sub</a></span>.<br/>
<br/>
<div class="doc">Fixed Point Theorem with subsets </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="FixedPoint_2_sub">FixedPoint_2_sub</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">X</span> : <span class="id">CompleteSpace</span>}.<br/>
<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="FixedPoint_2_sub.f">f</a></span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>-&gt;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>).<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="FixedPoint_2_sub.phi">phi</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_2_sub.phi_f">phi_f</a></span>: <span class="kwd">forall</span> <span class="id">x</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_2_sub.phi_distanceable">phi_distanceable</a></span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#y">y</a></span>-&gt; <span class="id">exists</span> <span class="id">M</span>, 0 &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#M">M</a></span> /\ <span class="id">ball</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#M">M</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#y">y</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_2_sub.phi_c">phi_c</a></span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#my_complete">my_complete</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FixedPoint_uniqueness_weak_phi">FixedPoint_uniqueness_weak_phi</a></span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction_phi">is_contraction_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">close</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1119')">Proof.</div>
<div class="proofscript" id="proof1119">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">k</span>,(<span class="id">Hk1</span>,(<span class="id">Hk2</span>,<span class="id">Hf</span>))) <span class="id">Phi_a</span> <span class="id">Phi_b</span> <span class="id">Ha</span> <span class="id">Hb</span> <span class="id">eps</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_distanceable">phi_distanceable</a></span> <span class="id">a</span> <span class="id">b</span>) <span class="kwd">as</span> (<span class="id">M</span>,(<span class="id">HM1</span>,<span class="id">HM2</span>)); <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">destruct</span> <span class="id">HM1</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">pose</span> (<span class="id">k</span>' := (<span class="id">k</span> + 1)/2).<br/>
<span class="tactic">assert</span> (<span class="id">k</span> &lt; <span class="id">k</span>').<br/>
<span class="tactic">unfold</span> <span class="id">k</span>'; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> <span class="kwd">with</span> 2%<span class="id">R</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Rplus_lt_reg_l</span> <span class="kwd">with</span> (-<span class="id">k</span>).<br/>
<span class="tactic">replace</span> (-<span class="id">k</span>+2*<span class="id">k</span>) <span class="kwd">with</span> <span class="id">k</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
<span class="tactic">replace</span> (-<span class="id">k</span> + 2 * ((<span class="id">k</span> + 1) / 2)) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="id">field</span>.<br/>
<span class="tactic">assumption</span>.<br/>
<span class="tactic">assert</span> (0 &lt; <span class="id">k</span>' &lt; 1).<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> <span class="id">k</span>; <span class="tactic">assumption</span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span>'; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> <span class="kwd">with</span> 2%<span class="id">R</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Rplus_lt_reg_l</span> <span class="kwd">with</span> (-1).<br/>
<span class="tactic">replace</span> (-1+2*1) <span class="kwd">with</span> 1 <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
<span class="tactic">replace</span> (-1 + 2 * ((<span class="id">k</span> + 1) / 2)) <span class="kwd">with</span> <span class="id">k</span> <span class="tactic">by</span> <span class="id">field</span>.<br/>
<span class="tactic">assumption</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.converge.LM.R_compl.html#contraction_lt_any">contraction_lt_any</a></span> <span class="id">k</span>' (<span class="id">eps</span>/<span class="id">M</span>)) <span class="kwd">as</span> (<span class="id">N</span>,<span class="id">HN</span>).<br/>
<span class="id">now</span> (<span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">left</span>).<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">destruct</span> <span class="id">eps</span>; <span class="tactic">simpl</span>; <span class="id">easy</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">M</span>*<span class="id">k</span>'^<span class="id">N</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> <span class="kwd">with</span> (/<span class="id">M</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">HN</span>).<br/>
<span class="id">right</span>; <span class="id">field</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">clear</span> <span class="id">HN</span>; <span class="tactic">induction</span> <span class="id">N</span>.<br/>
<span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
<span class="tactic">assumption</span>.<br/>
<span class="tactic">assert</span> (<span class="id">L</span>:(0 &lt; <span class="id">M</span>*<span class="id">k</span>'^<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">N</span>*(<span class="id">k</span>'-<span class="id">k</span>)/2)).<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="id">specialize</span> (<span class="id">Ha</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">L</span>)).<br/>
<span class="id">specialize</span> (<span class="id">Hb</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">L</span>)).<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> ((<span class="id">M</span> * <span class="id">k</span>' ^ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">N</span>) * (<span class="id">k</span>' - <span class="id">k</span>) / 2) + ((<span class="id">k</span>*(<span class="id">M</span> * <span class="id">k</span>' ^ <span class="id">N</span>)) + (<span class="id">M</span> * <span class="id">k</span>' ^ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">N</span>) * (<span class="id">k</span>' - <span class="id">k</span>) / 2))).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> ((<span class="id">k</span>'*(<span class="id">k</span>' - <span class="id">k</span>)  + <span class="id">k</span>)*<span class="id">M</span>*<span class="id">k</span>'^<span class="id">N</span>).<br/>
<span class="id">right</span>; <span class="id">field</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">k</span>'*<span class="id">M</span>*<span class="id">k</span>'^<span class="id">N</span>).<br/>
2: <span class="id">right</span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">left</span>; <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> <span class="kwd">with</span> (-<span class="id">k</span>'*(<span class="id">k</span>'-<span class="id">k</span>)-<span class="id">k</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> 0.<br/>
<span class="id">right</span>; <span class="tactic">ring</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span> ((<span class="id">k</span>-1)/2)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_sqr">Rle_0_sqr</a></span>.<br/>
<span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rsqr">Rsqr</a></span>, <span class="id">k</span>'.<br/>
<span class="id">field</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span>, <span class="id">Ha</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id">b</span>).<br/>
<span class="tactic">apply</span> <span class="id">Hf</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rfunctions.html#pow_lt">pow_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Hb</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> <span class="id">M</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">eps</span>; <span class="tactic">simpl</span>; <span class="id">left</span>; <span class="id">easy</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Fixed_Point_aux_Proper_phi">Fixed_Point_aux_Proper_phi</a></span> : <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ProperFilter</span> (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1120')">Proof.</div>
<div class="proofscript" id="proof1120">
<span class="tactic">intros</span> <span class="id">a</span>; <span class="tactic">split</span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> (<span class="id">N</span>,<span class="id">HN</span>).<br/>
<span class="id">exists</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id">N</span> <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id">HN</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">exists</span> 0%<span class="id">nat</span>; <span class="id">easy</span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> (<span class="id">N1</span>,<span class="id">H1</span>) (<span class="id">N2</span>,<span class="id">H2</span>).<br/>
<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#max">max</a></span> <span class="id">N1</span> <span class="id">N2</span>).<br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">Hn</span>; <span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_trans">le_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">Hn</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#le_max_l">Max.le_max_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">H2</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Le.html#le_trans">le_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">Hn</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Max.html#le_max_r">Max.le_max_r</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">H</span> (<span class="id">N</span>,<span class="id">HN</span>).<br/>
<span class="id">exists</span> <span class="id">N</span>.<br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">HN</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Fixed_Point_aux_cauchy_phi">Fixed_Point_aux_cauchy_phi</a></span> : <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction_phi">is_contraction_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt; <span class="id">cauchy</span> (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>))).<br/>
<span class="tactic">intros</span> <span class="id">a</span> (<span class="id">k</span>,(<span class="id">Hk1</span>,(<span class="id">Hk2</span>,<span class="id">Hf</span>))) <span class="id">Phi_a</span>.<br/>
<span class="tactic">generalize</span> (@<span class="id">cauchy_distance</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span> <span class="id">_</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_Proper_phi">Fixed_Point_aux_Proper_phi</a></span> <span class="id">a</span>)).<br/>
<span class="tactic">unfold</span> <span class="id">cauchy</span>; <span class="tactic">intros</span> (<span class="id">_</span>,<span class="id">T</span>); <span class="tactic">apply</span> <span class="id">T</span>; <span class="tactic">clear</span> <span class="id">T</span>.<br/>
<span class="tactic">intros</span> <span class="id">eps</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_distanceable">phi_distanceable</a></span> <span class="id">a</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id">a</span>)) <span class="kwd">as</span> (<span class="id">M</span>,(<span class="id">HM1</span>,<span class="id">HM2</span>)).<br/>
<span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_f">phi_f</a></span>.<br/>
<span class="tactic">destruct</span> <span class="id">HM1</span>.<br/>
<span class="tactic">destruct</span> (<span class="id">contraction_lt_any</span>' <span class="id">k</span> (<span class="id">eps</span>/<span class="id">M</span>*(1-<span class="id">k</span>)*/3)) <span class="kwd">as</span> (<span class="id">n</span>,(<span class="id">Hn</span>',<span class="id">Hn</span>)).<br/>
<span class="id">now</span> <span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">destruct</span> <span class="id">eps</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">exists</span> <span class="id">m</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>, (<span class="id">n</span> &lt;= <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span>)%<span class="id">nat</span> /\ <span class="id">close</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#m">m</a></span> <span class="id">a</span>)).<br/>
<span class="tactic">split</span>.<br/>
<span class="id">exists</span> <span class="id">n</span>.<br/>
<span class="tactic">intros</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">exists</span> <span class="id">l</span>; <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">intros</span> <span class="id">E</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
<span class="tactic">intros</span> <span class="id">u</span> <span class="id">v</span> (<span class="id">n1</span>,(<span class="id">Hn1</span>,<span class="id">Hu</span>)) (<span class="id">n2</span>,(<span class="id">Hn2</span>,<span class="id">Hv</span>)).<br/>
<span class="tactic">assert</span> (<span class="id">L</span>:(0 &lt; <span class="id">eps</span>/3)).<br/>
<span class="tactic">apply</span> <span class="id">Rdiv_lt_0_compat</span>.<br/>
<span class="tactic">destruct</span> <span class="id">eps</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
<span class="id">pose</span> (<span class="id">e</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> <span class="id">L</span>).<br/>
<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e</span>+(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e</span>+<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e</span>))%<span class="id">R</span> <span class="tactic">by</span> (<span class="tactic">simpl</span>;<span class="id">field</span>).<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id">n1</span> <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id">Hu</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id">n2</span> <span class="id">a</span>).<br/>
2: <span class="tactic">apply</span> <span class="id">ball_sym</span>, <span class="id">Hv</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span> ^ <span class="id">n</span> / (1 - <span class="id">k</span>) * <span class="id">M</span>).<br/>
<span class="tactic">unfold</span> <span class="id">e</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> (/<span class="id">M</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> (1-<span class="id">k</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">eps</span> / <span class="id">M</span> * (1 - <span class="id">k</span>) * / 3).<br/>
2: <span class="id">right</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">ring</span>.<br/>
<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2:=<span class="id">Hn</span>).<br/>
<span class="id">right</span>; <span class="id">field</span>.<br/>
<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#dist_iter_gen_phi">dist_iter_gen_phi</a></span> <span class="kwd">with</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">split</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span> <span class="kwd">in</span> <span class="id">HM2</span>.<br/>
<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id">a</span>) <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.logic_tricks.html#strong_induction">strong_induction</a></span> <span class="kwd">with</span> (<span class="id">P</span>:= <span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id">a</span>) <span class="id">a</span>).<br/>
<span class="tactic">intros</span> <span class="id">n</span>; <span class="tactic">case</span> <span class="id">n</span>.<br/>
<span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">_</span>.<br/>
<span class="tactic">intros</span> <span class="id">e</span>; <span class="tactic">apply</span> <span class="id">ball_center</span>.<br/>
<span class="tactic">clear</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">n</span>; <span class="tactic">case</span> <span class="id">n</span>.<br/>
<span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">intros</span> <span class="id">e</span>; <span class="tactic">apply</span> <span class="id">ball_sym</span>, <span class="id">ball_le</span> <span class="kwd">with</span> 0; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">left</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="tactic">clear</span> <span class="id">n</span>; <span class="tactic">intros</span> <span class="id">n</span> <span class="id">IH</span>.<br/>
<span class="tactic">apply</span> <span class="id">close_trans</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">a</span>).<br/>
2: <span class="tactic">apply</span> <span class="id">IH</span>.<br/>
2: <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">e</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>*<span class="id">e</span>).<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> <span class="id">e</span>) <span class="tactic">at</span> 2.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">left</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">apply</span> <span class="id">Hf</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Hx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_f">phi_f</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_f">phi_f</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_f">phi_f</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">assert</span> (<span class="id">L</span>:(<span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">a</span>) (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id">n</span> <span class="id">a</span>))).<br/>
<span class="tactic">apply</span> <span class="id">close_trans</span> <span class="kwd">with</span> <span class="id">a</span>.<br/>
<span class="tactic">apply</span> <span class="id">IH</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">close_sym</span>.<br/>
<span class="tactic">apply</span> <span class="id">IH</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_S">le_S</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">L</span>.<br/>
<span class="id">exists</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">close</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> <span class="id">a</span>).<br/>
<span class="tactic">split</span>.<br/>
<span class="id">exists</span> 0%<span class="id">nat</span>.<br/>
<span class="tactic">intros</span> <span class="id">n</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
<span class="tactic">intros</span> <span class="id">u</span> <span class="id">v</span> <span class="id">Hu</span> <span class="id">Hv</span>.<br/>
<span class="tactic">assert</span> (<span class="id">close</span> <span class="id">u</span> <span class="id">v</span>).<br/>
<span class="tactic">apply</span> <span class="id">close_trans</span> <span class="kwd">with</span> <span class="id">a</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id">close_sym</span>.<br/>
<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FixedPoint_aux1_phi">FixedPoint_aux1_phi</a></span> : <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction_phi">is_contraction_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span>  <span class="id">x</span> := <span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span>  (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1121')">Proof.</div>
<div class="proofscript" id="proof1121">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">Hf</span> <span class="id">Phi_a</span> <span class="id">x</span>.<br/>
<span class="tactic">generalize</span> (<span class="id">complete_cauchy</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id">a</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_Proper_phi">Fixed_Point_aux_Proper_phi</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_cauchy_phi">Fixed_Point_aux_cauchy_phi</a></span> <span class="id">_</span> <span class="id">Hf</span> <span class="id">Phi_a</span>)).<br/>
<span class="tactic">replace</span> ((<span class="id">Hierarchy.lim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">P</span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span> -&gt; <span class="kwd">Prop</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n0</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n0">n0</a></span> <span class="id">a</span>))))) <span class="kwd">with</span> <span class="id">x</span> <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
<span class="tactic">intros</span> <span class="id">H</span> <span class="id">eps</span>.<br/>
<span class="id">pose</span> (<span class="id">e2</span> :=<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mkposreal">mkposreal</a></span> <span class="id">_</span> (<span class="id">is_pos_div_2</span> <span class="id">eps</span>)).<br/>
<span class="id">specialize</span> (<span class="id">H</span> <span class="id">e2</span>).<br/>
<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">n</span>,<span class="id">Hn</span>).<br/>
<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">eps</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e2</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#pos">pos</a></span> <span class="id">e2</span>).<br/>
2: <span class="tactic">simpl</span>; <span class="id">field</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_triangle</span> <span class="kwd">with</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">n</span>) <span class="id">a</span>).<br/>
<span class="tactic">apply</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_S">le_S</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="tactic">generalize</span> <span class="id">Hf</span>; <span class="tactic">intro</span> <span class="id">Hf</span>'.<br/>
<span class="tactic">destruct</span> <span class="id">Hf</span> <span class="kwd">as</span> (<span class="id">k</span>,(<span class="id">Hk1</span>,(<span class="id">Hk2</span>,<span class="id">Hk3</span>))).<br/>
<span class="tactic">apply</span> <span class="id">ball_le</span> <span class="kwd">with</span> (<span class="id">k</span>*<span class="id">e2</span>).<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> <span class="id">e2</span>) <span class="tactic">at</span> 2.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>.<br/>
<span class="tactic">destruct</span> <span class="id">e2</span>; <span class="id">left</span>; <span class="id">now</span> <span class="tactic">simpl</span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id">Hk3</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#cond_pos">cond_pos</a></span> <span class="id">e2</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">xx</span> <span class="id">Hxx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_f">phi_f</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">unfold</span> <span class="id">x</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#my_complete">my_complete</a></span> <span class="kwd">in</span> <span class="id">phi_c</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_c">phi_c</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_Proper_phi">Fixed_Point_aux_Proper_phi</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_cauchy_phi">Fixed_Point_aux_cauchy_phi</a></span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Hev</span>.<br/>
<span class="tactic">intro</span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>.<br/>
<span class="tactic">unfold</span> <span class="id">eventually</span> <span class="kwd">in</span> <span class="id">Hev</span>.<br/>
<span class="tactic">destruct</span> <span class="id">Hev</span> <span class="kwd">as</span> (<span class="id">N</span>,<span class="id">Hev</span>).<br/>
<span class="id">specialize</span> (<span class="id">Hev</span> (<span class="id">N</span>+1)%<span class="id">nat</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Hev</span>' : <span class="id">P</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> (<span class="id">N</span>+1) <span class="id">a</span>)).<br/>
<span class="tactic">apply</span> <span class="id">Hev</span>.<br/>
<span class="tactic">intuition</span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> (<span class="id">N</span>+1) <span class="id">a</span>).<br/>
<span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">trivial</span>.<br/>
<span class="tactic">apply</span> <span class="id">ball_sym</span>.<br/>
<span class="tactic">apply</span> <span class="id">Hn</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_2_sub.phi_X_not_empty">phi_X_not_empty</a></span>: <span class="id">exists</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="FixedPoint_2_sub.phi_closed">phi_closed</a></span>: <span class="id"><a href="CertRL.converge.LM.fixed_point.html#my_complete">my_complete</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FixedPoint_aux2_phi">FixedPoint_aux2_phi</a></span> : <span class="kwd">forall</span> (<span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>), <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction_phi">is_contraction_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> -&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span>  <span class="id">x</span> := <span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span><br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>))) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1122')">Proof.</div>
<div class="proofscript" id="proof1122">
<span class="tactic">intros</span> <span class="id">a</span> <span class="id">Hf</span> <span class="id">Phi_a</span> <span class="id">x</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_closed">phi_closed</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_Proper_phi">Fixed_Point_aux_Proper_phi</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#Fixed_Point_aux_cauchy_phi">Fixed_Point_aux_cauchy_phi</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">P</span> (<span class="id">N</span>,<span class="id">HN</span>).<br/>
<span class="tactic">intros</span> <span class="id">K</span>; <span class="tactic">apply</span> <span class="id">K</span>.<br/>
<span class="id">exists</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id">N</span> <span class="id">a</span>).<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id">HN</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Peano.html#le_n">le_n</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#phi_iter_f">phi_iter_f</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="FixedPoint_C_phi">FixedPoint_C_phi</a></span> : <span class="id"><a href="CertRL.converge.LM.fixed_point.html#is_contraction_phi">is_contraction_phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>:<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.X">X</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> -&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span>) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> -&gt; <span class="id">close</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#b">b</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi">phi</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span> -&gt; <span class="id">close</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span>  (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#x">x</a></span>)))) <span class="id"><a href="CertRL.converge.LM.fixed_point.html#a">a</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1123')">Proof.</div>
<div class="proofscript" id="proof1123">
<span class="tactic">intros</span> <span class="id">Hf</span>.<br/>
<span class="tactic">destruct</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.phi_X_not_empty">phi_X_not_empty</a></span> <span class="kwd">as</span> (<span class="id">a</span>, <span class="id">Ha</span>).<br/>
<span class="id">exists</span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#lim">lim</a></span> (<span class="kwd">fun</span> <span class="id">P</span> =&gt; <span class="id">eventually</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id"><a href="CertRL.converge.LM.fixed_point.html#P">P</a></span> (<span class="id"><a href="CertRL.converge.LM.fixed_point.html#iter">iter</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub.f">f</a></span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#n">n</a></span> <span class="id">a</span>)))).<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux2_phi">FixedPoint_aux2_phi</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux1_phi">FixedPoint_aux1_phi</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">intros</span> <span class="id">b</span> <span class="id">Phi_b</span> <span class="id">Hb</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_uniqueness_weak_phi">FixedPoint_uniqueness_weak_phi</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux2_phi">FixedPoint_aux2_phi</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux1_phi">FixedPoint_aux1_phi</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Phi_x</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_uniqueness_weak_phi">FixedPoint_uniqueness_weak_phi</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux2_phi">FixedPoint_aux2_phi</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux2_phi">FixedPoint_aux2_phi</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux1_phi">FixedPoint_aux1_phi</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_aux1_phi">FixedPoint_aux1_phi</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CertRL.converge.LM.fixed_point.html#FixedPoint_2_sub">FixedPoint_2_sub</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
